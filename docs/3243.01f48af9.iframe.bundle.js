"use strict";(self.webpackChunkledfx=self.webpackChunkledfx||[]).push([[3243],{"./src/components/SchemaForm/components/BladeFrame.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>components_BladeFrame});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),InfoRounded=__webpack_require__("./node_modules/@mui/icons-material/esm/InfoRounded.js"),styled=__webpack_require__("./node_modules/@mui/material/esm/styles/styled.js"),ClickAwayListener=__webpack_require__("./node_modules/@mui/material/esm/ClickAwayListener/ClickAwayListener.js"),Box=__webpack_require__("./node_modules/@mui/material/esm/Box/Box.js"),Tooltip=__webpack_require__("./node_modules/@mui/material/esm/Tooltip/Tooltip.js"),react=__webpack_require__("./node_modules/react/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const Tooltip_Tooltip=props=>{const[open,setOpen]=(0,react.useState)(!1),handleTooltipClose=()=>{setOpen(!1)};return(0,jsx_runtime.jsx)(ClickAwayListener.x,{onClickAway:handleTooltipClose,children:(0,jsx_runtime.jsx)(Box.A,{sx:{pr:.5,pl:1,display:"flex"},children:(0,jsx_runtime.jsx)(Tooltip.A,(0,objectSpread2.A)((0,objectSpread2.A)({onClose:handleTooltipClose,open,disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0},props),{},{children:(0,jsx_runtime.jsx)(InfoRounded.A,{sx:{cursor:"pointer"},onClick:()=>{setOpen(!0)},fontSize:"small"})}))})})},components_Tooltip=Tooltip_Tooltip;Tooltip_Tooltip.__docgenInfo={description:"",methods:[],displayName:"Tooltip"};const Root=(0,styled.Ay)("div")(_ref=>{let{theme}=_ref;return{minWidth:"23.5%",padding:"16px 1.2rem 6px 1.2rem",border:"1px solid",borderColor:theme.palette.divider,borderRadius:"10px",position:"relative",display:"flex",alignItems:"center",height:"auto",margin:"0.5rem 0","@media (max-width: 580px)":{width:"100% !important",margin:"0.5rem 0"},"& > label":{top:"-0.75rem",display:"flex",alignItems:"center",left:"1rem",padding:"0 0.3rem",position:"absolute",fontVariant:"all-small-caps",fontSize:"0.9rem",letterSpacing:"0.1rem",color:theme.palette.text.secondary,backgroundColor:theme.palette.background.paper,boxSizing:"border-box"}}}),BladeFrame=_ref2=>{let{index,title,children,full=!1,style={width:"unset",order:0},required=!1,variant="outlined",className,disabled,labelStyle,onClick,tooltip}=_ref2;return"outlined"===variant?(0,jsx_runtime.jsxs)(Root,{className:className||"",style:(0,objectSpread2.A)((0,objectSpread2.A)({},style),{},{width:full?"100%":style.width}),onClick,children:[(0,jsx_runtime.jsxs)("label",{style:(0,objectSpread2.A)({},labelStyle),className:"MuiFormLabel-root".concat(disabled?" Mui-disabled":"","  step-effect-").concat(index),children:[title,required?"*":"",tooltip?(0,jsx_runtime.jsx)(components_Tooltip,{sx:{ml:1,mr:.5},title:tooltip,arrow:!0,placement:"top",children:(0,jsx_runtime.jsx)(InfoRounded.A,{fontSize:"small"})}):null]}),children]}):children},components_BladeFrame=BladeFrame;BladeFrame.__docgenInfo={description:"",methods:[],displayName:"BladeFrame",props:{title:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"undefined",computed:!0}},index:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"undefined",computed:!0}},children:{required:!1,tsType:{name:"any"},description:"",defaultValue:{value:"undefined",computed:!0}},full:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},style:{required:!1,tsType:{name:"any"},description:"",defaultValue:{value:"{\n  width: 'unset',\n  order: 0\n}",computed:!1}},required:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},variant:{required:!1,tsType:{name:"union",raw:"'outlined' | 'contained' | 'inherit'",elements:[{name:"literal",value:"'outlined'"},{name:"literal",value:"'contained'"},{name:"literal",value:"'inherit'"}]},description:"",defaultValue:{value:"'outlined'",computed:!1}},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"",defaultValue:{value:"undefined",computed:!0}},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"undefined",computed:!0}},labelStyle:{required:!1,tsType:{name:"any"},description:"",defaultValue:{value:"undefined",computed:!0}},onClick:{required:!1,tsType:{name:"union",raw:"any | undefined",elements:[{name:"any"},{name:"undefined"}]},description:"",defaultValue:{value:"undefined",computed:!0}},tooltip:{required:!1,tsType:{name:"ReactNode"},description:"",defaultValue:{value:"undefined",computed:!0}}}}},"./src/components/SchemaForm/components/String/BladeSelect.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>String_BladeSelect});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),Box=__webpack_require__("./node_modules/@mui/material/esm/Box/Box.js"),Typography=__webpack_require__("./node_modules/@mui/material/esm/Typography/Typography.js"),Stack=__webpack_require__("./node_modules/@mui/material/esm/Stack/Stack.js"),Divider=__webpack_require__("./node_modules/@mui/material/esm/Divider/Divider.js"),Link=__webpack_require__("./node_modules/@mui/material/esm/Link/Link.js"),Select=__webpack_require__("./node_modules/@mui/material/esm/Select/Select.js"),MenuItem=__webpack_require__("./node_modules/@mui/material/esm/MenuItem/MenuItem.js"),TextField=__webpack_require__("./node_modules/@mui/material/esm/TextField/TextField.js"),InputAdornment=__webpack_require__("./node_modules/@mui/material/esm/InputAdornment/InputAdornment.js"),Alert=__webpack_require__("./node_modules/@mui/material/esm/Alert/Alert.js"),Tooltip=__webpack_require__("./node_modules/@mui/material/esm/Tooltip/Tooltip.js"),Button=__webpack_require__("./node_modules/@mui/material/esm/Button/Button.js"),react=__webpack_require__("./node_modules/react/index.js"),BladeIcon=__webpack_require__("./src/components/Icons/BladeIcon/BladeIcon.tsx"),BladeFrame=__webpack_require__("./src/components/SchemaForm/components/BladeFrame.tsx"),ledfx=__webpack_require__("./src/api/ledfx.ts"),Dialog=__webpack_require__("./node_modules/@mui/material/esm/Dialog/Dialog.js"),DialogContent=__webpack_require__("./node_modules/@mui/material/esm/DialogContent/DialogContent.js"),DialogTitle=__webpack_require__("./node_modules/@mui/material/esm/DialogTitle/DialogTitle.js"),useTheme=__webpack_require__("./node_modules/@mui/material/esm/styles/useTheme.js"),IconButton=__webpack_require__("./node_modules/@mui/material/esm/IconButton/IconButton.js"),DialogActions=__webpack_require__("./node_modules/@mui/material/esm/DialogActions/DialogActions.js"),Gif=__webpack_require__("./node_modules/@mui/icons-material/esm/Gif.js"),Image=__webpack_require__("./node_modules/@mui/icons-material/esm/Image.js"),useStore=__webpack_require__("./src/store/useStore.ts"),is_electron=__webpack_require__("./node_modules/is-electron/index.js"),is_electron_default=__webpack_require__.n(is_electron),CardMedia=__webpack_require__("./node_modules/@mui/material/esm/CardMedia/CardMedia.js");const Scenes_styles=(0,__webpack_require__("./node_modules/@mui/styles/makeStyles/makeStyles.js").A)({root:{width:"min(92vw, 345px)"},sceneTitle:{fontSize:"1.1rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},"@media (max-width: 580px)":{root:{width:"95vw"},sceneTitle:{fontSize:"1rem",cursor:"default"}},media:{height:140},iconMedia:{height:140,display:"flex",alignItems:"center",margin:"0 auto",fontSize:100,"& > span:before":{position:"relative"}},iconMediaList:{height:"100%",display:"flex",alignItems:"center",margin:"0 auto",fontSize:50,"& > span:before":{position:"relative"}}});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const SceneImage=_ref=>{let{iconName,list,thumbnail,sx,title}=_ref;const classes=Scenes_styles(),[imageData,setImageData]=(0,react.useState)(null),[contentType,setContentType]=(0,react.useState)("image/png"),getImage=(0,useStore.A)(state=>state.getImage),fetchImage=(0,react.useCallback)(async ic=>{const result=await getImage(ic.split("image:")[1],thumbnail);null!=result&&result.image&&(setImageData(result.image),setContentType(result.type||"image/png"))},[thumbnail]);return(0,react.useEffect)(()=>{null!=iconName&&iconName.startsWith("image:")&&fetchImage(iconName)},[iconName,fetchImage]),iconName&&iconName.startsWith("image:")?is_electron_default()()?(0,jsx_runtime.jsx)(CardMedia.A,{className:classes.media,image:iconName.split("image:")[1],title:title||"",sx:(0,objectSpread2.A)({width:"100%",height:"100%"},sx)}):(0,jsx_runtime.jsx)("div",{className:classes.media,style:{height:(null==sx?void 0:sx.height)||140,width:(null==sx?void 0:sx.width)||"100%",maxWidth:"calc(100% - 2px)",backgroundSize:"cover",backgroundImage:imageData?'url("data:'.concat(contentType,";base64,").concat(imageData,'")'):void 0},title:title||""}):(0,jsx_runtime.jsx)(BladeIcon.A,{scene:!0,className:list?classes.iconMediaList:classes.iconMedia,name:iconName,list,sx:(0,objectSpread2.A)({},sx)})},ScenesImage=SceneImage;SceneImage.__docgenInfo={description:"",methods:[],displayName:"SceneImage",props:{iconName:{required:!0,tsType:{name:"string"},description:""},list:{required:!1,tsType:{name:"boolean"},description:""},thumbnail:{required:!1,tsType:{name:"boolean"},description:""},sx:{required:!1,tsType:{name:"SxProps"},description:""},title:{required:!1,tsType:{name:"string"},description:""}}};var BottomNavigationAction=__webpack_require__("./node_modules/@mui/material/esm/BottomNavigationAction/BottomNavigationAction.js"),Tabs=__webpack_require__("./node_modules/@mui/material/esm/Tabs/Tabs.js"),Tab=__webpack_require__("./node_modules/@mui/material/esm/Tab/Tab.js"),Refresh=__webpack_require__("./node_modules/@mui/icons-material/esm/Refresh.js"),PermMedia=__webpack_require__("./node_modules/@mui/icons-material/esm/PermMedia.js"),Close=__webpack_require__("./node_modules/@mui/icons-material/esm/Close.js"),DataGrid=__webpack_require__("./node_modules/@mui/x-data-grid/esm/DataGrid/DataGrid.js"),Popover=__webpack_require__("./src/components/Popover/Popover.tsx"),objectWithoutProperties=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js");const _excluded=["children","value","index"];function TabPanel(props){const{children,value,index}=props,other=(0,objectWithoutProperties.A)(props,_excluded);return(0,jsx_runtime.jsx)("div",(0,objectSpread2.A)((0,objectSpread2.A)({role:"tabpanel",hidden:value!==index,id:"manager-tabpanel-".concat(index),"aria-labelledby":"manager-tab-".concat(index)},other),{},{children:value===index&&(0,jsx_runtime.jsx)(Box.A,{sx:{height:"100%"},children})}))}function a11yProps(index){return{id:"manager-tab-".concat(index),"aria-controls":"manager-tabpanel-".concat(index)}}TabPanel.__docgenInfo={description:"",methods:[],displayName:"TabPanel",props:{children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},index:{required:!0,tsType:{name:"number"},description:""},value:{required:!0,tsType:{name:"number"},description:""}}};const AssetManager=_ref=>{let{variant="iconbutton"}=_ref;const theme=(0,useTheme.A)(),[open,setOpen]=(0,react.useState)(!1),[tabValue,setTabValue]=(0,react.useState)(0),assets=(0,useStore.A)(state=>state.assets),assetsFixed=(0,useStore.A)(state=>state.assetsFixed),getAssets=(0,useStore.A)(state=>state.getAssets),getAssetsFixed=(0,useStore.A)(state=>state.getAssetsFixed),deleteAsset=(0,useStore.A)(state=>state.deleteAsset),cacheStats=(0,useStore.A)(state=>state.cacheStats),getCacheStats=(0,useStore.A)(state=>state.getCacheStats),clearCache=(0,useStore.A)(state=>state.clearCache),refreshCacheImage=(0,useStore.A)(state=>state.refreshCacheImage);(0,react.useEffect)(()=>{open&&(0===tabValue?getAssets():1===tabValue?getAssetsFixed():getCacheStats())},[open,tabValue,getAssets,getAssetsFixed,getCacheStats]);const assetColumns=[{field:"preview",headerName:"Preview",width:100,renderCell:params=>(0,jsx_runtime.jsx)(ScenesImage,{thumbnail:!0,iconName:"image:file:///".concat(params.row.path),sx:{width:60,height:60,objectFit:"cover",borderRadius:1}}),sortable:!1,filterable:!1},{field:"path",headerName:"Path",flex:1,minWidth:200},{field:"format",headerName:"Format",width:150},{field:"size",headerName:"Size",width:120,valueFormatter:value=>"".concat((value/1024).toFixed(2)," KB")},{field:"dimensions",headerName:"Dimensions",width:120,valueGetter:(value,row)=>"".concat(row.width,"x").concat(row.height)},{field:"n_frames",headerName:"Frames",width:100},{field:"modified",headerName:"Modified",width:180,valueFormatter:value=>new Date(value).toLocaleString()},{field:"actions",headerName:"Actions",width:100,sortable:!1,filterable:!1,renderCell:params=>(0,jsx_runtime.jsx)(Popover.A,{type:"iconbutton",variant:"text",color:"inherit",onConfirm:()=>deleteAsset(params.row.path),text:"Delete ".concat(params.row.filename,"?")})}],fixedAssetColumns=[{field:"preview",headerName:"Preview",width:100,renderCell:params=>(0,jsx_runtime.jsx)(ScenesImage,{thumbnail:!0,iconName:"image:builtin://".concat(params.row.path),sx:{width:60,height:60,objectFit:"cover",borderRadius:1}}),sortable:!1,filterable:!1},{field:"path",headerName:"Path",flex:1,minWidth:250},{field:"format",headerName:"Format",width:100},{field:"size",headerName:"Size",width:120,valueFormatter:value=>"".concat((value/1024).toFixed(2)," KB")},{field:"dimensions",headerName:"Dimensions",width:120,valueGetter:(value,row)=>"".concat(row.width,"x").concat(row.height)},{field:"n_frames",headerName:"Frames",width:100}],cacheColumns=[{field:"preview",headerName:"Preview",width:100,renderCell:params=>(0,jsx_runtime.jsx)(ScenesImage,{thumbnail:!0,iconName:"image:".concat(params.row.url),sx:{width:60,height:60,objectFit:"cover",borderRadius:1}}),sortable:!1,filterable:!1},{field:"url",headerName:"URL",flex:1,minWidth:300},{field:"format",headerName:"Format",width:100},{field:"file_size",headerName:"Size",width:120,valueFormatter:value=>"".concat((value/1024).toFixed(2)," KB")},{field:"dimensions",headerName:"Dimensions",width:120,valueGetter:(value,row)=>"".concat(row.width,"x").concat(row.height)},{field:"n_frames",headerName:"Frames",width:100},{field:"access_count",headerName:"Access Count",width:120},{field:"last_accessed",headerName:"Last Accessed",width:180,valueFormatter:value=>new Date(value).toLocaleString()},{field:"cached_at",headerName:"Cached At",width:180,valueFormatter:value=>new Date(value).toLocaleString()},{field:"actions",headerName:"Actions",width:150,sortable:!1,filterable:!1,renderCell:params=>(0,jsx_runtime.jsxs)(Box.A,{sx:{display:"flex",gap:1},children:[(0,jsx_runtime.jsx)(Popover.A,{type:"iconbutton",variant:"text",color:"inherit",onConfirm:()=>refreshCacheImage(params.row.url),text:"Refresh cache for this image?",icon:(0,jsx_runtime.jsx)(Refresh.A,{})}),(0,jsx_runtime.jsx)(Popover.A,{type:"iconbutton",variant:"text",color:"inherit",onConfirm:async()=>{await clearCache(params.row.url),await getCacheStats()},text:"Clear cache for this image?"})]})}];return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["iconbutton"===variant&&(0,jsx_runtime.jsx)(IconButton.A,{color:"inherit",onClick:()=>setOpen(!0),sx:{color:"light"===theme.palette.mode?"#000":"#fff","&:hover":{color:theme.palette.primary.main}},children:(0,jsx_runtime.jsx)(PermMedia.A,{})}),"button"===variant&&(0,jsx_runtime.jsx)(Button.A,{startIcon:(0,jsx_runtime.jsx)(PermMedia.A,{}),onClick:()=>setOpen(!0),children:"Asset Manager"}),"navitem"===variant&&(0,jsx_runtime.jsx)(BottomNavigationAction.A,{label:"Assets",value:"/AssetManager",icon:(0,jsx_runtime.jsx)(PermMedia.A,{}),onClick:()=>setOpen(!0),sx:{color:open?theme.palette.primary.main:"inherit",pt:0,"& .MuiBottomNavigationAction-label":{opacity:1}}}),"tile"===variant&&(0,jsx_runtime.jsxs)(Button.A,{variant:"outlined",onClick:()=>setOpen(!0),sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",p:2,gap:1,width:"100%",height:"100%"},children:[(0,jsx_runtime.jsx)(PermMedia.A,{fontSize:"large"}),"Asset Manager"]}),(0,jsx_runtime.jsxs)(Dialog.A,{open,onClose:()=>setOpen(!1),maxWidth:!1,fullScreen:!0,PaperProps:{sx:{bgcolor:theme.palette.background.default}},children:[(0,jsx_runtime.jsxs)(DialogTitle.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:["Asset & Cache Manager",(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>setOpen(!1),children:(0,jsx_runtime.jsx)(Close.A,{})})]}),(0,jsx_runtime.jsx)(DialogContent.A,{children:(0,jsx_runtime.jsxs)(Box.A,{sx:{height:"calc(100vh - 100px)",width:"100%",display:"flex",flexDirection:"column"},children:[(0,jsx_runtime.jsx)(Box.A,{sx:{borderBottom:1,borderColor:"divider"},children:(0,jsx_runtime.jsxs)(Tabs.A,{value:tabValue,onChange:(event,newValue)=>{setTabValue(newValue)},"aria-label":"asset and cache manager tabs",children:[(0,jsx_runtime.jsx)(Tab.A,(0,objectSpread2.A)({label:"User Assets"},a11yProps(0))),(0,jsx_runtime.jsx)(Tab.A,(0,objectSpread2.A)({label:"Built-in Assets"},a11yProps(1))),(0,jsx_runtime.jsx)(Tab.A,(0,objectSpread2.A)({label:"Cache"},a11yProps(2)))]})}),(0,jsx_runtime.jsx)(TabPanel,{value:tabValue,index:0,children:(0,jsx_runtime.jsx)(Box.A,{sx:{height:"calc(100vh - 200px)",width:"100%"},children:(0,jsx_runtime.jsx)(DataGrid.z,{rows:assets,columns:assetColumns,getRowId:row=>row.filename||row.path,rowHeight:80,disableRowSelectionOnClick:!0,sx:{"& .MuiDataGrid-cell":{display:"flex",alignItems:"center"}}})})}),(0,jsx_runtime.jsx)(TabPanel,{value:tabValue,index:1,children:(0,jsx_runtime.jsx)(Box.A,{sx:{height:"calc(100vh - 200px)",width:"100%"},children:(0,jsx_runtime.jsx)(DataGrid.z,{rows:assetsFixed,columns:fixedAssetColumns,getRowId:row=>row.path,rowHeight:80,disableRowSelectionOnClick:!0,sx:{"& .MuiDataGrid-cell":{display:"flex",alignItems:"center"}}})})}),(0,jsx_runtime.jsx)(TabPanel,{value:tabValue,index:2,children:(0,jsx_runtime.jsx)(Box.A,{sx:{height:"calc(100vh - 200px)",width:"100%"},children:(0,jsx_runtime.jsx)(DataGrid.z,{rows:(null==cacheStats?void 0:cacheStats.entries)||[],columns:cacheColumns,getRowId:row=>row.url||row.path,rowHeight:80,disableRowSelectionOnClick:!0,sx:{"& .MuiDataGrid-cell":{display:"flex",alignItems:"center"}}})})})]})})]})]})},AssetManager_AssetManager=AssetManager;AssetManager.__docgenInfo={description:"",methods:[],displayName:"AssetManager",props:{variant:{required:!1,tsType:{name:"union",raw:"'button' | 'iconbutton' | 'navitem' | 'tile'",elements:[{name:"literal",value:"'button'"},{name:"literal",value:"'iconbutton'"},{name:"literal",value:"'navitem'"},{name:"literal",value:"'tile'"}]},description:"",defaultValue:{value:"'iconbutton'",computed:!1}}}};const GifPicker=_ref=>{let{onChange,mode="animated",value}=_ref;const theme=(0,useTheme.A)(),[filter,setFilter]=(0,react.useState)(""),[open,setOpen]=(0,react.useState)(!1),[selectedGif,setSelectedGif]=(0,react.useState)(null),assets=(0,useStore.A)(state=>state.assets),assetsFixed=(0,useStore.A)(state=>state.assetsFixed),cacheStats=(0,useStore.A)(state=>state.cacheStats),getAssetsFixed=(0,useStore.A)(state=>state.getAssetsFixed),getCacheStats=(0,useStore.A)(state=>state.getCacheStats);(0,react.useEffect)(()=>{open&&(getAssetsFixed(),getCacheStats())},[open,getAssetsFixed,getCacheStats]);const filterByMode=asset=>"animated"===mode?asset.is_animated:"static"!==mode||!asset.is_animated,gifsBuiltin=assetsFixed.filter(filterByMode),gifsUser=assets.filter(filterByMode),gifsCached=((null==cacheStats?void 0:cacheStats.entries)||[]).filter(entry=>{var _entry$content_type;if(!(null===(_entry$content_type=entry.content_type)||void 0===_entry$content_type?void 0:_entry$content_type.startsWith("image/")))return!1;if(void 0!==entry.is_animated)return"animated"===mode?entry.is_animated:"static"!==mode||!entry.is_animated;const isAnimated="image/gif"===entry.content_type||"image/webp"===entry.content_type&&entry.url.includes(".webp");return"animated"===mode?isAnimated:"static"!==mode||!isAnimated}).map(entry=>({url:entry.url,cached_at:entry.cached_at,last_accessed:entry.last_accessed,access_count:entry.access_count,file_size:entry.file_size,content_type:entry.content_type,width:entry.width||0,height:entry.height||0,format:entry.format||null,n_frames:entry.n_frames||1,is_animated:entry.is_animated||!1})),handleClose=()=>{setOpen(!1)};return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>{setSelectedGif(value||null),setOpen(!0)},sx:{color:"light"===theme.palette.mode?"#000":"#fff","&:hover":{color:theme.palette.primary.main}},children:"animated"===mode?(0,jsx_runtime.jsx)(Gif.A,{}):(0,jsx_runtime.jsx)(Image.A,{})}),(0,jsx_runtime.jsxs)(Dialog.A,{open,onClose:handleClose,children:[(0,jsx_runtime.jsx)(DialogTitle.A,{children:"static"===mode||"both"===mode?"Image Picker":"GIF Picker"}),(0,jsx_runtime.jsxs)(DialogContent.A,{children:[(0,jsx_runtime.jsx)(TextField.A,{fullWidth:!0,sx:{marginBottom:"20px",minWidth:"522px"},onChange:e=>setFilter(e.target.value),placeholder:"static"===mode||"both"===mode?"Filter images...":"Filter GIFs..."}),gifsUser.length>0&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Divider.A,{sx:{margin:"16px 0"},children:(0,jsx_runtime.jsxs)(Typography.A,{variant:"caption",color:"GrayText",children:["User Assets (",gifsUser.length,")"]})}),(0,jsx_runtime.jsx)(Box.A,{sx:{display:"flex",flexWrap:"wrap",gap:"8px",mb:1},children:gifsUser.filter(gif=>gif.path.toLowerCase().includes(filter.toLowerCase())).map((gif,i)=>{const gifUrl=gif.path;return(0,jsx_runtime.jsx)(Box.A,{onClick:()=>{selectedGif!==gifUrl?(setSelectedGif(gifUrl),onChange(gif.path)):setSelectedGif(null)},tabIndex:i+1,onKeyDown:e=>{"Enter"===e.key&&handleClose()},sx:{borderRadius:1,border:"2px solid",cursor:"pointer",borderColor:selectedGif===gifUrl?theme.palette.primary.main:"gray",opacity:selectedGif===gifUrl?1:.3,"&:hover":{opacity:1}},children:(0,jsx_runtime.jsx)(ScenesImage,{iconName:"image:file:///".concat(gif.path),thumbnail:!0,title:"Source: User Asset\nPath: ".concat(gif.path,"\nSize: ").concat(gif.width,"x").concat(gif.height).concat(gif.is_animated?"\nFrames: ".concat(gif.n_frames):""),sx:{width:100,height:60,objectFit:"cover"}})},gif.path)})})]}),gifsCached.length>0&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Divider.A,{sx:{margin:"16px 0"},children:(0,jsx_runtime.jsxs)(Typography.A,{variant:"caption",color:"GrayText",children:["Cached Assets (",gifsCached.length,")"]})}),(0,jsx_runtime.jsx)(Box.A,{sx:{display:"flex",flexWrap:"wrap",gap:"8px"},children:gifsCached.filter(cached=>cached.url.toLowerCase().includes(filter.toLowerCase())).map((cached,i)=>{const gifUrl=cached.url,displayUrl=gifUrl.length>60?"".concat(gifUrl.substring(0,30),"...").concat(gifUrl.substring(gifUrl.length-27)):gifUrl;return(0,jsx_runtime.jsx)(Box.A,{onClick:()=>{selectedGif!==gifUrl?(setSelectedGif(gifUrl),onChange(gifUrl)):setSelectedGif(null)},tabIndex:gifsUser.length+i+1,onKeyDown:e=>{"Enter"===e.key&&handleClose()},sx:{borderRadius:1,border:"2px solid",cursor:"pointer",borderColor:selectedGif===gifUrl?theme.palette.primary.main:"gray",opacity:selectedGif===gifUrl?1:.3,"&:hover":{opacity:1}},children:(0,jsx_runtime.jsx)(ScenesImage,{iconName:"image:".concat(cached.url),thumbnail:!0,title:"Source: Cached\nURL: ".concat(displayUrl,"\nSize: ").concat(cached.width,"x").concat(cached.height).concat(cached.is_animated?"\nFrames: ".concat(cached.n_frames):""),sx:{width:100,height:60,objectFit:"cover"}})},cached.url)})})]}),(0,jsx_runtime.jsx)(Divider.A,{sx:{margin:"16px 0"},children:(0,jsx_runtime.jsxs)(Typography.A,{variant:"caption",color:"GrayText",children:["Built-in Assets (",gifsBuiltin.length,")"]})}),(0,jsx_runtime.jsx)(Box.A,{sx:{display:"flex",flexWrap:"wrap",gap:"8px"},children:gifsBuiltin.filter(gif=>gif.path.toLowerCase().includes(filter.toLowerCase())).map((gif,i)=>{const gifUrl="builtin://".concat(gif.path);return(0,jsx_runtime.jsx)(Box.A,{onClick:()=>{selectedGif!==gifUrl?(setSelectedGif(gifUrl),onChange(gifUrl)):setSelectedGif(null)},tabIndex:gifsUser.length+gifsCached.length+i+1,onKeyDown:e=>{"Enter"===e.key&&handleClose()},sx:{borderRadius:1,border:"2px solid",cursor:"pointer",borderColor:selectedGif===gifUrl?theme.palette.primary.main:"gray",opacity:selectedGif===gifUrl?1:.3,"&:hover":{opacity:1}},children:(0,jsx_runtime.jsx)(ScenesImage,{iconName:"image:builtin://".concat(gif.path),thumbnail:!0,title:"Source: Built-in\nPath: ".concat(gif.path,"\nSize: ").concat(gif.width,"x").concat(gif.height).concat(gif.is_animated?"\nFrames: ".concat(gif.n_frames):""),sx:{width:100,height:60,objectFit:"cover"}})},gif.path)})})]}),(0,jsx_runtime.jsxs)(DialogActions.A,{sx:{p:"20px"},children:[(0,jsx_runtime.jsx)(Box.A,{sx:{},children:(0,jsx_runtime.jsx)(AssetManager_AssetManager,{variant:"button"})}),(0,jsx_runtime.jsx)(Box.A,{sx:{flexGrow:1}}),(0,jsx_runtime.jsx)(Button.A,{onClick:handleClose,children:"OK"})]})]})]})},Gif_GifPicker=GifPicker;GifPicker.__docgenInfo={description:"",methods:[],displayName:"GifPicker",props:{onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(_url: string) => void",signature:{arguments:[{type:{name:"string"},name:"_url"}],return:{name:"void"}}},description:""},mode:{required:!1,tsType:{name:"union",raw:"'animated' | 'static' | 'both'",elements:[{name:"literal",value:"'animated'"},{name:"literal",value:"'static'"},{name:"literal",value:"'both'"}]},description:"",defaultValue:{value:"'animated'",computed:!1}},value:{required:!1,tsType:{name:"string"},description:""}}};var Slider=__webpack_require__("./node_modules/@mui/material/esm/Slider/Slider.js"),Colorize=__webpack_require__("./node_modules/@mui/icons-material/esm/Colorize.js"),ArrowLeft=__webpack_require__("./node_modules/@mui/icons-material/esm/ArrowLeft.js"),ArrowRight=__webpack_require__("./node_modules/@mui/icons-material/esm/ArrowRight.js");const GifFrame=_ref=>{let{image,onClick,selected}=_ref;const theme=(0,useTheme.A)();return(0,jsx_runtime.jsx)("div",{style:{height:void 0===onClick?292:300,width:"min(100% - 32px, ".concat(void 0===onClick?292:300,"px)"),minWidth:void 0===onClick?292:300,maxWidth:void 0===onClick?292:300,backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundImage:image?'url("data:image/png;base64,'.concat(image,'")'):"none",border:void 0===onClick?0:"4px solid",cursor:void 0===onClick?"default":"pointer",borderColor:selected?theme.palette.primary.main:"#9999",opacity:void 0===onClick?.5:1},onClick})},Gif_GifFrame=GifFrame;GifFrame.__docgenInfo={description:"",methods:[],displayName:"GifFrame",props:{onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void | undefined",signature:{arguments:[],return:{name:"union",raw:"void | undefined",elements:[{name:"void"},{name:"undefined"}]}}},description:"",defaultValue:{value:"undefined",computed:!0}},image:{required:!0,tsType:{name:"string"},description:""},selected:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"undefined",computed:!0}}}};const GifFramePicker=_ref=>{let{onChange,model}=_ref;const[open,setOpen]=(0,react.useState)(!1),[imageData,setImageData]=(0,react.useState)([]),getGifFrames=(0,useStore.A)(state=>state.getGifFrames),[currentFrame,setCurrentFrame]=(0,react.useState)(0),[loadedImageLocation,setLoadedImageLocation]=(0,react.useState)(null),[workingBeatFrames,setWorkingBeatFrames]=(0,react.useState)(model.beat_frames||"");(0,react.useEffect)(()=>{setWorkingBeatFrames(model.beat_frames||"")},[model]);const handleClose=()=>{setOpen(!1)};return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Button.A,{onClick:async()=>{if((!loadedImageLocation||loadedImageLocation!==model.image_location)&&model.image_location){const result=await getGifFrames(model.image_location);setImageData(result.frames),setLoadedImageLocation(model.image_location),setCurrentFrame(0)}setOpen(!0)},sx:{alignSelf:"center"},children:(0,jsx_runtime.jsx)(Colorize.A,{})}),(0,jsx_runtime.jsxs)(Dialog.A,{open,onClose:handleClose,PaperProps:{sx:{width:"960px",maxWidth:"unset"}},children:[(0,jsx_runtime.jsx)(DialogTitle.A,{children:"GIF Frame Picker"}),(0,jsx_runtime.jsx)(DialogContent.A,{sx:{minWidth:332,width:"100%"},children:imageData&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Box.A,{children:(0,jsx_runtime.jsx)(Typography.A,{variant:"h6",color:"GrayText",align:"center",mb:1,children:"Click on image to select/deselect"})}),(0,jsx_runtime.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,jsx_runtime.jsx)(Gif_GifFrame,{image:imageData[currentFrame-1]}),(0,jsx_runtime.jsx)(Gif_GifFrame,{image:imageData[currentFrame],selected:workingBeatFrames.split(" ").filter(Boolean).includes(currentFrame.toString()),onClick:()=>{const currentFrames=workingBeatFrames.split(" ").filter(Boolean);let output="";output=currentFrames.includes(currentFrame.toString())?currentFrames.filter(b=>b!==currentFrame.toString()).join(" "):[...currentFrames,currentFrame.toString()].sort((a,b)=>parseInt(a,10)-parseInt(b,10)).join(" "),setWorkingBeatFrames(output)}}),(0,jsx_runtime.jsx)(Gif_GifFrame,{image:imageData[currentFrame+1]})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:1,justifyContent:"center",alignItems:"center",children:[(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>setCurrentFrame(currentFrame-1),disabled:0===currentFrame,children:(0,jsx_runtime.jsx)(ArrowLeft.A,{})}),(0,jsx_runtime.jsx)(Typography.A,{variant:"h5",align:"center",mt:1,children:currentFrame}),(0,jsx_runtime.jsx)(IconButton.A,{size:"large",onClick:()=>setCurrentFrame(currentFrame+1),disabled:currentFrame===imageData.length-1,children:(0,jsx_runtime.jsx)(ArrowRight.A,{fontSize:"inherit"})})]}),(0,jsx_runtime.jsx)(Box.A,{sx:{maxWidth:860,mt:2,ml:3},children:(0,jsx_runtime.jsx)(Slider.Ay,{value:currentFrame,"aria-label":"Default",valueLabelDisplay:"auto",step:1,marks:workingBeatFrames.split(" ").filter(Boolean).map(b=>({value:parseInt(b,10),label:b})),min:0,max:imageData.length-1||0,onChange:(e,v)=>{setCurrentFrame(v)}})})]})}),(0,jsx_runtime.jsxs)(DialogActions.A,{children:[(0,jsx_runtime.jsx)(Button.A,{sx:{mr:6},onClick:()=>{setWorkingBeatFrames("")},children:"Clear Beat Frames"}),(0,jsx_runtime.jsx)(Button.A,{onClick:handleClose,children:"Cancel"}),(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{onChange(workingBeatFrames),setOpen(!1)},children:"Save"})]})]})]})},Gif_GifFramePicker=GifFramePicker;GifFramePicker.__docgenInfo={description:"",methods:[],displayName:"GifFramePicker",props:{onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(_url: string) => void",signature:{arguments:[{type:{name:"string"},name:"_url"}],return:{name:"void"}}},description:""},model:{required:!0,tsType:{name:"any"},description:""}}};const BladeSelect=_ref=>{var _schema$description;let{variant="outlined",disabled=!1,schema,model,model_id,onChange,index=0,required=!1,wrapperStyle={margin:"0.5rem",flexBasis:"49%",width:"unset"},selectStyle={},textStyle={},menuItemStyle={},hideDesc=!1,children,type}=_ref;const inputRef=(0,react.useRef)(null),[showReserved,setShowReserved]=(0,react.useState)(!1),[icon,setIcon]=(0,react.useState)("icon_name"===schema.id?model&&model_id&&model[model_id]||schema.enum&&schema.enum[0]:"");return(0,react.useEffect)(()=>{model&&model_id&&model[model_id]&&inputRef.current&&(inputRef.current.value=model[model_id])},[model,model_id]),(0,jsx_runtime.jsx)(BladeFrame.A,{title:schema.title,tooltip:"Icon Name"===schema.title?(0,jsx_runtime.jsxs)(Box.A,{p:1,children:[(0,jsx_runtime.jsx)(Typography.A,{variant:"h5",children:"Icon Libraries:"}),(0,jsx_runtime.jsxs)(Stack.A,{spacing:.5,mt:1,children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Typography.A,{color:"textDisabled",variant:"body1",children:"Link"}),(0,jsx_runtime.jsx)(Typography.A,{color:"textDisabled",variant:"body1",children:"Format"})]}),(0,jsx_runtime.jsx)(Divider.A,{}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:1,sx:{pt:.5},children:[(0,jsx_runtime.jsx)(Typography.A,{variant:"body1",children:(0,jsx_runtime.jsx)(Link.A,{href:"https://mui.com/material-ui/material-icons/",target:"_blank",sx:{mr:1},children:"MUI"})}),(0,jsx_runtime.jsx)(Typography.A,{variant:"body1",sx:{background:"#222",padding:"2px 10px",borderRadius:1,fontFamily:"monospace"},children:"iconName"})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:1,children:[(0,jsx_runtime.jsx)(Typography.A,{variant:"body1",children:(0,jsx_runtime.jsx)(Link.A,{href:"https://pictogrammers.com/library/mdi",target:"_blank",sx:{mr:1},children:"MDI"})}),(0,jsx_runtime.jsx)(Typography.A,{variant:"body1",sx:{background:"#222",padding:"2px 10px",borderRadius:1,fontFamily:"monospace"},children:"mdi:icon-name"})]})]})]}):"",className:"step-effect-".concat(index),full:!(schema.enum&&schema.enum.length&&Object.values(schema.enum).every(a=>(null==a?void 0:a.length)<20)),required,style:(0,objectSpread2.A)((0,objectSpread2.A)({},wrapperStyle),{},{flexBasis:"Name"===schema.title?"100%":"49%"}),children:"contained"===variant?schema.enum?(0,jsx_runtime.jsx)(Select.A,{variant:"filled",disabled,style:(0,objectSpread2.A)({flexGrow:"unset"},selectStyle),defaultValue:schema.default,value:model&&model_id&&model[model_id]||schema.default||schema.enum[0],onChange:e=>onChange(model_id,e.target.value),children:children||schema.enum.map((item,i)=>(0,jsx_runtime.jsx)(MenuItem.A,{value:item,children:item},"".concat(i,"-").concat(i)))}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(TextField.A,{variant:"standard",helperText:!hideDesc&&schema.description,slotProps:{input:{disableUnderline:!0}},defaultValue:model&&model_id&&model[model_id]||schema.enum&&schema.enum[0]||schema.default||"",onBlur:e=>onChange(model_id,e.target.value),style:textStyle})}):schema.enum&&Array.isArray(schema.enum)?(0,jsx_runtime.jsx)(Select.A,{variant:"standard",disableUnderline:!0,disabled,style:(0,objectSpread2.A)({flexGrow:"outlined"===variant?1:"unset"},selectStyle),defaultValue:schema.default,value:model&&model_id&&model[model_id]||schema.default||schema.enum[0],onChange:e=>onChange(model_id,e.target.value),children:schema.enum.map((item,i)=>(0,jsx_runtime.jsx)(MenuItem.A,{value:item,style:menuItemStyle,children:item},i))}):schema.enum&&!Array.isArray(schema.enum)?(0,jsx_runtime.jsx)(Select.A,{variant:"standard",disableUnderline:!0,disabled,style:(0,objectSpread2.A)({flexGrow:"outlined"===variant?1:"unset"},selectStyle),defaultValue:schema.default,value:model&&model_id&&schema.enum[model[model_id]]||schema.default||schema.enum[0],onChange:e=>onChange(model_id,parseInt(Object.keys(schema.enum).find(en=>schema.enum[en]===e.target.value)||"0",10)),children:Object.keys(schema.enum).map((item,i)=>(0,jsx_runtime.jsx)(MenuItem.A,{value:schema.enum[item],children:schema.enum[item]},i))}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(TextField.A,{variant:"standard",inputRef,type:null!==(_schema$description=schema.description)&&void 0!==_schema$description&&_schema$description.includes("password")?"password":"unset",helperText:!hideDesc&&schema.description,slotProps:{input:"icon_name"===schema.id?{startAdornment:(0,jsx_runtime.jsx)(InputAdornment.A,{position:"start",children:(0,jsx_runtime.jsx)(BladeIcon.A,{name:icon,style:{color:"#eee"}})}),disableUnderline:!0}:{disableUnderline:!0}},defaultValue:model&&model_id&&model[model_id]||schema.enum&&schema.enum[0]||schema.default||"",onBlur:e=>onChange(model_id,e.target.value),onChange:e=>{"icon_name"===schema.id&&setIcon(e.target.value);"Name"===schema.title&&["gap-","-background","-foreground","-mask"].some(part=>e.target.value.startsWith(part)||e.target.value.endsWith(part))?(setShowReserved(!0),inputRef.current.value=e.target.value.replace(/(gap-|-background|-foreground|-mask)/g,"")):(setShowReserved(!1),inputRef.current.value=e.target.value)},style:textStyle}),showReserved&&(0,jsx_runtime.jsx)(Alert.A,{severity:"warning",onClick:()=>setShowReserved(!showReserved),sx:{marginTop:1,width:"400px"},children:(0,jsx_runtime.jsx)(Typography.A,{variant:"caption",children:"Reserved word removed"})}),"image_location"===schema.id&&(0,jsx_runtime.jsx)(Gif_GifPicker,{value:model&&model_id?model[model_id]:"",onChange:gif=>{onChange(model_id,gif)}}),"image_source"===schema.id&&(0,jsx_runtime.jsx)(Gif_GifPicker,{mode:"static",value:model&&model_id?model[model_id]:"",onChange:filename=>{onChange(model_id,filename)}}),"beat_frames"===schema.id&&model.image_location&&""!==model.image_location&&(0,jsx_runtime.jsx)(Gif_GifFramePicker,{model,onChange:gif=>{inputRef.current?(inputRef.current.value=gif,inputRef.current.dispatchEvent(new Event("blur",{bubbles:!0}))):onChange(model_id,gif)}}),"auth_token"===model_id&&"nanoleaf"===type&&(0,jsx_runtime.jsx)(Tooltip.A,{title:void 0===model.ip_address||""===model.ip_address?"please enter ip address of nanoleaf controller":"please hold power on nanoleaf controller for 7 seconds until white leds scan left to right and then press this button to acquire auth token",children:(0,jsx_runtime.jsx)(Button.A,{sx:{fontSize:10,height:56,color:void 0===model.ip_address||""===model.ip_address?"grey":"inherit"},onClick:async()=>{if(void 0===model.ip_address||""===model.ip_address)return;const{auth_token}=await(0,ledfx.U)("/api/get_nanoleaf_token","POST",{ip_address:model.ip_address,port:model.port||16021});onChange(model_id,auth_token),inputRef.current.value=auth_token},children:"Get Token"})})]})})},String_BladeSelect=BladeSelect;BladeSelect.__docgenInfo={description:"## String\n### render as `input field` or `select`\nRenders select if schema.enum is defined properly",methods:[],displayName:"BladeSelect",props:{variant:{required:!1,tsType:{name:"union",raw:"'outlined' | 'contained'",elements:[{name:"literal",value:"'outlined'"},{name:"literal",value:"'contained'"}]},description:"",defaultValue:{value:"'outlined'",computed:!1}},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},schema:{required:!1,tsType:{name:"any"},description:""},model:{required:!1,tsType:{name:"any"},description:""},model_id:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"any"},description:""},index:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},required:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},wrapperStyle:{required:!1,tsType:{name:"CSSProperties"},description:"",defaultValue:{value:"{ margin: '0.5rem', flexBasis: '49%', width: 'unset' }",computed:!1}},selectStyle:{required:!1,tsType:{name:"CSSProperties"},description:"",defaultValue:{value:"{}",computed:!1}},textStyle:{required:!1,tsType:{name:"CSSProperties"},description:"",defaultValue:{value:"{}",computed:!1}},menuItemStyle:{required:!1,tsType:{name:"CSSProperties"},description:"",defaultValue:{value:"{}",computed:!1}},hideDesc:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},children:{required:!1,tsType:{name:"JsxElement"},description:""},type:{required:!1,tsType:{name:"string"},description:""}}}}}]);