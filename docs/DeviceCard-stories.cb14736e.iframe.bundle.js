"use strict";(self.webpackChunkledfx=self.webpackChunkledfx||[]).push([[931],{"./src/components/Popover/Popover.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _home_runner_work_LedFx_Frontend_v2_LedFx_Frontend_v2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_mui_material__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@mui/material/esm/styles/useTheme.js"),_mui_material__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@mui/material/esm/MenuItem/MenuItem.js"),_mui_material__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@mui/material/esm/ListItemIcon/ListItemIcon.js"),_mui_material__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@mui/material/esm/Button/Button.js"),_mui_material__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@mui/material/esm/Fab/Fab.js"),_mui_material__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@mui/material/esm/IconButton/IconButton.js"),_mui_material__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@mui/material/esm/Popover/Popover.js"),_mui_material__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@mui/material/esm/Typography/Typography.js"),_mui_icons_material__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@mui/icons-material/esm/Delete.js"),_mui_icons_material__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@mui/icons-material/esm/Check.js"),_mui_icons_material__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/@mui/icons-material/esm/Close.js"),use_long_press__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/use-long-press/index.mjs"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");const Popover=_ref=>{let{onConfirm,onCancel,confirmDisabled,confirmContent,onSingleClick,onDoubleClick,openOnDoubleClick=!1,openOnLongPress=!1,noIcon=!1,disabled=!1,variant="contained",color="secondary",vertical="center",horizontal="left",size="small",text="Are you sure?",label,anchorOrigin,transformOrigin,startIcon,icon=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_icons_material__WEBPACK_IMPORTED_MODULE_3__.A,{}),content,footer,className,style={},sx,sxButton,popoverStyle,wrapperStyle,type="button",open=!1,children}=_ref;const theme=(0,_mui_material__WEBPACK_IMPORTED_MODULE_4__.A)(),[anchorEl,setAnchorEl]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),openPopover=event=>{setAnchorEl((()=>event.currentTarget||event.target))},longPress=(0,use_long_press__WEBPACK_IMPORTED_MODULE_1__.HZ)((e=>openPopover(e)),{onCancel:e=>{onSingleClick&&onSingleClick(e)},threshold:1e3,captureEvent:!0}),opened=Boolean(anchorEl),id=opened?"simple-popover":void 0;return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{setAnchorEl(null)}),[open]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{style:(0,_home_runner_work_LedFx_Frontend_v2_LedFx_Frontend_v2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.A)({display:"initial",margin:0},wrapperStyle),onClick:e=>{e.preventDefault(),e.stopPropagation()},children:["menuItem"===type?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_6__.A,{className,onClick:e=>{e.preventDefault(),onSingleClick&&onSingleClick(e),openPopover(e)},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.A,{children:icon}),label]}):openOnLongPress?"button"===type?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_8__.A,(0,_home_runner_work_LedFx_Frontend_v2_LedFx_Frontend_v2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.A)((0,_home_runner_work_LedFx_Frontend_v2_LedFx_Frontend_v2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.A)({"aria-describedby":id,variant,color,size,className,style,sx:sxButton,startIcon:!noIcon&&startIcon,disabled},longPress),{},{children:[label,!startIcon&&!noIcon&&icon]})):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_9__.A,(0,_home_runner_work_LedFx_Frontend_v2_LedFx_Frontend_v2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.A)((0,_home_runner_work_LedFx_Frontend_v2_LedFx_Frontend_v2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.A)({"aria-label":"clear-data"},longPress),{},{disabled,style:(0,_home_runner_work_LedFx_Frontend_v2_LedFx_Frontend_v2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.A)({margin:"8px"},style),sx:{color:theme.palette.primary.contrastText,bgcolor:theme.palette.primary.main,"&:hover":{bgcolor:theme.palette.primary.light}},children:!startIcon&&!noIcon&&icon})):"button"===type?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_8__.A,{"aria-describedby":id,variant,color,onClick:e=>{e.preventDefault(),openOnDoubleClick||openPopover(e),onSingleClick&&onSingleClick(e)},size,className,style,sx:(0,_home_runner_work_LedFx_Frontend_v2_LedFx_Frontend_v2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.A)((0,_home_runner_work_LedFx_Frontend_v2_LedFx_Frontend_v2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.A)({},sxButton),{},{color:"light"===theme.palette.mode?"#000":"#fff",bgcolor:"transparent","&:hover":{color:"light"===theme.palette.mode?"#fff":"#000",bgcolor:theme.palette.primary.main}}),startIcon:!noIcon&&startIcon,disabled,onDoubleClick:e=>{e.preventDefault(),openOnDoubleClick&&openPopover(e),onDoubleClick&&onDoubleClick(e)},children:[label,!startIcon&&!noIcon&&icon,children]}):"iconbutton"===type?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_10__.A,{color,style,onClick:e=>openPopover(e),disabled,children:!startIcon&&!noIcon&&icon}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_9__.A,{"aria-label":"clear-data",onClick:e=>{e.preventDefault(),openOnDoubleClick||openPopover(e),onSingleClick&&onSingleClick(e)},onDoubleClick:e=>{e.preventDefault(),openOnDoubleClick&&openPopover(e),onDoubleClick&&onDoubleClick(e)},disabled,style:{margin:"8px"},sx:(0,_home_runner_work_LedFx_Frontend_v2_LedFx_Frontend_v2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.A)({bgcolor:theme.palette.primary.main,"&:hover":{bgcolor:theme.palette.primary.light}},sx),children:[!startIcon&&!noIcon&&icon,children]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_11__.Ay,{id,open:opened,anchorEl,onClose:()=>{setAnchorEl(null)},anchorOrigin:anchorOrigin||{vertical,horizontal},transformOrigin:transformOrigin||{vertical,horizontal:"center"===horizontal?"center":"right"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{style:(0,_home_runner_work_LedFx_Frontend_v2_LedFx_Frontend_v2_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.A)({display:"flex"},popoverStyle),children:[content||(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_12__.A,{sx:{padding:theme.spacing(2)},children:text}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_8__.A,{disabled:confirmDisabled,"aria-describedby":id,variant:"contained",color:"primary",onClick:e=>{e.preventDefault(),onConfirm&&onConfirm(e),setAnchorEl(null)},children:confirmContent||(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_icons_material__WEBPACK_IMPORTED_MODULE_13__.A,{})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_8__.A,{"aria-describedby":id,color:"primary",onClick:e=>{e.preventDefault(),onCancel&&onCancel(e),setAnchorEl(null)},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_icons_material__WEBPACK_IMPORTED_MODULE_14__.A,{})})]}),footer]})]})},__WEBPACK_DEFAULT_EXPORT__=Popover;Popover.__docgenInfo={description:"",methods:[],displayName:"Popover",props:{type:{required:!1,tsType:{name:"union",raw:"'menuItem' | 'button' | 'fab' | 'iconbutton'",elements:[{name:"literal",value:"'menuItem'"},{name:"literal",value:"'button'"},{name:"literal",value:"'fab'"},{name:"literal",value:"'iconbutton'"}]},description:"Render as [Button](https://mui.com/api/button/) or [MenuItem](https://mui.com/api/menu-item/) <br />\nexamples: [Button](https://mui.com/components/buttons/), [MenuItem](https://mui.com/components/menu-item/)",defaultValue:{value:"'button'",computed:!1}},variant:{required:!1,tsType:{name:"union",raw:"'text' | 'outlined' | 'contained' | undefined",elements:[{name:"literal",value:"'text'"},{name:"literal",value:"'outlined'"},{name:"literal",value:"'contained'"},{name:"undefined"}]},description:"Set the [variant](https://mui.com/components/buttons/#basic-button)",defaultValue:{value:"'contained'",computed:!1}},color:{required:!1,tsType:{name:"union",raw:"'inherit' | 'secondary' | 'primary' | 'success' | 'error' | 'info' | 'warning' | undefined",elements:[{name:"literal",value:"'inherit'"},{name:"literal",value:"'secondary'"},{name:"literal",value:"'primary'"},{name:"literal",value:"'success'"},{name:"literal",value:"'error'"},{name:"literal",value:"'info'"},{name:"literal",value:"'warning'"},{name:"undefined"}]},description:"Set the [color](https://mui.com/components/buttons/#color)",defaultValue:{value:"'secondary'",computed:!1}},size:{required:!1,tsType:{name:"union",raw:"'small' | 'medium' | 'large' | undefined",elements:[{name:"literal",value:"'small'"},{name:"literal",value:"'medium'"},{name:"literal",value:"'large'"},{name:"undefined"}]},description:"Set the [size](https://mui.com/components/buttons/#sizes)",defaultValue:{value:"'small'",computed:!1}},openOnDoubleClick:{required:!1,tsType:{name:"boolean"},description:"Should the popup open on doubleclick? Ignored if openOnLongPress is `true`",defaultValue:{value:"false",computed:!1}},open:{required:!1,tsType:{name:"boolean"},description:"Open state",defaultValue:{value:"false",computed:!1}},openOnLongPress:{required:!1,tsType:{name:"boolean"},description:"Should the popup open on longpress? (openOnDoubleClick gets ignored if set)",defaultValue:{value:"false",computed:!1}},vertical:{required:!1,tsType:{name:"union",raw:"number | 'center' | 'bottom' | 'top'",elements:[{name:"number"},{name:"literal",value:"'center'"},{name:"literal",value:"'bottom'"},{name:"literal",value:"'top'"}]},description:"Set Popover [position](https://mui.com/components/popover/#anchor-playground)",defaultValue:{value:"'center'",computed:!1}},horizontal:{required:!1,tsType:{name:"union",raw:"number | 'center' | 'left' | 'right'",elements:[{name:"number"},{name:"literal",value:"'center'"},{name:"literal",value:"'left'"},{name:"literal",value:"'right'"}]},description:"Set Popover [position](https://mui.com/components/popover/#anchor-playground)",defaultValue:{value:"'left'",computed:!1}},anchorOrigin:{required:!1,tsType:{name:"PopoverOriginalProps['anchorOrigin']",raw:"PopoverOriginalProps['anchorOrigin']"},description:"Set Popover [position](https://mui.com/components/popover/#anchor-playground)"},transformOrigin:{required:!1,tsType:{name:"PopoverOriginalProps['transformOrigin']",raw:"PopoverOriginalProps['transformOrigin']"},description:"Set Popover [position](https://mui.com/components/popover/#anchor-playground)"},onConfirm:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: any) => typeof e",signature:{arguments:[{type:{name:"any"},name:"e"}],return:{name:"e"}}},description:"Function to call when confirm is clicked"},onCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: any) => typeof e",signature:{arguments:[{type:{name:"any"},name:"e"}],return:{name:"e"}}},description:"Function to call when cancel is clicked"},onSingleClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: any) => typeof e",signature:{arguments:[{type:{name:"any"},name:"e"}],return:{name:"e"}}},description:"Function to call when button is clicked"},onDoubleClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: any) => typeof e",signature:{arguments:[{type:{name:"any"},name:"e"}],return:{name:"e"}}},description:"Function to call when button is doubleclicked"},noIcon:{required:!1,tsType:{name:"boolean"},description:"Remove Icon",defaultValue:{value:"false",computed:!1}},disabled:{required:!1,tsType:{name:"boolean"},description:"Disabled state",defaultValue:{value:"false",computed:!1}},confirmDisabled:{required:!1,tsType:{name:"boolean"},description:"flag indicator"},confirmContent:{required:!1,tsType:{name:"any"},description:"flag indicator"},text:{required:!1,tsType:{name:"string"},description:"Text to show in the popup",defaultValue:{value:"'Are you sure?'",computed:!1}},label:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"[Label](https://mui.com/components/buttons/#buttons-with-icons-and-label)",defaultValue:{value:"undefined",computed:!0}},startIcon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"[startIcon](https://mui.com/components/buttons/#buttons-with-icons-and-label)"},icon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"[Icon](https://mui.com/components/material-icons/)",defaultValue:{value:"<Delete />",computed:!1}},content:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"Content of the Popover"},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"Content"},footer:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"Footer"},className:{required:!1,tsType:{name:"string"},description:"JSX className"},sxButton:{required:!1,tsType:{name:"SxProps",elements:[{name:"Theme"}],raw:"SxProps<Theme>"},description:"JSX style for the Button"},sx:{required:!1,tsType:{name:"SxProps",elements:[{name:"Theme"}],raw:"SxProps<Theme>"},description:"JSX style for the Fab"},style:{required:!1,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:"JSX style",defaultValue:{value:"{}",computed:!1}},popoverStyle:{required:!1,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:"JSX style"},wrapperStyle:{required:!1,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:"JSX style"}}}},"./src/components/SchemaForm/components/BladeFrame.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>components_BladeFrame});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),InfoRounded=__webpack_require__("./node_modules/@mui/icons-material/esm/InfoRounded.js"),styled=__webpack_require__("./node_modules/@mui/material/esm/styles/styled.js"),ClickAwayListener=__webpack_require__("./node_modules/@mui/material/esm/ClickAwayListener/ClickAwayListener.js"),Box=__webpack_require__("./node_modules/@mui/material/esm/Box/Box.js"),Tooltip=__webpack_require__("./node_modules/@mui/material/esm/Tooltip/Tooltip.js"),react=__webpack_require__("./node_modules/react/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const Tooltip_Tooltip=props=>{const[open,setOpen]=(0,react.useState)(!1),handleTooltipClose=()=>{setOpen(!1)};return(0,jsx_runtime.jsx)(ClickAwayListener.x,{onClickAway:handleTooltipClose,children:(0,jsx_runtime.jsx)(Box.A,{sx:{pr:.5,pl:1,display:"flex"},children:(0,jsx_runtime.jsx)(Tooltip.A,(0,objectSpread2.A)((0,objectSpread2.A)({onClose:handleTooltipClose,open,disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0},props),{},{children:(0,jsx_runtime.jsx)(InfoRounded.A,{sx:{cursor:"pointer"},onClick:()=>{setOpen(!0)},fontSize:"small"})}))})})},components_Tooltip=Tooltip_Tooltip;Tooltip_Tooltip.__docgenInfo={description:"",methods:[],displayName:"Tooltip"};const Root=(0,styled.Ay)("div")((_ref=>{let{theme}=_ref;return{minWidth:"23.5%",padding:"16px 1.2rem 6px 1.2rem",border:"1px solid",borderColor:theme.palette.divider,borderRadius:"10px",position:"relative",display:"flex",alignItems:"center",height:"auto",margin:"0.5rem 0","@media (max-width: 580px)":{width:"100% !important",margin:"0.5rem 0"},"& > label":{top:"-0.75rem",display:"flex",alignItems:"center",left:"1rem",padding:"0 0.3rem",position:"absolute",fontVariant:"all-small-caps",fontSize:"0.9rem",letterSpacing:"0.1rem",color:theme.palette.text.secondary,backgroundColor:theme.palette.background.paper,boxSizing:"border-box"}}})),BladeFrame=_ref2=>{let{index,title,children,full=!1,style={width:"unset",order:0},required=!1,variant="outlined",className,disabled,labelStyle,onClick,tooltip}=_ref2;return"outlined"===variant?(0,jsx_runtime.jsxs)(Root,{className:className||"",style:(0,objectSpread2.A)((0,objectSpread2.A)({},style),{},{width:full?"100%":style.width}),onClick,children:[(0,jsx_runtime.jsxs)("label",{style:(0,objectSpread2.A)({},labelStyle),className:"MuiFormLabel-root".concat(disabled?" Mui-disabled":"","  step-effect-").concat(index),children:[title,required?"*":"",tooltip?(0,jsx_runtime.jsx)(components_Tooltip,{sx:{ml:1,mr:.5},title:tooltip,arrow:!0,placement:"top",children:(0,jsx_runtime.jsx)(InfoRounded.A,{fontSize:"small"})}):null]}),children]}):children},components_BladeFrame=BladeFrame;BladeFrame.__docgenInfo={description:"",methods:[],displayName:"BladeFrame",props:{title:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"undefined",computed:!0}},index:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"undefined",computed:!0}},children:{required:!1,tsType:{name:"any"},description:"",defaultValue:{value:"undefined",computed:!0}},full:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},style:{required:!1,tsType:{name:"any"},description:"",defaultValue:{value:"{\n  width: 'unset',\n  order: 0\n}",computed:!1}},required:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},variant:{required:!1,tsType:{name:"union",raw:"'outlined' | 'contained' | 'inherit'",elements:[{name:"literal",value:"'outlined'"},{name:"literal",value:"'contained'"},{name:"literal",value:"'inherit'"}]},description:"",defaultValue:{value:"'outlined'",computed:!1}},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"",defaultValue:{value:"undefined",computed:!0}},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"undefined",computed:!0}},labelStyle:{required:!1,tsType:{name:"any"},description:"",defaultValue:{value:"undefined",computed:!0}},onClick:{required:!1,tsType:{name:"union",raw:"any | undefined",elements:[{name:"any"},{name:"undefined"}]},description:"",defaultValue:{value:"undefined",computed:!0}},tooltip:{required:!1,tsType:{name:"ReactNode"},description:"",defaultValue:{value:"undefined",computed:!0}}}}},"./src/pages/Devices/DeviceCard/DeviceCard.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>DeviceCard_stories});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),chunk_NL6KNZEE=__webpack_require__("./node_modules/react-router/dist/development/chunk-NL6KNZEE.mjs"),react=__webpack_require__("./node_modules/react/index.js"),useTheme=__webpack_require__("./node_modules/@mui/material/esm/styles/useTheme.js"),Card=__webpack_require__("./node_modules/@mui/material/esm/Card/Card.js"),Button=__webpack_require__("./node_modules/@mui/material/esm/Button/Button.js"),Settings=__webpack_require__("./node_modules/@mui/icons-material/esm/Settings.js"),Visibility=__webpack_require__("./node_modules/@mui/icons-material/esm/Visibility.js"),Tune=__webpack_require__("./node_modules/@mui/icons-material/esm/Tune.js"),Build=__webpack_require__("./node_modules/@mui/icons-material/esm/Build.js"),Collapse=__webpack_require__("./node_modules/@mui/material/esm/Collapse/Collapse.js"),ExpandMore=__webpack_require__("./node_modules/@mui/icons-material/esm/ExpandMore.js"),IconButton=__webpack_require__("./node_modules/@mui/material/esm/IconButton/IconButton.js"),Typography=__webpack_require__("./node_modules/@mui/material/esm/Typography/Typography.js"),SyncProblem=__webpack_require__("./node_modules/@mui/icons-material/esm/SyncProblem.js"),Pause=__webpack_require__("./node_modules/@mui/icons-material/esm/Pause.js"),PlayArrow=__webpack_require__("./node_modules/@mui/icons-material/esm/PlayArrow.js"),Stop=__webpack_require__("./node_modules/@mui/icons-material/esm/Stop.js"),PestControl=__webpack_require__("./node_modules/@mui/icons-material/esm/PestControl.js"),Delete=__webpack_require__("./node_modules/@mui/icons-material/esm/Delete.js"),Box=__webpack_require__("./node_modules/@mui/material/esm/Box/Box.js"),CircularProgress=__webpack_require__("./node_modules/@mui/material/esm/CircularProgress/CircularProgress.js"),Stack=__webpack_require__("./node_modules/@mui/material/esm/Stack/Stack.js"),Popover=__webpack_require__("./src/components/Popover/Popover.tsx"),Dialog=__webpack_require__("./node_modules/@mui/material/esm/Dialog/Dialog.js"),AppBar=__webpack_require__("./node_modules/@mui/material/esm/AppBar/AppBar.js"),Toolbar=__webpack_require__("./node_modules/@mui/material/esm/Toolbar/Toolbar.js"),NavigateBefore=__webpack_require__("./node_modules/@mui/icons-material/esm/NavigateBefore.js"),Slide=__webpack_require__("./node_modules/@mui/material/esm/Slide/Slide.js"),MenuItem=__webpack_require__("./node_modules/@mui/material/esm/MenuItem/MenuItem.js"),ListItemIcon=__webpack_require__("./node_modules/@mui/material/esm/ListItemIcon/ListItemIcon.js"),ToggleButtonGroup=__webpack_require__("./node_modules/@mui/material/esm/ToggleButtonGroup/ToggleButtonGroup.js"),ToggleButton=__webpack_require__("./node_modules/@mui/material/esm/ToggleButton/ToggleButton.js"),Tooltip=__webpack_require__("./node_modules/@mui/material/esm/Tooltip/Tooltip.js"),GridOn=__webpack_require__("./node_modules/@mui/icons-material/esm/GridOn.js"),VisibilityOff=__webpack_require__("./node_modules/@mui/icons-material/esm/VisibilityOff.js"),helpers=__webpack_require__("./src/utils/helpers.ts"),useStore=__webpack_require__("./src/store/useStore.ts"),objectWithoutProperties=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),styled=__webpack_require__("./node_modules/@mui/material/esm/styles/styled.js"),DialogTitle=__webpack_require__("./node_modules/@mui/material/esm/DialogTitle/DialogTitle.js"),DialogContent=__webpack_require__("./node_modules/@mui/material/esm/DialogContent/DialogContent.js"),Select=__webpack_require__("./node_modules/@mui/material/esm/Select/Select.js"),DialogActions=__webpack_require__("./node_modules/@mui/material/esm/DialogActions/DialogActions.js"),AddCircle=__webpack_require__("./node_modules/@mui/icons-material/esm/AddCircle.js"),BladeFrame=__webpack_require__("./src/components/SchemaForm/components/BladeFrame.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const _excluded=["onClose","value","open"],classes={root:"".concat("_AddSegmentDialog","-root"),paper:"".concat("_AddSegmentDialog","-paper")},Root=(0,styled.Ay)("div")((_ref=>{let{theme}=_ref;return{["&.".concat(classes.root)]:{margin:"1rem",backgroundColor:theme.palette.background.paper},["& .".concat(classes.paper)]:{width:"80%",maxHeight:435}}}));function ConfirmationDialogRaw(props){const{onClose,value:valueProp,open}=props,other=(0,objectWithoutProperties.A)(props,_excluded),[value,setValue]=react.useState(valueProp),virtuals=(0,useStore.A)((state=>state.virtuals))||{},showComplex=(0,useStore.A)((state=>state.showComplex)),showGaps=(0,useStore.A)((state=>state.showGaps));delete other.deviceList;const deviceKeys=Object.keys(props.deviceList).filter((v=>showComplex?v:!(v.endsWith("-mask")||v.endsWith("-foreground")||v.endsWith("-background")))).filter((v=>showGaps?v:!v.startsWith("gap-")));return(0,jsx_runtime.jsxs)(Dialog.A,(0,objectSpread2.A)((0,objectSpread2.A)({disableEscapeKeyDown:!0,maxWidth:"xs","aria-labelledby":"confirmation-dialog-title",open},other),{},{children:[(0,jsx_runtime.jsx)(DialogTitle.A,{id:"confirmation-dialog-title",children:"Select a device"}),(0,jsx_runtime.jsx)(DialogContent.A,{dividers:!0,children:(0,jsx_runtime.jsx)(BladeFrame.A,{full:!0,children:(0,jsx_runtime.jsx)(Select.A,{value,style:{width:"100%"},onChange:event=>{setValue(event.target.value)},children:deviceKeys.map((device=>{var _virtuals$props$devic,_virtuals$props$devic2,_props$deviceList$dev,_props$deviceList$dev2;return(0,jsx_runtime.jsx)(MenuItem.A,{value:props.deviceList[device].id,children:(null===(_virtuals$props$devic=virtuals[props.deviceList[device].id])||void 0===_virtuals$props$devic||null===(_virtuals$props$devic2=_virtuals$props$devic.config)||void 0===_virtuals$props$devic2?void 0:_virtuals$props$devic2.name)||(null===(_props$deviceList$dev=props.deviceList[device])||void 0===_props$deviceList$dev||null===(_props$deviceList$dev2=_props$deviceList$dev.config)||void 0===_props$deviceList$dev2?void 0:_props$deviceList$dev2.name)},props.deviceList[device].id)}))})})}),(0,jsx_runtime.jsxs)(DialogActions.A,{children:[(0,jsx_runtime.jsx)(Button.A,{autoFocus:!0,onClick:()=>{onClose()},color:"primary",children:"Cancel"}),(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{onClose(value)},color:"primary",children:"Ok"})]})]}))}function ConfirmationDialog(_ref2){let{virtual,config={}}=_ref2;const[open,setOpen]=react.useState(!1),deviceList=(0,useStore.A)((state=>state.devices))||{},virtuals=(0,useStore.A)((state=>state.virtuals))||{},updateSegments=(0,useStore.A)((state=>state.updateSegments)),getVirtuals=(0,useStore.A)((state=>state.getVirtuals)),highlightSegment=(0,useStore.A)((state=>state.highlightSegment)),setEffect=(0,useStore.A)((state=>state.setEffect));return(0,jsx_runtime.jsx)(Root,{className:classes.root,children:deviceList&&Object.keys(deviceList).length>0?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Button.A,{variant:"contained",color:"primary","aria-label":"Add",endIcon:(0,jsx_runtime.jsx)(AddCircle.A,{}),onClick:()=>{setOpen(!0)},role:"listitem",children:"ADD NEW SEGMENT"}),(0,jsx_runtime.jsx)(ConfirmationDialogRaw,{classes:{paper:classes.paper},config,id:"ringtone-menu",keepMounted:!0,open,onClose:newValue=>{if(setOpen(!1),newValue){const device=(0,objectSpread2.A)({},deviceList[Object.keys(deviceList).find((d=>deviceList[d].id===newValue))||0]);if(device&&null!=device&&device.config){var _device$config$pixel_,_device$config;const test=[...virtual.segments,[device.id,0,(null!==(_device$config$pixel_=null==device||null===(_device$config=device.config)||void 0===_device$config?void 0:_device$config.pixel_count)&&void 0!==_device$config$pixel_?_device$config$pixel_:0)-1,!1]].filter((t=>4===t.length));updateSegments(virtual.id,test).then((()=>{var _virtuals$device$acti,_device$config$pixel_2,_device$config2;(getVirtuals(),!1===virtual.active&&0===virtual.segments.length)&&(device.active_virtuals&&device.active_virtuals[0]&&virtuals&&virtuals[device.active_virtuals[0]]&&virtuals[device.active_virtuals[0]].effect&&virtuals[device.active_virtuals[0]].effect.type?setEffect(virtual.id,virtuals[device.active_virtuals[0]].effect.type,null===(_virtuals$device$acti=virtuals[device.active_virtuals[0]].effect)||void 0===_virtuals$device$acti?void 0:_virtuals$device$acti.config,!0):setEffect(virtual.id,"rainbow",{},!0));device&&null!=device&&device.config&&highlightSegment(virtual.id,device.id,0,(null!==(_device$config$pixel_2=null==device||null===(_device$config2=device.config)||void 0===_device$config2?void 0:_device$config2.pixel_count)&&void 0!==_device$config$pixel_2?_device$config$pixel_2:0)-1,!1)}))}}},value:"",deviceList})]}):null})}ConfirmationDialog.__docgenInfo={description:"",methods:[],displayName:"ConfirmationDialog",props:{virtual:{required:!0,tsType:{name:"any"},description:""},config:{required:!1,tsType:{name:"any"},description:"",defaultValue:{value:"{}",computed:!1}}}};var ExpandLess=__webpack_require__("./node_modules/@mui/icons-material/esm/ExpandLess.js"),SwapHoriz=__webpack_require__("./node_modules/@mui/icons-material/esm/SwapHoriz.js"),index_module=__webpack_require__("./node_modules/use-debounce/dist/index.module.js"),Slider=__webpack_require__("./node_modules/@mui/material/esm/Slider/Slider.js"),TextField=__webpack_require__("./node_modules/@mui/material/esm/TextField/TextField.js");const PixelSlider=_ref=>{let{s,handleRangeSegment}=_ref;const devices=(0,useStore.A)((state=>state.devices)),[range,setRange]=(0,react.useState)([s[1],s[2]]),throttled=(0,index_module.dh)(((_event,newValue)=>{newValue!==pixelRange&&handleRangeSegment(newValue[0],newValue[1])}),100);if((0,react.useEffect)((()=>{setRange([s[1],s[2]])}),[s]),!devices[s[0]])return null;const pixelRange=[s[1],s[2]],marks=[{value:0,label:1},{value:(devices[s[0]].config.pixel_count||0)-1,label:devices[s[0]].config.pixel_count}];return(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:5,alignItems:"flex-start",flexBasis:"100%",children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:1,alignItems:"flex-start",alignSelf:"flex-end",children:[(0,jsx_runtime.jsx)(TextField.A,{size:"small",type:"number",sx:{minWidth:"80px"},slotProps:{htmlInput:{style:{padding:"4.5px 14px"},min:1,max:devices[s[0]].config.pixel_count}},value:range[0]+1,onChange:e=>{if(!(parseInt(e.target.value,10)>range[1]+1)){if(parseInt(e.target.value,10)<1)return setRange([0,range[1]]),void throttled(e,[0,range[1]]);setRange([parseInt(e.target.value,10)-1,range[1]]),throttled(e,[parseInt(e.target.value,10)-1,range[1]])}}}),(0,jsx_runtime.jsx)(TextField.A,{size:"small",type:"number",sx:{minWidth:"80px"},slotProps:{htmlInput:{style:{padding:"4.5px 14px"},min:range[0]+1,max:devices[s[0]].config.pixel_count}},value:range[1]+1,onChange:e=>""===e.target.value||parseInt(e.target.value,10)<range[0]+1?(setRange([range[0],range[0]+1]),void throttled(e,[range[0],range[0]+1])):parseInt(e.target.value,10)>(devices[s[0]].config.pixel_count||0)?(setRange([range[0],(devices[s[0]].config.pixel_count||0)-1]),void throttled(e,[range[0],(devices[s[0]].config.pixel_count||0)-1])):(setRange([range[0],parseInt(e.target.value,10)-1]),void throttled(e,[range[0],parseInt(e.target.value,10)-1]))})]}),(0,jsx_runtime.jsx)(Slider.Ay,{sx:{alignSelf:"center"},value:range,marks,valueLabelFormat:e=>e+1,min:0,max:(devices[s[0]].config.pixel_count||0)-1,onChange:(_event,n)=>{setRange(n),throttled(_event,n)},"aria-labelledby":"range-slider",valueLabelDisplay:"auto"})]})},EditVirtuals_PixelSlider=PixelSlider;PixelSlider.__docgenInfo={description:"",methods:[],displayName:"PixelSlider"};var makeStyles=__webpack_require__("./node_modules/@mui/styles/makeStyles/makeStyles.js");const Segment_styles=(0,makeStyles.A)((()=>({segmentsWrapper:{display:"flex",borderBottom:"1px dashed #aaa",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0"},segmentsColOrder:{display:"flex",justifyContent:"space-between",alignItems:"center"},segmentsButtonUp:{borderTopRightRadius:0,borderBottomRightRadius:0,minWidth:"50px"},segmentsButtonDown:{borderTopLeftRadius:0,borderBottomLeftRadius:0,minWidth:"50px",marginRight:"1rem"},segmentsColPixelSlider:{flex:"0 1 70%"},segmentsColActions:{display:"flex",justifyContent:"space-between",alignItems:"center"},"@media (max-width: 600px)":{segmentsColPixelSlider:{order:3,width:"calc(100% - 2rem)",margin:"2rem auto 0 auto"},segmentsWrapper:{flexDirection:"column",alignItems:"flex-start"},segmentsColActions:{position:"absolute",right:"1rem"}}}))),Segment=_ref=>{let{s,i,virtual,segments,calib}=_ref;const devices=(0,useStore.A)((state=>state.devices)),virtuals=(0,useStore.A)((state=>state.virtuals)),title=devices&&virtuals&&virtuals[devices&&Object.keys(devices).find((d=>d===s[0]))].config.name,classes=Segment_styles(),updateSegments=(0,useStore.A)((state=>state.updateSegments)),highlightSegment=(0,useStore.A)((state=>state.highlightSegment)),highlightOffSegment=(0,useStore.A)((state=>state.highlightOffSegment)),getVirtuals=(0,useStore.A)((state=>state.getVirtuals)),activeSegment=(0,useStore.A)((state=>state.activeSegment)),setActiveSegment=(0,useStore.A)((state=>state.setActiveSegment)),reorder=direction=>{const newSegments="UP"===direction?(0,helpers.wg)(segments,i-1,i):(0,helpers.wg)(segments,i,i+1);updateSegments(virtual.id,newSegments).then((()=>{getVirtuals(),calib&&(highlightSegment(virtual.id,newSegments["UP"===direction?i-1:i+1][0],newSegments["UP"===direction?i-1:i+1][1],newSegments["UP"===direction?i-1:i+1][2],newSegments["UP"===direction?i-1:i+1][3]),setActiveSegment("UP"===direction?i-1:i+1))}))};return(0,jsx_runtime.jsx)("div",{style:{padding:"0 1rem",background:calib&&i===activeSegment?"#ffffff18":""},children:(0,jsx_runtime.jsxs)("div",{className:classes.segmentsWrapper,children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",spacing:1,alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(Typography.A,{color:"textSecondary",marginTop:1,marginBottom:-1,children:title}),(0,jsx_runtime.jsx)("div",{className:classes.segmentsColOrder,children:(0,jsx_runtime.jsxs)("div",{style:{display:"flex"},children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(Button.A,{disabled:0===i,color:"inherit",onClick:()=>reorder("UP"),size:"small",className:classes.segmentsButtonUp,children:(0,jsx_runtime.jsx)(ExpandLess.A,{})})}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(Button.A,{disabled:i===virtual.segments.length-1,color:"inherit",onClick:()=>reorder("DOWN"),size:"small",className:classes.segmentsButtonDown,children:(0,jsx_runtime.jsx)(ExpandMore.A,{})})})]})})]}),(0,jsx_runtime.jsx)("div",{className:classes.segmentsColPixelSlider,style:{alignSelf:"stretch",display:"flex",flexDirection:"column"},children:(0,jsx_runtime.jsx)(EditVirtuals_PixelSlider,{s,handleRangeSegment:(start,end)=>{const newSegments=segments.map(((seg,index)=>index===i?[seg[0],start,end,seg[3]]:seg));updateSegments(virtual.id,newSegments).then((()=>{getVirtuals(),calib&&(highlightSegment(virtual.id,newSegments[i][0],newSegments[i][1],newSegments[i][2],newSegments[i][3]),setActiveSegment(i))}))}})}),(0,jsx_runtime.jsxs)("div",{className:classes.segmentsColActions,children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(Button.A,{variant:s[3]?"contained":"outlined",color:s[3]?"primary":"inherit",endIcon:(0,jsx_runtime.jsx)(SwapHoriz.A,{}),onClick:()=>{const newSegments=segments.map(((seg,index)=>index===i?[seg[0],seg[1],seg[2],!seg[3]]:seg));updateSegments(virtual.id,newSegments).then((()=>{getVirtuals(),calib&&(highlightSegment(virtual.id,newSegments[i][0],newSegments[i][1],newSegments[i][2],newSegments[i][3]),setActiveSegment(i))}))},style:{margin:"0 1rem 0 1.5rem"},children:"Flip"})}),(0,jsx_runtime.jsx)(Popover.A,{variant:"outlined",color:"primary",onConfirm:()=>{const newSegments=segments.filter(((_seg,index)=>index!==i));updateSegments(virtual.id,newSegments).then((()=>{getVirtuals(),calib&&(highlightOffSegment(virtual.id),setActiveSegment(-1))}))},style:{padding:"5px"}})]})]})})},EditVirtuals_Segment=Segment;Segment.__docgenInfo={description:"",methods:[],displayName:"Segment"};const EditVirtuals_styles=(0,makeStyles.A)((()=>({appBar:{position:"relative"},title:{flex:1},dialog:{},segmentTitle:{display:"flex",borderBottom:"1px dashed #aaa",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0",margin:"0 1rem"},segmentButtonWrapper:{display:"flex",justifyContent:"center",alignItems:"center",padding:"0.5rem 0",margin:"0 1rem"},cloudEffectCard:{cursor:"pointer",width:280}})));var objectDestructuringEmpty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty.js"),index_esm=__webpack_require__("./node_modules/react-zoom-pan-pinch/dist/index.esm.js"),core_esm=__webpack_require__("./node_modules/@dnd-kit/core/dist/core.esm.js"),modifiers_esm=__webpack_require__("./node_modules/@dnd-kit/modifiers/dist/modifiers.esm.js");const MCell={deviceId:"",pixel:0,group:"0-0"},getMaxRange=(direction,row,col,rowN,colN)=>{let maxRange=0;return direction.includes("right")?(maxRange=colN*rowN-(row*colN+col),direction.includes("flip")&&(maxRange=row*colN+colN-col)):direction.includes("left")?(maxRange=row*colN+col+1,direction.includes("flip")&&(maxRange=(rowN-row-1)*colN+col+1)):direction.includes("bottom")?(maxRange=colN*rowN-(rowN*col+(rowN-row-1)),direction.includes("flip")&&(maxRange=rowN*col+(rowN-row))):direction.includes("top")&&(maxRange=rowN*col+row+1,direction.includes("flip")&&(maxRange=colN*rowN-(rowN*col+(rowN-row-1)))),maxRange-1},clone=input=>JSON.parse(JSON.stringify(input)),M_styles=(0,makeStyles.A)((()=>({gridCell:{cursor:"copy",border:"1px solid #666",width:100,height:100},gridCellContainer:{background:"#111",display:"flex",justifyContent:"center",alignItems:"center",position:"relative"},gridCellInner:{display:"flex",flexWrap:"wrap",height:"100%",width:"100%"},pixel:{display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center",height:"98px",background:"transparent",width:"98px",border:"5px solid #111",boxSizing:"border-box",padding:"8px",borderRadius:"10px"},centered:{display:"flex",width:"100%",justifyContent:"space-between"}}))),MWrapper=_ref=>{let{children,move}=_ref;return(0,jsx_runtime.jsx)(Box.A,{sx:[{display:"flex",justifyContent:"flex-start",alignItems:"flex-start",maxHeight:"calc(100vh - 64px)",height:"100%","& .react-transform-wrapper":{height:"100%",width:"100%"}},"landscape"===window.screen.orientation.type.split("-")[0]?{flexDirection:"row"}:{flexDirection:"column"},move?{"& .react-transform-wrapper":{overflow:"auto"}}:{"& .react-transform-wrapper":{overflow:"hidden"}}],children})},EditMatrix_MWrapper=MWrapper;MWrapper.__docgenInfo={description:"",methods:[],displayName:"MWrapper"};var EmergencyRecording=__webpack_require__("./node_modules/@mui/icons-material/esm/EmergencyRecording.js"),FormControl=__webpack_require__("./node_modules/@mui/material/esm/FormControl/FormControl.js"),InputLabel=__webpack_require__("./node_modules/@mui/material/esm/InputLabel/InputLabel.js"),react_webcam=__webpack_require__("./node_modules/react-webcam/dist/react-webcam.js"),react_webcam_default=__webpack_require__.n(react_webcam);const utils_calculateImageDifference=function calculateImageDifference(img1,img2){let threshold=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128,ignoreTop=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,ignoreLeft=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,ignoreBottom=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,ignoreRight=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const width=img1.width-ignoreLeft-ignoreRight,height=img1.height-ignoreTop-ignoreBottom,canvas=document.createElement("canvas");canvas.width=width,canvas.height=height;const context=canvas.getContext("2d",{willReadFrequently:!0});if(!context)throw new Error("Could not get 2d context");context.drawImage(img1,ignoreLeft,ignoreTop,width,height,0,0,width,height);const imageData1=context.getImageData(0,0,width,height).data;context.clearRect(0,0,width,height),context.drawImage(img2,ignoreLeft,ignoreTop,width,height,0,0,width,height);const imageData2=context.getImageData(0,0,width,height).data,diffData=new Uint8ClampedArray(width*height*4),whitePixels=[];for(let i=0;i<width*height*4;i+=4){const diffAlpha=255,outputValue=(Math.abs(imageData1[i]-imageData2[i])+Math.abs(imageData1[i+1]-imageData2[i+1])+Math.abs(imageData1[i+2]-imageData2[i+2]))/3>threshold?255:0;if(diffData[i]=outputValue,diffData[i+1]=outputValue,diffData[i+2]=outputValue,diffData[i+3]=diffAlpha,255===outputValue){const x=i/4%width,y=Math.floor(i/4/width);whitePixels.push({x,y})}}const whitePixelsCount=whitePixels.length,whitePixelsCenter=whitePixels.reduce(((acc,_ref)=>{let{x,y}=_ref;return{x:acc.x+x,y:acc.y+y}}),{x:0,y:0});return whitePixelsCenter.x/=whitePixelsCount,whitePixelsCenter.y/=whitePixelsCount,context.putImageData(new window.ImageData(diffData,width,height),0,0),context.beginPath(),context.arc(whitePixelsCenter.x,whitePixelsCenter.y,5,0,2*Math.PI,!1),context.fillStyle="red",context.fill(),{diffImage:canvas.toDataURL("image/webp"),whitePixelsCenter}};const utils_createImageFromData=async function createImageFromData(imageData){const blob=new Blob([imageData],{type:"image/webp"}),url=URL.createObjectURL(blob),img=new Image;return img.src=url,await new Promise((resolve=>{img.onload=resolve})),img};const utils_decodeBase64ToImageData=function decodeBase64ToImageData(base64String){const base64Data=base64String.split(",")[1],imageData=atob(base64Data),buffer=new Uint8Array(imageData.length);for(let i=0;i<imageData.length;i++)buffer[i]=imageData.charCodeAt(i);return buffer};const utils_adjust=async function adjust(capture,initialImage){let threshold=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128,ignoreTop=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,ignoreLeft=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,ignoreBottom=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,ignoreRight=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,pointsRef=arguments.length>7?arguments[7]:void 0;!async function processImages(img1b64,img2b64){let threshold=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128,ignoreTop=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,ignoreLeft=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,ignoreBottom=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,ignoreRight=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,pointsRef=arguments.length>7?arguments[7]:void 0;try{const imageData1=utils_decodeBase64ToImageData(img1b64),image1=await utils_createImageFromData(imageData1),imageData2=utils_decodeBase64ToImageData(img2b64),image2=await utils_createImageFromData(imageData2),diffData=utils_calculateImageDifference(image1,image2,threshold,ignoreTop,ignoreLeft,ignoreBottom,ignoreRight),diffImageBase64=diffData.diffImage;pointsRef&&(pointsRef.current=diffData.whitePixelsCenter);const diffImageElement=document.getElementById("diffImage");diffImageElement&&diffImageElement instanceof HTMLImageElement&&(diffImageElement.src=diffImageBase64)}catch(error){console.error("Error processing images:",error)}}(initialImage,await capture(),threshold,ignoreTop,ignoreLeft,ignoreBottom,ignoreRight,pointsRef)},utils_wled=async body=>{const wledIp=useStore.A.getState().videoMapper.wledIp;try{const response=await fetch("http://".concat(wledIp,"/json"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(body)});return await response.json()}catch(error){console.error(error)}};const utils_preadjust=async function preadjust(){await utils_wled({on:!0}),await utils_wled({seg:{on:!0,col:[[255,0,0],[255,0,0],[255,0,0]]}})},getLedCount=async wledIp=>{try{const response=await fetch("http://".concat(wledIp,"/json/info"));return(await response.json()).leds.count}catch(error){console.error(error)}};function transpose(inputX,inputY,inputWidth,inputHeight,outputWidth,outputHeight){return{x:Math.floor(inputX/inputWidth*outputWidth),y:Math.floor(inputY/inputHeight*outputHeight)}}const utils_wait=ms=>new Promise((resolve=>setTimeout(resolve,ms))),utils_wledGet=async function(){let path=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"state";const wledIp=useStore.A.getState().videoMapper.wledIp;if(wledIp&&""!==wledIp)try{const response=await fetch("http://".concat(wledIp,"/json/").concat(path));return await response.json()||response}catch(error){console.error(error)}},utils_iterativeOnOnlyOne=async function(waitingTime,pointsRef){let inputWidth=arguments.length>2&&void 0!==arguments[2]?arguments[2]:400,inputHeight=arguments.length>3&&void 0!==arguments[3]?arguments[3]:300,outputWidth=arguments.length>4&&void 0!==arguments[4]?arguments[4]:50,outputHeight=arguments.length>5&&void 0!==arguments[5]?arguments[5]:50,addPoint=arguments.length>6?arguments[6]:void 0,device=arguments.length>7?arguments[7]:void 0;const segments=(await utils_wledGet()).seg;let totalPreviousLength=0;for(const segment of segments){for(let i=0;i<segment.len+1;i++){var _pointsRef$current,_pointsRef$current2;const singleLedOn={seg:{id:segment.id,i:0===i?[i,i+1,"FFFFFF",i+1,segment.len,"000000"]:[0,i,"000000",i,i+1,"FFFFFF",i+1,segment.len,"000000"]}};await utils_wled(singleLedOn);const transposed=transpose(null==pointsRef||null===(_pointsRef$current=pointsRef.current)||void 0===_pointsRef$current?void 0:_pointsRef$current.x,null==pointsRef||null===(_pointsRef$current2=pointsRef.current)||void 0===_pointsRef$current2?void 0:_pointsRef$current2.y,inputWidth,inputHeight,outputWidth,outputHeight);isNaN(transposed.x)||isNaN(transposed.y)||(addPoint((0,objectSpread2.A)((0,objectSpread2.A)({},transposed),{},{segment:segment.id,led:totalPreviousLength+i,device})),await utils_wait(waitingTime))}totalPreviousLength+=segment.len}};const utils_calibrate=async function calibrate(wledIp,waitTime,pointsRef){let inputWidth=arguments.length>3&&void 0!==arguments[3]?arguments[3]:400,inputHeight=arguments.length>4&&void 0!==arguments[4]?arguments[4]:300,outputWidth=arguments.length>5&&void 0!==arguments[5]?arguments[5]:50,outputHeight=arguments.length>6&&void 0!==arguments[6]?arguments[6]:50,setPoints=arguments.length>7?arguments[7]:void 0,addPoint=arguments.length>8?arguments[8]:void 0,device=arguments.length>9?arguments[9]:void 0;const leds=await getLedCount(wledIp);await async function(){let pixels=arguments.length>0&&void 0!==arguments[0]?arguments[0]:69;await utils_wled({seg:{i:[0,pixels,"000000"]}})}(leds),setPoints([]),await utils_iterativeOnOnlyOne(waitTime/7,pointsRef,inputWidth,inputHeight,outputWidth,outputHeight,addPoint,device),await(async()=>{await utils_wled({seg:{on:!0,col:[0,0,0]}})})(),setPoints([])};const utils_initialize=async function initialize(capture){return await utils_wled({seg:{on:!1}}),await utils_wait(1e3),await capture()},utils_oneLed=async led=>{const segments=(await utils_wledGet("state")).seg;let totalLedCount=0;for(const segment of segments){const allLedsOff={seg:{id:segment.id,i:[0,segment.len,"000000"]}};await utils_wled(allLedsOff)}for(const segment of segments)if(totalLedCount+=segment.len,totalLedCount>=led){const ledInSegment=led-(totalLedCount-segment.len),singleLedOn={seg:{id:segment.id,i:[ledInSegment,ledInSegment+1,"FFFFFF"]}};await utils_wled(singleLedOn);break}},utils_setWledBrightness=async function(){let brightness=arguments.length>0&&void 0!==arguments[0]?arguments[0]:255;await utils_wled({bri:brightness})},Webcam=_ref=>{let{colN,rowN}=_ref;const webcamRef=(0,react.useRef)(null),pointsRef=(0,react.useRef)(null),setPoints=(0,useStore.A)((state=>state.setPoints)),addPoint=(0,useStore.A)((state=>state.addPoint)),devices=(0,useStore.A)((state=>state.devices)),wledIps=Object.keys(devices).filter((d=>"wled"===devices[d].type)).map((d=>devices[d].config.ip_address)),[deviceId,setDeviceId]=(0,react.useState)(""),[mDevices,setMDevices]=(0,react.useState)([]),[ip,setIp]=(0,react.useState)(""),wledIp=(0,useStore.A)((state=>state.videoMapper.wledIp)),wledDeviceId=Object.keys(devices).find((d=>devices[d].config.ip_address===wledIp)),setWledIp=(0,useStore.A)((state=>state.setWledIp)),[threshold,setThreshold]=(0,react.useState)(128),[singleLed,setSingleLed]=(0,react.useState)(0),[baseImage,setBaseImage]=(0,react.useState)(""),[maxLed,setMaxLed]=(0,react.useState)(0),[isAdjusting,setIsAdjusting]=(0,react.useState)(!1),[ignoreTop,setIgnoreTop]=(0,react.useState)(0),[ignoreLeft,setIgnoreLeft]=(0,react.useState)(0),[ignoreBottom,setIgnoreBottom]=(0,react.useState)(0),[ignoreRight,setIgnoreRight]=(0,react.useState)(0),[brightness,setBrightness]=(0,react.useState)(255),isCalibrating=(0,useStore.A)((state=>state.videoMapper.calibrating)),setIsCalibrating=(0,useStore.A)((state=>state.setCalibrating)),handleDevices=(0,react.useCallback)((mediaDevices=>{const videoDevices=mediaDevices.filter((_ref2=>{let{kind}=_ref2;return"videoinput"===kind}));""===deviceId&&videoDevices.length>0&&setDeviceId(videoDevices[0].deviceId),setMDevices(videoDevices)}),[setMDevices,deviceId]),capture=(0,react.useCallback)((async()=>{var _webcamRef$current;return null===(_webcamRef$current=webcamRef.current)||void 0===_webcamRef$current?void 0:_webcamRef$current.getScreenshot()}),[webcamRef]);return(0,react.useEffect)((()=>{navigator.mediaDevices.enumerateDevices().then(handleDevices)}),[handleDevices]),(0,react.useEffect)((()=>{setIp(wledIp);(async()=>{if(wledIp&&""!==wledIp){const c=await getLedCount(wledIp);setMaxLed(c)}})()}),[wledIp]),(0,react.useEffect)((()=>{let animationFrameId=null,isCancelled=!1;const adjustFrame=async()=>{isAdjusting&&!isCancelled&&(await utils_adjust(capture,baseImage,threshold,ignoreTop,ignoreLeft,ignoreBottom,ignoreRight,pointsRef),animationFrameId=requestAnimationFrame(adjustFrame))};return utils_preadjust(),adjustFrame(),()=>{isCancelled=!0,animationFrameId&&cancelAnimationFrame(animationFrameId)}}),[isAdjusting,threshold,baseImage,capture,ignoreTop,ignoreLeft,ignoreBottom,ignoreRight]),(0,react.useEffect)((()=>{isCalibrating&&utils_calibrate(wledIp,100,pointsRef,400-ignoreLeft-ignoreRight,300-ignoreBottom-ignoreTop,colN,rowN,setPoints,addPoint,wledDeviceId).then((()=>{setIsCalibrating(!1)}))}),[isCalibrating,wledIp,ignoreTop,ignoreLeft,ignoreBottom,ignoreRight,wledDeviceId,colN,rowN,setPoints,addPoint,setIsCalibrating]),(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",spacing:2,sx:{width:400},children:[(0,jsx_runtime.jsxs)(FormControl.A,{fullWidth:!0,children:[(0,jsx_runtime.jsx)(InputLabel.A,{id:"wled",children:"WLED Devices"}),wledIps.length>0&&(0,jsx_runtime.jsxs)(Select.A,{variant:"outlined",label:"WLED Devices",labelId:"wled",value:wledIp,onChange:e=>setWledIp(e.target.value),children:[(0,jsx_runtime.jsx)(MenuItem.A,{value:"",disabled:!0,children:"Select WLED Device"},""),wledIps.map((wledip=>(0,jsx_runtime.jsx)(MenuItem.A,{value:wledip,children:wledip},wledip)))]})]}),(0,jsx_runtime.jsx)(TextField.A,{fullWidth:!0,sx:{display:"none"},label:"IP",value:ip,onChange:e=>setIp(e.target.value)}),(0,jsx_runtime.jsxs)(FormControl.A,{fullWidth:!0,children:[(0,jsx_runtime.jsx)(InputLabel.A,{id:"camera",children:"Camera"}),(0,jsx_runtime.jsx)(Select.A,{label:"Camera",labelId:"camera",variant:"outlined",value:deviceId,onChange:e=>setDeviceId(e.target.value),children:mDevices.map(((device,key)=>(0,jsx_runtime.jsx)(MenuItem.A,{value:device.deviceId,children:device.label||"Device ".concat(key+1)},device.deviceId)))})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Button.A,{onClick:async()=>{const img=await utils_initialize(capture);setBaseImage(img)},className:"step-2d-virtual-cam-initialize",children:"Initialize"}),(0,jsx_runtime.jsx)(Button.A,{onClick:()=>setIsAdjusting(!isAdjusting),className:"step-2d-virtual-cam-adjust",children:isAdjusting?"Stop Adjust":"Adjust"}),(0,jsx_runtime.jsx)(Button.A,{disabled:isCalibrating||!isAdjusting,onClick:()=>setIsCalibrating(!0),className:"step-2d-virtual-cam-calibrate",children:isCalibrating?"Calibrating":"Calibrate"})]}),(0,jsx_runtime.jsx)(react_webcam_default(),{ref:webcamRef,width:"100%",mirrored:!1,audio:!1,videoConstraints:{deviceId}}),(0,jsx_runtime.jsx)("br",{}),!isCalibrating&&!isAdjusting&&(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",className:"step-2d-virtual-cam-crop",children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Typography.A,{width:120,children:"Cut Top"}),(0,jsx_runtime.jsx)(Slider.Ay,{min:0,max:150,value:ignoreTop,onChange:(_,v)=>setIgnoreTop(v)})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Typography.A,{width:120,children:"Cut Left"}),(0,jsx_runtime.jsx)(Slider.Ay,{min:0,max:200,value:ignoreLeft,onChange:(_,v)=>setIgnoreLeft(v)})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Typography.A,{width:120,children:"Cut Bottom"}),(0,jsx_runtime.jsx)(Slider.Ay,{min:0,max:150,value:ignoreBottom,onChange:(_,v)=>setIgnoreBottom(v)})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Typography.A,{width:120,children:"Cut Right"}),(0,jsx_runtime.jsx)(Slider.Ay,{min:0,max:200,value:ignoreRight,onChange:(_,v)=>setIgnoreRight(v)})]})]}),!isCalibrating&&isAdjusting&&(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",className:"step-2d-virtual-cam-settings",children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Typography.A,{width:120,children:"Led"}),(0,jsx_runtime.jsx)(Slider.Ay,{min:0,step:1,max:maxLed,value:singleLed,onChange:(_,v)=>{setSingleLed(v),utils_oneLed(v)}})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Typography.A,{width:120,children:"Brightness"}),(0,jsx_runtime.jsx)(Slider.Ay,{min:0,max:255,value:brightness,onChange:(_,v)=>{setBrightness(v),utils_setWledBrightness(v)}})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Typography.A,{width:120,children:"Threshold"}),(0,jsx_runtime.jsx)(Slider.Ay,{min:0,max:255,value:threshold,onChange:(_,v)=>setThreshold(v)})]})]}),!isAdjusting&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("br",{}),"Base Image:",(0,jsx_runtime.jsxs)("div",{style:{position:"relative",margin:0,height:300},children:[(0,jsx_runtime.jsx)("img",{src:baseImage,alt:"baseImage"},"baseImage"),(0,jsx_runtime.jsx)("div",{style:{position:"absolute",top:0,left:0,bottom:0,right:400-ignoreLeft,background:"#444"}}),(0,jsx_runtime.jsx)("div",{style:{position:"absolute",top:300-ignoreBottom,left:0,bottom:0,right:0,background:"#444"}}),(0,jsx_runtime.jsx)("div",{style:{position:"absolute",top:0,left:0,bottom:300-ignoreTop,right:0,background:"#444"}}),(0,jsx_runtime.jsx)("div",{style:{position:"absolute",top:0,left:400-ignoreRight,bottom:0,right:0,background:"#444"}})]})]}),isAdjusting&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Diff Image:",(0,jsx_runtime.jsx)("img",{id:"diffImage",alt:"diff"})]})]})},Webcam_Webcam=Webcam;Webcam.__docgenInfo={description:"",methods:[],displayName:"Webcam",props:{colN:{required:!0,tsType:{name:"number"},description:""},rowN:{required:!0,tsType:{name:"number"},description:""}}};var ArrowUpward=__webpack_require__("./node_modules/@mui/icons-material/esm/ArrowUpward.js"),ArrowBack=__webpack_require__("./node_modules/@mui/icons-material/esm/ArrowBack.js"),Cancel=__webpack_require__("./node_modules/@mui/icons-material/esm/Cancel.js"),ArrowForward=__webpack_require__("./node_modules/@mui/icons-material/esm/ArrowForward.js"),ArrowDownward=__webpack_require__("./node_modules/@mui/icons-material/esm/ArrowDownward.js");const Actions_moveSelectedGroupUp=_ref=>{let{m,selectedGroup,setError,setM}=_ref;const groupPixels=[];for(let i=0;i<m.length;i++)for(let j=0;j<m[i].length;j++)if(m[i][j].group===selectedGroup){if(i-1<0)return void console.log("Move aborted: group is at the top edge.");groupPixels.push((0,objectSpread2.A)((0,objectSpread2.A)({},m[i][j]),{},{oldRow:i,oldCol:j}))}if(0===groupPixels.length)return;const conflictingCells=[];for(const pixel of groupPixels){const targetRow=pixel.oldRow-1,targetCol=pixel.oldCol,targetCell=m[targetRow][targetCol];""!==targetCell.deviceId&&targetCell.group!==selectedGroup&&conflictingCells.push({row:targetRow,col:targetCol})}if(conflictingCells.length>0)return setError(conflictingCells),void console.log("Move aborted: collision detected with an external pixel.");setError([]);const updatedM=clone(m);for(const pixel of groupPixels)updatedM[pixel.oldRow][pixel.oldCol]={deviceId:"",pixel:0,group:""};for(const pixel of groupPixels){const targetRow=pixel.oldRow-1,targetCol=pixel.oldCol;updatedM[targetRow][targetCol]={deviceId:pixel.deviceId,pixel:pixel.pixel,group:pixel.group}}setM(updatedM)},Actions_moveSelectedGroupLeft=_ref=>{let{m,selectedGroup,setM}=_ref;const groupPixels=[];for(let i=0;i<m.length;i++)for(let j=0;j<m[i].length;j++)if(m[i][j].group===selectedGroup){if(j-1<0)return void console.log("Move aborted: group is at the left edge.");groupPixels.push((0,objectSpread2.A)((0,objectSpread2.A)({},m[i][j]),{},{oldRow:i,oldCol:j}))}if(0===groupPixels.length)return;for(const pixel of groupPixels){const targetRow=pixel.oldRow,targetCol=pixel.oldCol-1,targetCell=m[targetRow][targetCol];if(""!==targetCell.deviceId&&targetCell.group!==selectedGroup)return void console.log("Move aborted: collision detected with an external pixel.")}const updatedM=clone(m);for(const pixel of groupPixels)updatedM[pixel.oldRow][pixel.oldCol]={deviceId:"",pixel:0,group:""};for(const pixel of groupPixels){const targetRow=pixel.oldRow,targetCol=pixel.oldCol-1;updatedM[targetRow][targetCol]={deviceId:pixel.deviceId,pixel:pixel.pixel,group:pixel.group}}setM(updatedM)},Actions_moveSelectedGroupRight=_ref=>{let{m,colN,selectedGroup,setM}=_ref;const groupPixels=[];for(let i=0;i<m.length;i++)for(let j=0;j<m[i].length;j++)if(m[i][j].group===selectedGroup){if(j+1>=colN)return void console.log("Move aborted: group is at the right edge.");groupPixels.push((0,objectSpread2.A)((0,objectSpread2.A)({},m[i][j]),{},{oldRow:i,oldCol:j}))}if(0===groupPixels.length)return;for(const pixel of groupPixels){const targetRow=pixel.oldRow,targetCol=pixel.oldCol+1,targetCell=m[targetRow][targetCol];if(""!==targetCell.deviceId&&targetCell.group!==selectedGroup)return void console.log("Move aborted: collision detected with an external pixel.")}const updatedM=clone(m);for(const pixel of groupPixels)updatedM[pixel.oldRow][pixel.oldCol]={deviceId:"",pixel:0,group:""};for(const pixel of groupPixels){const targetRow=pixel.oldRow,targetCol=pixel.oldCol+1;updatedM[targetRow][targetCol]={deviceId:pixel.deviceId,pixel:pixel.pixel,group:pixel.group}}setM(updatedM)},Actions_moveSelectedGroupDown=_ref=>{let{m,rowN,selectedGroup,setError,setM}=_ref;const groupPixels=[];for(let i=0;i<rowN;i++)for(let j=0;j<m[i].length;j++)if(m[i][j].group===selectedGroup){if(i+1>=rowN)return void console.log("Move aborted: group is at the bottom edge.");groupPixels.push((0,objectSpread2.A)((0,objectSpread2.A)({},m[i][j]),{},{oldRow:i,oldCol:j}))}if(0===groupPixels.length)return;const conflictingCells=[];for(const pixel of groupPixels){const targetRow=pixel.oldRow+1,targetCol=pixel.oldCol,targetCell=m[targetRow][targetCol];""!==targetCell.deviceId&&targetCell.group!==selectedGroup&&conflictingCells.push({row:targetRow,col:targetCol})}if(conflictingCells.length>0)return setError(conflictingCells),void console.log("Move aborted: collision detected with an external pixel.");setError([]);const updatedM=clone(m);for(const pixel of groupPixels)updatedM[pixel.oldRow][pixel.oldCol]={deviceId:"",pixel:0,group:""};for(const pixel of groupPixels){const targetRow=pixel.oldRow+1,targetCol=pixel.oldCol;updatedM[targetRow][targetCol]={deviceId:pixel.deviceId,pixel:pixel.pixel,group:pixel.group}}setM(updatedM)},GroupControls=_ref=>{let{m,rowN,colN,selectedGroup,setSelectedGroup,setM,setError}=_ref;const uniqueGroups=(0,react.useMemo)((()=>{const groups=new Set;return m.flat().forEach((cell=>{cell.group&&"string"==typeof cell.group&&"0-0"!==cell.group&&groups.add(cell.group)})),Array.from(groups)}),[m]);return 0===uniqueGroups.length?null:(0,jsx_runtime.jsxs)(Box.A,{children:[(0,jsx_runtime.jsxs)(FormControl.A,{fullWidth:!0,sx:{mt:2,mb:1},children:[(0,jsx_runtime.jsx)(InputLabel.A,{id:"group-select-label",children:"Move Group"}),(0,jsx_runtime.jsxs)(Select.A,{variant:"outlined",labelId:"group-select-label",id:"group-select",value:selectedGroup||"",label:"Move Group",onChange:e=>setSelectedGroup(e.target.value),children:[(0,jsx_runtime.jsx)(MenuItem.A,{value:"",children:(0,jsx_runtime.jsx)("em",{children:"None"})}),uniqueGroups.map((group=>(0,jsx_runtime.jsx)(MenuItem.A,{value:group,children:group},group)))]})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",spacing:0,alignItems:"center",justifyContent:"center",children:[(0,jsx_runtime.jsx)(IconButton.A,{disabled:!selectedGroup,onClick:()=>Actions_moveSelectedGroupUp({m,rowN,colN,selectedGroup,setError,setM}),children:(0,jsx_runtime.jsx)(ArrowUpward.A,{})}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:0,justifyContent:"center",children:[(0,jsx_runtime.jsx)(IconButton.A,{disabled:!selectedGroup,onClick:()=>Actions_moveSelectedGroupLeft({m,rowN,colN,selectedGroup,setM}),children:(0,jsx_runtime.jsx)(ArrowBack.A,{})}),(0,jsx_runtime.jsx)(IconButton.A,{disabled:!selectedGroup,onClick:()=>setSelectedGroup(""),children:(0,jsx_runtime.jsx)(Cancel.A,{})}),(0,jsx_runtime.jsx)(IconButton.A,{disabled:!selectedGroup,onClick:()=>Actions_moveSelectedGroupRight({m,rowN,colN,selectedGroup,setM}),children:(0,jsx_runtime.jsx)(ArrowForward.A,{})})]}),(0,jsx_runtime.jsx)(IconButton.A,{disabled:!selectedGroup,onClick:()=>Actions_moveSelectedGroupDown({m,rowN,colN,selectedGroup,setError,setM}),children:(0,jsx_runtime.jsx)(ArrowDownward.A,{})})]})]})},MControls_GroupControls=GroupControls;GroupControls.__docgenInfo={description:"",methods:[],displayName:"GroupControls",props:{m:{required:!0,tsType:{name:"Array",elements:[{name:"Array",elements:[{name:"signature",type:"object",raw:"{\n  deviceId: string\n  pixel: number\n  group?: string\n}",signature:{properties:[{key:"deviceId",value:{name:"string",required:!0}},{key:"pixel",value:{name:"number",required:!0}},{key:"group",value:{name:"string",required:!1}}]}}],raw:"IMCell[]"}],raw:"IMCell[][]"},description:""},rowN:{required:!0,tsType:{name:"number"},description:""},colN:{required:!0,tsType:{name:"number"},description:""},selectedGroup:{required:!0,tsType:{name:"string"},description:""},setSelectedGroup:{required:!0,tsType:{name:"signature",type:"function",raw:"(_group: string) => void",signature:{arguments:[{type:{name:"string"},name:"_group"}],return:{name:"void"}}},description:""},setM:{required:!0,tsType:{name:"signature",type:"function",raw:"(_m: IMCell[][]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"Array",elements:[{name:"signature",type:"object",raw:"{\n  deviceId: string\n  pixel: number\n  group?: string\n}",signature:{properties:[{key:"deviceId",value:{name:"string",required:!0}},{key:"pixel",value:{name:"number",required:!0}},{key:"group",value:{name:"string",required:!1}}]}}],raw:"IMCell[]"}],raw:"IMCell[][]"},name:"_m"}],return:{name:"void"}}},description:""},setError:{required:!0,tsType:{name:"signature",type:"function",raw:"(_error: { row: number; col: number }[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"signature",type:"object",raw:"{ row: number; col: number }",signature:{properties:[{key:"row",value:{name:"number",required:!0}},{key:"col",value:{name:"number",required:!0}}]}}],raw:"{ row: number; col: number }[]"},name:"_error"}],return:{name:"void"}}},description:""}}};var Rotate90DegreesCw=__webpack_require__("./node_modules/@mui/icons-material/esm/Rotate90DegreesCw.js"),SwapVert=__webpack_require__("./node_modules/@mui/icons-material/esm/SwapVert.js"),Loop=__webpack_require__("./node_modules/@mui/icons-material/esm/Loop.js"),Save=__webpack_require__("./node_modules/@mui/icons-material/esm/Save.js"),ledfx=__webpack_require__("./src/api/ledfx.ts");function processArray(inputArray){let gapname=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const outputArray=[];let startPixel=null,endPixel=null,deviceId="",flip=!1,gapStart=null;for(let i=0;i<inputArray.length;i+=1)""!==inputArray[i].deviceId?""===deviceId?(null!==gapStart&&(outputArray.push(["gap-".concat(gapname),gapStart,i-1,!1]),gapStart=null),deviceId=inputArray[i].deviceId,startPixel=inputArray[i].pixel,endPixel=inputArray[i].pixel,flip=!1):inputArray[i].deviceId===deviceId&&1===Math.abs(inputArray[i].pixel-endPixel)?(endPixel=inputArray[i].pixel,flip=inputArray[i].pixel<endPixel):(outputArray.push([deviceId,startPixel,endPixel,flip]),deviceId=inputArray[i].deviceId,startPixel=inputArray[i].pixel,endPixel=inputArray[i].pixel,flip=!1):(""!==deviceId&&(outputArray.push([deviceId,startPixel,endPixel,flip]),deviceId=""),null===gapStart&&(gapStart=i));""!==deviceId&&outputArray.push([deviceId,startPixel,endPixel,flip]),null!==gapStart&&outputArray.push(["gap-".concat(gapname),gapStart,inputArray.length-1,!1]);for(let i=0;i<outputArray.length;i++){const item=outputArray[i];item[1]>item[2]&&(item[3]=item[1]>item[2],[item[1],item[2]]=[item[2],item[1]])}return outputArray}function reverseProcessArray(outputArray,rows){const inputArray=[],finalArray=[];let group="0-0";for(let i=0;i<outputArray.length;i+=1){const[deviceId,startPixel,endPixel,flip]=outputArray[i];if(deviceId.startsWith("gap-"))for(let j=startPixel;j<=endPixel;j+=1)inputArray.push({deviceId:"",pixel:j,group:"0-0"});else if(flip)for(let j=endPixel;j>=startPixel;j-=1)group="".concat(Math.floor(i/(rows||1)),"-").concat(i%(rows||1)),inputArray.push({deviceId,pixel:j,group});else for(let j=startPixel;j<=endPixel;j+=1)group="".concat(Math.floor(i/(rows||1)),"-").concat(i%(rows||1)),inputArray.push({deviceId,pixel:j,group})}if(rows){for(let i=0;i<inputArray.length;i+=rows)finalArray.push(inputArray.slice(i,i+rows));return finalArray}return[inputArray]}const LayoutTools=_ref=>{let{rowN,colN,virtual,m,setM,showPixelGraph,setPixelGroups,setShowPixelGraph}=_ref;const getVirtuals=(0,useStore.A)((state=>state.getVirtuals)),getDevices=(0,useStore.A)((state=>state.getDevices));return(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",width:400,justifyContent:"space-between",margin:"1rem 0",className:"step-2d-virtual-four",spacing:1,children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",justifyContent:"flex-start",spacing:.5,children:[(0,jsx_runtime.jsx)(Tooltip.A,{title:"Rotate 90°",children:(0,jsx_runtime.jsx)(Button.A,{onClick:()=>setM((0,helpers.mg)(m)),children:(0,jsx_runtime.jsx)(Rotate90DegreesCw.A,{})})}),(0,jsx_runtime.jsx)(Tooltip.A,{title:"Swap Vertically",children:(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{const toReverse=JSON.parse(JSON.stringify(m));setM(toReverse.reverse())},children:(0,jsx_runtime.jsx)(SwapVert.A,{})})}),(0,jsx_runtime.jsx)(Tooltip.A,{title:"Swap Horizontally",children:(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{const toReverse=JSON.parse(JSON.stringify(m));for(let index=0;index<toReverse.length;index+=1)toReverse[index]=toReverse[index].reverse();setM(toReverse)},children:(0,jsx_runtime.jsx)(SwapHoriz.A,{})})})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",justifyContent:"flex-start",spacing:.5,children:[(0,jsx_runtime.jsx)(Tooltip.A,{title:"".concat(showPixelGraph?"Hide":"Show"," Pixel Graph"),className:"step-2d-virtual-two",children:(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{setShowPixelGraph(!showPixelGraph)},children:showPixelGraph?(0,jsx_runtime.jsx)(Stop.A,{}):(0,jsx_runtime.jsx)(PlayArrow.A,{})})}),(0,jsx_runtime.jsx)(Tooltip.A,{title:"Reset",children:(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{setM(reverseProcessArray(virtual.segments,colN))},children:(0,jsx_runtime.jsx)(Loop.A,{})})}),(0,jsx_runtime.jsx)(Tooltip.A,{title:"Clear",children:(0,jsx_runtime.jsx)(Box.A,{children:(0,jsx_runtime.jsx)(Popover.A,{color:"inherit",variant:"outlined",onConfirm:()=>{setM(Array(rowN).fill(Array(colN).fill(MCell))),setPixelGroups(0)}})})}),(0,jsx_runtime.jsx)(Tooltip.A,{title:"Save",children:(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{(0,ledfx.U)("/api/virtuals/".concat(virtual.id),"POST",{segments:processArray(m.flat(),virtual.id)}).then((()=>{getVirtuals(),getDevices()}))},onContextMenu:e=>{e.preventDefault(),(0,ledfx.U)("/api/virtuals/".concat(virtual.id),"POST",{segments:processArray(m.flat(),virtual.id),matrix:m})},children:(0,jsx_runtime.jsx)(Save.A,{})})})]})]})},MControls_LayoutTools=LayoutTools;LayoutTools.__docgenInfo={description:"",methods:[],displayName:"LayoutTools",props:{rowN:{required:!0,tsType:{name:"number"},description:""},colN:{required:!0,tsType:{name:"number"},description:""},virtual:{required:!0,tsType:{name:"any"},description:""},m:{required:!0,tsType:{name:"any"},description:""},setM:{required:!0,tsType:{name:"any"},description:""},showPixelGraph:{required:!1,tsType:{name:"boolean"},description:""},setPixelGroups:{required:!1,tsType:{name:"any"},description:""},setShowPixelGraph:{required:!0,tsType:{name:"signature",type:"function",raw:"(_show: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"_show"}],return:{name:"void"}}},description:""}}};const DimensionSliders=_ref=>{let{rowN,colN,setRowNumber,setColNumber,virtual,m}=_ref;const getVirtuals=(0,useStore.A)((state=>state.getVirtuals)),getDevices=(0,useStore.A)((state=>state.getDevices)),addVirtual=(0,useStore.A)((state=>state.addVirtual)),virtual2dLimit=(0,useStore.A)((state=>state.ui.virtual2dLimit));return(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",justifyContent:"flex-start",alignItems:"flex-start",className:"step-2d-virtual-three",children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",width:400,justifyContent:"space-between",children:[(0,jsx_runtime.jsx)(Typography.A,{width:100,variant:"body1",children:"Rows:"}),(0,jsx_runtime.jsx)(Box.A,{width:250,children:(0,jsx_runtime.jsx)(Slider.Ay,{min:1,max:virtual2dLimit,value:rowN,onChange:(e,newRowNumber)=>"number"==typeof newRowNumber&&setRowNumber(newRowNumber),onChangeCommitted:(e,newRowNumber)=>{"number"==typeof newRowNumber&&addVirtual({id:virtual.id,config:{rows:newRowNumber}}).then((()=>{getVirtuals(),getDevices()})).then((()=>{(0,ledfx.U)("/api/virtuals/".concat(virtual.id),"POST",{segments:processArray(m.flat(),virtual.id)}).then((()=>{getVirtuals(),getDevices()}))}))}})}),rowN]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",width:400,justifyContent:"space-between",children:[(0,jsx_runtime.jsx)(Typography.A,{width:100,variant:"body1",children:"Columns:"}),(0,jsx_runtime.jsx)(Box.A,{width:250,children:(0,jsx_runtime.jsx)(Slider.Ay,{min:1,max:virtual2dLimit,value:colN,onChange:(e,newColNumber)=>"number"==typeof newColNumber&&setColNumber(newColNumber),onChangeCommitted:()=>{(0,ledfx.U)("/api/virtuals/".concat(virtual.id),"POST",{segments:processArray(m.flat(),virtual.id)}).then((()=>{getVirtuals(),getDevices()}))}})}),colN]})]})},MControls_DimensionSliders=DimensionSliders;DimensionSliders.__docgenInfo={description:"",methods:[],displayName:"DimensionSliders",props:{rowN:{required:!0,tsType:{name:"number"},description:""},colN:{required:!0,tsType:{name:"number"},description:""},setRowNumber:{required:!0,tsType:{name:"any"},description:""},setColNumber:{required:!0,tsType:{name:"any"},description:""},virtual:{required:!0,tsType:{name:"any"},description:""},m:{required:!0,tsType:{name:"any"},description:""}}};var PanTool=__webpack_require__("./node_modules/@mui/icons-material/esm/PanTool.js"),ControlCamera=__webpack_require__("./node_modules/@mui/icons-material/esm/ControlCamera.js"),Alert=__webpack_require__("./node_modules/@mui/material/esm/Alert/Alert.js"),Tab=__webpack_require__("./node_modules/@mui/material/esm/Tab/Tab.js"),TabContext=__webpack_require__("./node_modules/@mui/lab/esm/TabContext/TabContext.js"),TabList=__webpack_require__("./node_modules/@mui/lab/esm/TabList/TabList.js"),TabPanel=__webpack_require__("./node_modules/@mui/lab/esm/TabPanel/TabPanel.js"),BladeIcon=__webpack_require__("./src/components/Icons/BladeIcon/BladeIcon.tsx");const DnDModeTabs=_ref=>{let{m,move,dnd,setMove,setDnd,selectedGroup,setSelectedGroup}=_ref;const[tab,setTab]=(0,react.useState)("1"),infoAlerts=(0,useStore.A)((state=>state.uiPersist.infoAlerts)),setInfoAlerts=(0,useStore.A)((state=>state.setInfoAlerts)),uniqueGroups=(0,react.useMemo)((()=>{const groups=new Set;return m.flat().forEach((cell=>{cell.group&&"string"==typeof cell.group&&"0-0"!==cell.group&&groups.add(cell.group)})),Array.from(groups)}),[m]);return(0,react.useEffect)((()=>{dnd&&"2"!==tab&&setTab("2"),dnd||"1"===tab||setTab("1")}),[dnd]),(0,react.useEffect)((()=>{selectedGroup&&!uniqueGroups.includes(selectedGroup)&&setSelectedGroup(""),uniqueGroups&&0!==uniqueGroups.length||(setDnd(!1),setTab("1"))}),[selectedGroup,uniqueGroups,setSelectedGroup,setDnd]),(0,jsx_runtime.jsxs)(TabContext.Ay,{value:tab,children:[(0,jsx_runtime.jsx)(Box.A,{sx:{borderBottom:1,borderColor:"divider",marginTop:"0 !important"},className:"step-2d-virtual-six",children:(0,jsx_runtime.jsxs)(TabList.A,{onChange:(event,newValue)=>{"1"===newValue&&setDnd(!1),"2"===newValue&&setDnd(!0),setTab(newValue)},"aria-label":"DND Mode Tabs",children:[(0,jsx_runtime.jsx)(Tab.A,{sx:{flexBasis:"50%",minHeight:0,height:40},icon:(0,jsx_runtime.jsx)(PanTool.A,{}),iconPosition:"start",label:"DND-Canvas",value:"1"}),(0,jsx_runtime.jsx)(Tab.A,{disabled:!uniqueGroups||0===uniqueGroups.length,sx:{flexBasis:"50%",minHeight:0,height:40},icon:(0,jsx_runtime.jsx)(ControlCamera.A,{}),iconPosition:"start",label:"DND-Pixels",value:"2"})]})}),(0,jsx_runtime.jsx)(TabPanel.A,{value:"1",sx:{padding:0,pt:2},children:(0,jsx_runtime.jsx)(Collapse.A,{in:infoAlerts.camera,children:(0,jsx_runtime.jsxs)(Alert.A,{severity:"info",sx:{width:"100%"},onClose:()=>{setInfoAlerts("camera",!1)},children:[(0,jsx_runtime.jsx)("strong",{children:"DND-Canvas Mode"}),(0,jsx_runtime.jsxs)("ul",{style:{padding:"0 1rem"},children:[(0,jsx_runtime.jsx)("li",{children:"Use Mousewheel to Zoom"}),(0,jsx_runtime.jsx)("li",{children:"Use left-click with drag&drop to move around"}),(0,jsx_runtime.jsx)("li",{children:"Use right-click to:"}),(0,jsx_runtime.jsxs)("ul",{children:[(0,jsx_runtime.jsx)("li",{children:"assign pixel or pixel-group"}),(0,jsx_runtime.jsx)("li",{children:"edit a pixel"}),(0,jsx_runtime.jsx)("li",{children:"clear a pixel"}),(0,jsx_runtime.jsx)("li",{children:"move a pixel-group"})]}),(0,jsx_runtime.jsx)("li",{children:"Enter DND-Pixels mode to move pixels individually"})]})]})})}),uniqueGroups.length>0&&(0,jsx_runtime.jsxs)(TabPanel.A,{value:"2",sx:{padding:0,pt:2},children:[(0,jsx_runtime.jsx)(Collapse.A,{in:infoAlerts.pixelMode,children:(0,jsx_runtime.jsxs)(Alert.A,{severity:"info",sx:{width:"100%"},onClose:()=>setInfoAlerts("pixelMode",!1),children:[(0,jsx_runtime.jsxs)("strong",{children:["DND-",move?"Group":"Pixel"," Mode"]}),(0,jsx_runtime.jsx)("ul",{style:{padding:"0 1rem"},children:(0,jsx_runtime.jsxs)("li",{children:["move ",move?"groups":"pixels individually"," with your mouse"]})})]})}),(0,jsx_runtime.jsxs)(ToggleButtonGroup.A,{sx:{width:"100%"},color:"primary",value:move?"group":"pixel",exclusive:!0,onChange:()=>setMove(!move),"aria-label":"Move Mode",children:[(0,jsx_runtime.jsxs)(ToggleButton.A,{value:"pixel",sx:{flex:1},children:[(0,jsx_runtime.jsx)(BladeIcon.A,{name:"mdi:led-outline",sx:{mr:1}}),"Pixel"]}),(0,jsx_runtime.jsxs)(ToggleButton.A,{value:"group",sx:{flex:1},children:[(0,jsx_runtime.jsx)(BladeIcon.A,{name:"mdi:led-strip-variant",sx:{mr:1}}),"Group"]})]})]})]})},MControls_DnDModeTabs=DnDModeTabs;DnDModeTabs.__docgenInfo={description:"",methods:[],displayName:"DnDModeTabs",props:{m:{required:!0,tsType:{name:"any"},description:""},setM:{required:!0,tsType:{name:"any"},description:""},move:{required:!0,tsType:{name:"boolean"},description:""},dnd:{required:!0,tsType:{name:"boolean"},description:""},setMove:{required:!0,tsType:{name:"any"},description:""},setDnd:{required:!0,tsType:{name:"any"},description:""},selectedGroup:{required:!0,tsType:{name:"string"},description:""},setSelectedGroup:{required:!0,tsType:{name:"any"},description:""}}};const MControls=_ref=>{let{rowN,colN,setRowNumber,setColNumber,virtual,m,setM,move,dnd,setMove,setDnd,selectedGroup,setError,showPixelGraph,setPixelGroups,setSelectedGroup,setShowPixelGraph}=_ref;const[camMapper,setCamMapper]=(0,react.useState)(!1),getDevices=(0,useStore.A)((state=>state.getDevices)),setPixelGraphs=(0,useStore.A)((state=>state.setPixelGraphs)),graphs=(0,useStore.A)((state=>state.graphs)),graphsMulti=(0,useStore.A)((state=>state.graphsMulti)),virtuals=(0,useStore.A)((state=>state.virtuals)),showComplex=(0,useStore.A)((state=>state.showComplex)),showGaps=(0,useStore.A)((state=>state.showGaps)),features=(0,useStore.A)((state=>state.features)),uniqueGroups=(0,react.useMemo)((()=>{const groups=new Set;return m.flat().forEach((cell=>{cell.group&&"string"==typeof cell.group&&"0-0"!==cell.group&&groups.add(cell.group)})),Array.from(groups)}),[m]);return(0,react.useEffect)((()=>(virtual.id&&showPixelGraph?setPixelGraphs([virtual.id]):setPixelGraphs([]),()=>{graphs&&graphsMulti&&setPixelGraphs(Object.keys(virtuals).filter((v=>showComplex?v:!(v.endsWith("-mask")||v.endsWith("-foreground")||v.endsWith("-background")))).filter((v=>showGaps?v:!v.startsWith("gap-"))))})),[virtual.id,showPixelGraph,setPixelGraphs,graphs,graphsMulti,virtuals,showComplex,showGaps]),(0,jsx_runtime.jsxs)(Stack.A,{minWidth:400,direction:"column",spacing:2,style:{marginBottom:"1rem"},p:2,children:[(0,jsx_runtime.jsxs)(Collapse.A,{in:!camMapper,children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",justifyContent:"flex-start",alignItems:"flex-start",sx:{"& .MuiButton-root":{minWidth:0}},children:[(0,jsx_runtime.jsx)(MControls_DimensionSliders,{rowN,colN,setRowNumber,setColNumber,virtual,m}),(0,jsx_runtime.jsx)(MControls_LayoutTools,{rowN,colN,m,setM,virtual,setPixelGroups,showPixelGraph,setShowPixelGraph})]}),(0,jsx_runtime.jsx)(MControls_DnDModeTabs,{m,setM,move,setMove,dnd,setDnd,selectedGroup,setSelectedGroup}),uniqueGroups.length>0&&(0,jsx_runtime.jsx)(MControls_GroupControls,{m,rowN,colN,selectedGroup,setSelectedGroup,setM,setError})]}),features.matrix_cam&&(0,jsx_runtime.jsxs)(Button.A,{sx:{alignItems:"center",textTransform:"none"},className:"step-2d-virtual-cam-toggle",onClick:()=>{getDevices(),setCamMapper(!camMapper)},children:[(0,jsx_runtime.jsx)(EmergencyRecording.A,{sx:{marginRight:1}}),camMapper?"Exit CameraMapper":"Map Pixels via Camera"]}),(0,jsx_runtime.jsx)(Collapse.A,{in:camMapper,children:camMapper&&(0,jsx_runtime.jsx)(Webcam_Webcam,{rowN,colN})})]})},MControls_MControls=MControls;function Droppable(_ref){let{id,children,cell,bg,opacity=1,onContextMenu,onClick}=_ref;const{isOver,setNodeRef}=(0,core_esm.zM)({id}),style={opacity,background:isOver?""===(null==cell?void 0:cell.deviceId)?"rgba(0, 255, 0, 0.1)":"rgba(255, 0, 0, 0.1)":bg},classes=M_styles();return(0,jsx_runtime.jsx)("div",{ref:setNodeRef,style,className:classes.gridCell,onContextMenu,onClick,children})}MControls.__docgenInfo={description:"",methods:[],displayName:"MControls",props:{rowN:{required:!0,tsType:{name:"number"},description:""},colN:{required:!0,tsType:{name:"number"},description:""},setRowNumber:{required:!0,tsType:{name:"any"},description:""},setColNumber:{required:!0,tsType:{name:"any"},description:""},virtual:{required:!0,tsType:{name:"any"},description:""},m:{required:!0,tsType:{name:"any"},description:""},setM:{required:!0,tsType:{name:"any"},description:""},move:{required:!0,tsType:{name:"boolean"},description:""},dnd:{required:!0,tsType:{name:"boolean"},description:""},setMove:{required:!0,tsType:{name:"any"},description:""},setDnd:{required:!0,tsType:{name:"any"},description:""},selectedGroup:{required:!0,tsType:{name:"string"},description:""},setError:{required:!0,tsType:{name:"any"},description:""},showPixelGraph:{required:!1,tsType:{name:"boolean"},description:""},pixelGroups:{required:!1,tsType:{name:"any"},description:""},setPixelGroups:{required:!1,tsType:{name:"any"},description:""},setShowPixelGraph:{required:!0,tsType:{name:"signature",type:"function",raw:"(_show: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"_show"}],return:{name:"void"}}},description:""},setSelectedGroup:{required:!0,tsType:{name:"any"},description:""}}};const EditMatrix_Droppable=Droppable;Droppable.__docgenInfo={description:"",methods:[],displayName:"Droppable",props:{id:{required:!0,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},cell:{required:!1,tsType:{name:"signature",type:"object",raw:"{\n  deviceId: string\n  pixel: number\n  group?: string\n}",signature:{properties:[{key:"deviceId",value:{name:"string",required:!0}},{key:"pixel",value:{name:"number",required:!0}},{key:"group",value:{name:"string",required:!1}}]}},description:""},bg:{required:!1,tsType:{name:"string"},description:""},opacity:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"1",computed:!1}},onContextMenu:{required:!1,tsType:{name:"union",raw:"React.MouseEventHandler<HTMLDivElement> | undefined",elements:[{name:"ReactMouseEventHandler",raw:"React.MouseEventHandler<HTMLDivElement>",elements:[{name:"HTMLDivElement"}]},{name:"undefined"}]},description:""},onClick:{required:!1,tsType:{name:"union",raw:"React.MouseEventHandler<HTMLDivElement> | undefined",elements:[{name:"ReactMouseEventHandler",raw:"React.MouseEventHandler<HTMLDivElement>",elements:[{name:"HTMLDivElement"}]},{name:"undefined"}]},description:""}}};const Draggable_excluded=["children","id"];function Draggable(_ref){let{children,id}=_ref,props=(0,objectWithoutProperties.A)(_ref,Draggable_excluded);const{attributes,listeners,setNodeRef,transform}=(0,core_esm.PM)({id}),style=transform?{width:"100px",transform:"translate3d(".concat(transform.x,"px, ").concat(transform.y,"px, 0)")}:void 0;return(0,jsx_runtime.jsx)("div",(0,objectSpread2.A)((0,objectSpread2.A)((0,objectSpread2.A)((0,objectSpread2.A)({type:"button",ref:setNodeRef,style},props),listeners),attributes),{},{children}))}const EditMatrix_Draggable=Draggable;Draggable.__docgenInfo={description:"",methods:[],displayName:"Draggable"};const Pixel=_ref=>{let{m,currentColIndex,classes,currentRowIndex,yzcolumn,selectedGroup,error,setCurrentCell,setCurrentDevice,setSelectedPixel,openContextMenu,isDragging,move,bgColor="transparent"}=_ref;const theme=(0,useTheme.A)(),devices=(0,useStore.A)((state=>state.devices));error.length>0&&console.log(isDragging,error);const isSelected=yzcolumn.group&&yzcolumn.group===selectedGroup,isGroupActive=move&&isSelected;return(0,jsx_runtime.jsx)(Box.A,{sx:[{transition:"all 0.2s ease-in-out",backgroundColor:bgColor},(()=>{const styles={transition:"all 0.2s ease-in-out",opacity:1};return isDragging?styles.opacity=isSelected?1:.2:selectedGroup&&(styles.opacity=isSelected?1:.4),styles})()],onContextMenu:e=>{var _m$currentRowIndex$cu;e.preventDefault(),setCurrentCell([currentColIndex,currentRowIndex]),setCurrentDevice(""!==yzcolumn.deviceId?yzcolumn.deviceId:""),setSelectedPixel(yzcolumn.pixel||0),currentRowIndex>-1&&currentColIndex>-1&&""!==(null===(_m$currentRowIndex$cu=m[currentRowIndex][currentColIndex])||void 0===_m$currentRowIndex$cu?void 0:_m$currentRowIndex$cu.deviceId)&&openContextMenu(e)},children:""!==yzcolumn.deviceId&&(0,jsx_runtime.jsxs)(Box.A,{className:classes.pixel,sx:(()=>{const styles=(0,objectSpread2.A)((0,objectSpread2.A)({},classes.pixel),{},{transition:"all 0.2s ease-in-out"});return isGroupActive?(styles.borderColor=theme.palette.primary.light,styles.boxShadow="inset 0 0 8px 2px ".concat(theme.palette.primary.main)):isSelected&&(styles.borderColor=theme.palette.primary.main,styles.boxShadow="inset 0 0 8px 2px ".concat(theme.palette.primary.main)),isDragging||isSelected?styles.opacity=isSelected?1:.2:selectedGroup&&(styles.opacity=isSelected?1:.4),styles})(),children:[(0,jsx_runtime.jsx)(Typography.A,{variant:"caption",children:devices[yzcolumn.deviceId].config.name}),(0,jsx_runtime.jsx)(Typography.A,{variant:"caption",children:yzcolumn.pixel})]})},"col-".concat(currentColIndex))},EditMatrix_Pixel=Pixel;Pixel.__docgenInfo={description:"",methods:[],displayName:"Pixel",props:{m:{required:!0,tsType:{name:"Array",elements:[{name:"Array",elements:[{name:"signature",type:"object",raw:"{\n  deviceId: string\n  pixel: number\n  group?: string\n}",signature:{properties:[{key:"deviceId",value:{name:"string",required:!0}},{key:"pixel",value:{name:"number",required:!0}},{key:"group",value:{name:"string",required:!1}}]}}],raw:"IMCell[]"}],raw:"IMCell[][]"},description:""},currentColIndex:{required:!0,tsType:{name:"number"},description:""},classes:{required:!0,tsType:{name:"any"},description:""},currentRowIndex:{required:!0,tsType:{name:"number"},description:""},move:{required:!0,tsType:{name:"boolean"},description:""},yzcolumn:{required:!0,tsType:{name:"signature",type:"object",raw:"{\n  deviceId: string\n  pixel: number\n  group?: string\n}",signature:{properties:[{key:"deviceId",value:{name:"string",required:!0}},{key:"pixel",value:{name:"number",required:!0}},{key:"group",value:{name:"string",required:!1}}]}},description:""},selectedGroup:{required:!0,tsType:{name:"string"},description:""},error:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\n  row: number\n  col: number\n}",signature:{properties:[{key:"row",value:{name:"number",required:!0}},{key:"col",value:{name:"number",required:!0}}]}}],raw:"{\n  row: number\n  col: number\n}[]"},description:""},setCurrentCell:{required:!0,tsType:{name:"any"},description:""},setCurrentDevice:{required:!0,tsType:{name:"any"},description:""},setSelectedPixel:{required:!0,tsType:{name:"any"},description:""},openContextMenu:{required:!0,tsType:{name:"any"},description:""},isDragging:{required:!0,tsType:{name:"boolean"},description:""},bgColor:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'transparent'",computed:!1}}}};var Menu=__webpack_require__("./node_modules/@mui/material/esm/Menu/Menu.js");const MContextMenu=_ref=>{let{anchorEl,closeContextMenu,setOpen,setSelectedGroup,setMove,currentCell,m,setDnd,clearPixel,clearPixelGroup,pixelGroups,setPixelGroups}=_ref;const contextMenuOpen=Boolean(anchorEl);return(0,jsx_runtime.jsxs)(Menu.A,{id:"basic-menu",anchorEl,open:contextMenuOpen,onClose:closeContextMenu,onContextMenu:e=>{e.preventDefault(),closeContextMenu()},slotProps:{list:{"aria-labelledby":"basic-button"}},children:[(0,jsx_runtime.jsx)(MenuItem.A,{onClick:()=>{setOpen(!0)},children:"Edit"}),(0,jsx_runtime.jsx)(MenuItem.A,{onClick:()=>{setSelectedGroup(m[currentCell[1]][currentCell[0]].group||"0-0"),setDnd(!0),closeContextMenu()},children:"Move Pixel in DND"}),(0,jsx_runtime.jsx)(MenuItem.A,{onClick:()=>{setSelectedGroup(m[currentCell[1]][currentCell[0]].group||"0-0"),setMove(!0),closeContextMenu()},children:"Move Group"}),(0,jsx_runtime.jsx)(MenuItem.A,{onClick:e=>{clearPixel(),closeContextMenu(e)},children:"Clear Pixel"}),(0,jsx_runtime.jsx)(MenuItem.A,{onClick:e=>{clearPixelGroup(m[currentCell[1]][currentCell[0]].group||"0-0"),setPixelGroups(pixelGroups-1),closeContextMenu(e)},children:"Clear Group"})]})},EditMatrix_MContextMenu=MContextMenu;MContextMenu.__docgenInfo={description:"",methods:[],displayName:"MContextMenu",props:{anchorEl:{required:!0,tsType:{name:"any"},description:""},closeContextMenu:{required:!0,tsType:{name:"any"},description:""},setOpen:{required:!0,tsType:{name:"any"},description:""},setSelectedGroup:{required:!0,tsType:{name:"any"},description:""},setMove:{required:!0,tsType:{name:"any"},description:""},currentCell:{required:!0,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:""},m:{required:!0,tsType:{name:"any"},description:""},setDnd:{required:!0,tsType:{name:"any"},description:""},clearPixel:{required:!0,tsType:{name:"any"},description:""},clearPixelGroup:{required:!0,tsType:{name:"any"},description:""},pixelGroups:{required:!0,tsType:{name:"any"},description:""},setPixelGroups:{required:!0,tsType:{name:"any"},description:""}}};const MDialogTitle=_ref=>{var _m$currentCell$1$curr;let{currentCell,m}=_ref;const classes=M_styles();return(0,jsx_runtime.jsx)(DialogTitle.A,{children:(0,jsx_runtime.jsxs)("div",{className:classes.centered,children:[currentCell[1]>=0&&currentCell[0]>=0&&""!==(null===(_m$currentCell$1$curr=m[currentCell[1]][currentCell[0]])||void 0===_m$currentCell$1$curr?void 0:_m$currentCell$1$curr.deviceId)?"Edit":"Assign"," ","Pixel",(0,jsx_runtime.jsxs)(Typography.A,{variant:"caption",align:"right",children:["Row: ",currentCell[1]+1,(0,jsx_runtime.jsx)("br",{}),"Column: ",currentCell[0]+1]})]})})},EditMatrix_MDialogTitle=MDialogTitle;MDialogTitle.__docgenInfo={description:"",methods:[],displayName:"MDialogTitle",props:{currentCell:{required:!0,tsType:{name:"Array",elements:[{name:"number"}],raw:"number[]"},description:""},m:{required:!0,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:""}}};var Switch=__webpack_require__("./node_modules/@mui/material/esm/Switch/Switch.js");const MSwitch=_ref=>{let{group,setGroup}=_ref;return(0,jsx_runtime.jsxs)(BladeFrame.A,{title:"Group",style:{justifyContent:"space-between",paddingRight:2,marginBottom:"1rem"},children:[(0,jsx_runtime.jsx)(Typography.A,{children:"Assign multiple"}),(0,jsx_runtime.jsx)(Switch.A,{checked:group,onClick:()=>setGroup(!group)})]})},EditMatrix_MSwitch=MSwitch;MSwitch.__docgenInfo={description:"",methods:[],displayName:"MSwitch"};var Chip=__webpack_require__("./node_modules/@mui/material/esm/Chip/Chip.js"),Divider=__webpack_require__("./node_modules/@mui/material/esm/Divider/Divider.js");const right=__webpack_require__.p+"static/media/right.4437fb1e43fe564bd36af3f80b309a8c.svg";const right_snake=__webpack_require__.p+"static/media/right-snake.48646339a693661b2cbfb01036d4347d.svg";const right_flip=__webpack_require__.p+"static/media/right-flip.333ebf75f0fd0acb954b88d922e3ac19.svg";const right_snake_flip=__webpack_require__.p+"static/media/right-snake-flip.b3333c6771d73adb6415dfe752af3c80.svg";const bottom=__webpack_require__.p+"static/media/bottom.79f0473144db3f40a3b90b0889337363.svg";const bottom_flip=__webpack_require__.p+"static/media/bottom-flip.ca351932435166e77b4f79d8f60bc19e.svg";const bottom_snake=__webpack_require__.p+"static/media/bottom-snake.9b9a83d44ad5de6f52df46864a7815b8.svg";const bottom_snake_flip=__webpack_require__.p+"static/media/bottom-snake-flip.31c9ebc7594a96a686cf410bc65371dd.svg";const left=__webpack_require__.p+"static/media/left.6fc7083f4cd641bf654b08a26f944457.svg";const left_snake=__webpack_require__.p+"static/media/left-snake.77e313afd0b58fc57bc1b98df60eacfd.svg";const left_flip=__webpack_require__.p+"static/media/left-flip.e480ec339cb34df32d7412153a07216e.svg";const left_snake_flip=__webpack_require__.p+"static/media/left-snake-flip.866a1a9f220801e888735cdfa6f22698.svg";const assets_top=__webpack_require__.p+"static/media/top.6afc5413907a8835fb28c65c2927530e.svg";const top_right=__webpack_require__.p+"static/media/top-right.743c4f79f4eccef25cf772c7665c2cf7.svg";const bottom_right=__webpack_require__.p+"static/media/bottom-right.4dce284267cee3a5fd26be79e2f0150f.svg";const bottom_left=__webpack_require__.p+"static/media/bottom-left.c848fedc2cf975a03639f873c701251d.svg";const top_left=__webpack_require__.p+"static/media/top-left.aa14327ce1c00dde7d5e0e2556542ebf.svg";const top_snake=__webpack_require__.p+"static/media/top-snake.855c837598a62a68d139910f0e0b9ba4.svg";const top_flip=__webpack_require__.p+"static/media/top-flip.16c423f83594173bc5d78a0345983929.svg";const top_snake_flip=__webpack_require__.p+"static/media/top-snake-flip.4ac4f4730616467aeaf4461771bfa2cc.svg",MFillSelector=_ref=>{let{direction,onChange}=_ref;return(0,jsx_runtime.jsx)(BladeFrame.A,{title:"Fill Direction",full:!1,style:{marginBottom:"1rem"},children:(0,jsx_runtime.jsxs)(Select.A,{value:direction,variant:"standard",fullWidth:!0,MenuProps:{PaperProps:{style:{maxHeight:300}}},onChange:e=>onChange(e.target.value),children:[(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"right",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:right,alt:"rightSnake"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"right-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:right_flip,alt:"rightFlip"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"right-snake",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:right_snake,alt:"rightSnake"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"right-snake-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:right_snake_flip,alt:"rightSnakeFlip"})]})}),(0,jsx_runtime.jsx)(Divider.A,{}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"bottom",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:bottom,alt:"bottomSnake"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"bottom-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:bottom_flip,alt:"bottomSnakeFlip"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"bottom-snake",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:bottom_snake,alt:"bottomSnake"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"bottom-snake-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:bottom_snake_flip,alt:"bottomSnakeFlip"})]})}),(0,jsx_runtime.jsx)(Divider.A,{}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"left-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:left_flip,alt:"leftFlip"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"left",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:left,alt:"left"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"left-snake",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:left_snake,alt:"leftSnake"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"left-snake-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:left_snake_flip,alt:"leftSnakeFlip"})]})}),(0,jsx_runtime.jsx)(Divider.A,{}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"top",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:assets_top,alt:"top"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"top-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:top_flip,alt:"topFlip"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"top-snake",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:top_snake,alt:"topSnake"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"top-snake-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:top_snake_flip,alt:"topSnakeFlip"})]})}),(0,jsx_runtime.jsx)(Divider.A,{}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"diagonal-top-right",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Diagonal",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:top_right,alt:"topRight"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"diagonal-bottom-right",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Diagonal",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:bottom_right,alt:"bottomRight"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"diagonal-bottom-left",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Diagonal",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:bottom_left,alt:"bottomLeft"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"diagonal-top-left",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Diagonal",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:top_left,alt:"topLeft"})]})})]})})},EditMatrix_MFillSelector=MFillSelector;MFillSelector.__docgenInfo={description:"",methods:[],displayName:"MFillSelector",props:{direction:{required:!0,tsType:{name:"union",raw:"| 'right'\n| 'right-snake'\n| 'right-flip'\n| 'right-snake-flip'\n| 'left'\n| 'left-snake'\n| 'left-flip'\n| 'left-snake-flip'\n| 'top'\n| 'top-snake'\n| 'top-flip'\n| 'top-snake-flip'\n| 'bottom'\n| 'bottom-snake'\n| 'bottom-flip'\n| 'bottom-snake-flip'",elements:[{name:"literal",value:"'right'"},{name:"literal",value:"'right-snake'"},{name:"literal",value:"'right-flip'"},{name:"literal",value:"'right-snake-flip'"},{name:"literal",value:"'left'"},{name:"literal",value:"'left-snake'"},{name:"literal",value:"'left-flip'"},{name:"literal",value:"'left-snake-flip'"},{name:"literal",value:"'top'"},{name:"literal",value:"'top-snake'"},{name:"literal",value:"'top-flip'"},{name:"literal",value:"'top-snake-flip'"},{name:"literal",value:"'bottom'"},{name:"literal",value:"'bottom-snake'"},{name:"literal",value:"'bottom-flip'"},{name:"literal",value:"'bottom-snake-flip'"}]},description:""},onChange:{required:!0,tsType:{name:"any"},description:""}}};const Number_Number=_ref=>{let{min,max,value,onChange,onBlur}=_ref;return(0,jsx_runtime.jsx)(TextField.A,{value,name:"quantity",type:"number",onChange,onInput:e=>{const numericValue=parseFloat(e.target.value);isNaN(numericValue)||(numericValue>max?e.target.value=max.toString():numericValue<min&&(e.target.value=min.toString()))},onBlur:e=>{const numericValue=parseFloat(e.target.value);(isNaN(numericValue)||""===e.target.value)&&(e.target.value=min.toString(),onChange(e)),onBlur&&onBlur(e)},slotProps:{htmlInput:{min,max}}})},components_Number=Number_Number;Number_Number.__docgenInfo={description:"",methods:[],displayName:"Number",props:{min:{required:!0,tsType:{name:"number"},description:""},max:{required:!0,tsType:{name:"number"},description:""},value:{required:!0,tsType:{name:"number"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(_event: React.ChangeEvent<HTMLInputElement>) => void",signature:{arguments:[{type:{name:"ReactChangeEvent",raw:"React.ChangeEvent<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},name:"_event"}],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"(_event: React.FocusEvent<HTMLInputElement>) => void",signature:{arguments:[{type:{name:"ReactFocusEvent",raw:"React.FocusEvent<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},name:"_event"}],return:{name:"void"}}},description:""}}};const MSlider=_ref=>{let{group,devices,currentDevice,selectedPixel,handleSliderChange}=_ref;return(0,jsx_runtime.jsx)(BladeFrame.A,{title:"Pixel".concat(group?"s":""),full:!1,style:{marginBottom:"1rem"},children:(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",spacing:2,flex:1,minHeight:120,justifyContent:"space-between",children:[(0,jsx_runtime.jsx)(Slider.Ay,{marks:[{value:0,label:"0"},{value:devices[currentDevice].config.pixel_count-1,label:devices[currentDevice].config.pixel_count-1}],valueLabelDisplay:"auto",min:0,max:devices[currentDevice].config.pixel_count-1,value:selectedPixel,onChange:handleSliderChange}),"number"==typeof selectedPixel?(0,jsx_runtime.jsx)(components_Number,{min:0,max:devices[currentDevice].config.pixel_count-1,value:selectedPixel,onChange:e=>handleSliderChange(e,parseInt(e.target.value))}):(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(components_Number,{min:0,max:devices[currentDevice].config.pixel_count-1,value:selectedPixel[0],onChange:e=>handleSliderChange(e,[parseInt(e.target.value),selectedPixel[1]],0)}),(0,jsx_runtime.jsx)(components_Number,{min:0,max:devices[currentDevice].config.pixel_count-1,value:selectedPixel[1],onChange:e=>handleSliderChange(e,[selectedPixel[0],parseInt(e.target.value)],1)})]})]})})},EditMatrix_MSlider=MSlider;MSlider.__docgenInfo={description:"",methods:[],displayName:"MSlider",props:{group:{required:!0,tsType:{name:"boolean"},description:""},devices:{required:!0,tsType:{name:"any"},description:""},selectedPixel:{required:!0,tsType:{name:"union",raw:"number | number[]",elements:[{name:"number"},{name:"Array",elements:[{name:"number"}],raw:"number[]"}]},description:""},currentDevice:{required:!0,tsType:{name:"any"},description:""},handleSliderChange:{required:!0,tsType:{name:"any"},description:""}}};const Actions_assignPixels=_ref=>{let{m,rowN,colN,currentCell,currentDevice,selectedPixel,direction,setM,closeClear,pixelGroups,setPixelGroups,newGroupId}=_ref,updatedM=clone(m);const[col,row]=currentCell;if("number"==typeof selectedPixel)updatedM[row][col]={deviceId:currentDevice,pixel:selectedPixel,group:newGroupId};else for(let index=0;index<=Math.abs(selectedPixel[1]-selectedPixel[0]);index+=1){const newM={deviceId:currentDevice,pixel:Math.min(selectedPixel[0],selectedPixel[1])+index,group:newGroupId};if(direction.includes("diagonal-top-right"))for(let index=0;index<=Math.abs(selectedPixel[1]-selectedPixel[0])&&row-index>=0&&col+index<colN;index++){const newM={deviceId:currentDevice,pixel:Math.min(selectedPixel[0],selectedPixel[1])+index,group:newGroupId};updatedM[row-index][col+index]=newM}else if(direction.includes("diagonal-bottom-right"))for(let index=0;index<=Math.abs(selectedPixel[1]-selectedPixel[0])&&row+index<rowN&&col+index<colN;index++){const newM={deviceId:currentDevice,pixel:Math.min(selectedPixel[0],selectedPixel[1])+index,group:newGroupId};updatedM[row+index][col+index]=newM}else if(direction.includes("diagonal-bottom-left"))for(let index=0;index<=Math.abs(selectedPixel[1]-selectedPixel[0])&&row+index<rowN&&col-index>=0;index++){const newM={deviceId:currentDevice,pixel:Math.min(selectedPixel[0],selectedPixel[1])+index,group:newGroupId};updatedM[row+index][col-index]=newM}else if(direction.includes("diagonal-top-left"))for(let index=0;index<=Math.abs(selectedPixel[1]-selectedPixel[0])&&row-index>=0&&col-index>=0;index++){const newM={deviceId:currentDevice,pixel:Math.min(selectedPixel[0],selectedPixel[1])+index,group:newGroupId};updatedM[row-index][col-index]=newM}else direction.includes("right")?direction.includes("flip")?updatedM[row-Math.floor((index+col)/colN)][(index+col)%colN]=newM:updatedM[row+Math.floor((index+col)/colN)][(index+col)%colN]=newM:direction.includes("bottom")?direction.includes("flip")?updatedM[(index+row)%rowN][col-Math.floor((index+row)/rowN)]=newM:updatedM[(index+row)%rowN][col+Math.floor((index+row)/rowN)]=newM:direction.includes("left")?direction.includes("flip")?updatedM[row+Math.abs(Math.floor((col-index)/colN))][(colN+(col-index)%colN)%colN]=newM:updatedM[row-Math.abs(Math.floor((col-index)/colN))][(colN+(col-index)%colN)%colN]=newM:direction.includes("top")&&(direction.includes("flip")?updatedM[(rowN+(row-index)%rowN)%rowN][col+Math.abs(Math.floor((row-index)/rowN))]=newM:updatedM[(rowN+(row-index)%rowN)%rowN][col-Math.abs(Math.floor((row-index)/rowN))]=newM)}if(direction.includes("right-snake"))if(direction.includes("flip"))for(let i=row;i>=0;i-=1){const currentRow=[...updatedM[i]];(i+row)%2==1&&(updatedM[i]=currentRow.reverse())}else for(let i=row;i<rowN;i+=1){const currentRow=[...updatedM[i]];(i+row)%2==1&&(updatedM[i]=currentRow.reverse())}if(direction.includes("bottom-snake"))if(direction.includes("flip")){const mat=clone(updatedM),temp=(0,helpers.mg)(mat);for(let i=col;i>=0;i-=1){const currentCol=[...temp[i]];(i+col)%2==1&&(temp[i]=currentCol.reverse())}updatedM=(0,helpers.mg)(temp)}else{const mat=clone(updatedM),temp=(0,helpers.mg)(mat);for(let i=col;i<colN;i+=1){const currentCol=[...temp[i]];(i+col)%2==1&&(temp[i]=currentCol.reverse())}updatedM=(0,helpers.mg)(temp)}if(direction.includes("left-snake"))if(direction.includes("flip"))for(let i=row;i<rowN;i+=1){const currentRow=[...updatedM[i]];(i+row)%2==1&&(updatedM[i]=currentRow.reverse())}else for(let i=row;i>=0;i-=1){const currentRow=[...updatedM[i]];(i+row)%2==1&&(updatedM[i]=currentRow.reverse())}if(direction.includes("top-snake"))if(direction.includes("flip")){const mat=clone(updatedM),temp=(0,helpers.mg)(mat);for(let i=col;i<colN;i+=1){const currentCol=[...temp[i]];(i+col)%2==1&&(temp[i]=currentCol.reverse())}updatedM=(0,helpers.mg)(temp)}else{const mat=clone(updatedM),temp=(0,helpers.mg)(mat);for(let i=col;i>=0;i-=1){const currentCol=[...temp[i]];(i+col)%2==1&&(temp[i]=currentCol.reverse())}updatedM=(0,helpers.mg)(temp)}setPixelGroups(pixelGroups+1),setM(updatedM),closeClear()},AssignPixelDialog=_ref=>{let{open,closeClear,currentCell,m,currentDevice,setCurrentDevice,deviceRef,group,setGroup,direction,handleDirectionChange,selectedPixel,handleSliderChange,rowN,colN,setM,pixelGroups,setPixelGroups,clearPixel}=_ref;const devices=(0,useStore.A)((state=>state.devices)),showComplex=(0,useStore.A)((state=>state.showComplex)),showGaps=(0,useStore.A)((state=>state.showGaps));return(0,jsx_runtime.jsxs)(Dialog.A,{onClose:()=>closeClear(),open,PaperProps:{sx:{width:"100%",maxWidth:320}},children:[(0,jsx_runtime.jsx)(EditMatrix_MDialogTitle,{currentCell,m}),(0,jsx_runtime.jsxs)(DialogContent.A,{children:[(0,jsx_runtime.jsx)(BladeFrame.A,{title:"Device",style:{marginBottom:"1rem"},children:(0,jsx_runtime.jsx)(Select.A,{value:currentDevice,onChange:e=>setCurrentDevice(e.target.value||""),inputRef:deviceRef,variant:"standard",fullWidth:!0,children:devices&&Object.keys(devices).filter((v=>showComplex?v:!(v.endsWith("-mask")||v.endsWith("-foreground")||v.endsWith("-background")))).filter((v=>showGaps?v:!v.startsWith("gap-"))).map(((d,i)=>(0,jsx_runtime.jsx)(MenuItem.A,{value:devices[d].id,children:devices[d].config.name},i)))})}),currentDevice&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(EditMatrix_MSwitch,{group,setGroup}),group&&(0,jsx_runtime.jsx)(EditMatrix_MFillSelector,{direction,onChange:handleDirectionChange}),(0,jsx_runtime.jsx)(EditMatrix_MSlider,{group,devices,currentDevice,selectedPixel,handleSliderChange})]})]}),(0,jsx_runtime.jsxs)(DialogActions.A,{children:[(0,jsx_runtime.jsx)(Button.A,{onClick:()=>clearPixel(),children:"Clear"}),(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{const newGroupId="group-".concat(pixelGroups);Actions_assignPixels({m,rowN,colN,currentCell,currentDevice,selectedPixel,direction,setM,closeClear,pixelGroups,setPixelGroups,newGroupId})},children:"Save"})]})]})},EditMatrix_AssignPixelDialog=AssignPixelDialog;AssignPixelDialog.__docgenInfo={description:"",methods:[],displayName:"AssignPixelDialog",props:{open:{required:!0,tsType:{name:"boolean"},description:""},closeClear:{required:!0,tsType:{name:"any"},description:""},currentCell:{required:!0,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:""},m:{required:!0,tsType:{name:"any"},description:""},currentDevice:{required:!0,tsType:{name:"string"},description:""},setCurrentDevice:{required:!0,tsType:{name:"any"},description:""},deviceRef:{required:!0,tsType:{name:"any"},description:""},group:{required:!0,tsType:{name:"boolean"},description:""},setGroup:{required:!0,tsType:{name:"any"},description:""},direction:{required:!0,tsType:{name:"union",raw:"| 'right'\n| 'right-snake'\n| 'right-flip'\n| 'right-snake-flip'\n| 'left'\n| 'left-snake'\n| 'left-flip'\n| 'left-snake-flip'\n| 'top'\n| 'top-snake'\n| 'top-flip'\n| 'top-snake-flip'\n| 'bottom'\n| 'bottom-snake'\n| 'bottom-flip'\n| 'bottom-snake-flip'",elements:[{name:"literal",value:"'right'"},{name:"literal",value:"'right-snake'"},{name:"literal",value:"'right-flip'"},{name:"literal",value:"'right-snake-flip'"},{name:"literal",value:"'left'"},{name:"literal",value:"'left-snake'"},{name:"literal",value:"'left-flip'"},{name:"literal",value:"'left-snake-flip'"},{name:"literal",value:"'top'"},{name:"literal",value:"'top-snake'"},{name:"literal",value:"'top-flip'"},{name:"literal",value:"'top-snake-flip'"},{name:"literal",value:"'bottom'"},{name:"literal",value:"'bottom-snake'"},{name:"literal",value:"'bottom-flip'"},{name:"literal",value:"'bottom-snake-flip'"}]},description:""},handleDirectionChange:{required:!0,tsType:{name:"any"},description:""},selectedPixel:{required:!0,tsType:{name:"union",raw:"number | number[]",elements:[{name:"number"},{name:"Array",elements:[{name:"number"}],raw:"number[]"}]},description:""},handleSliderChange:{required:!0,tsType:{name:"any"},description:""},rowN:{required:!0,tsType:{name:"number"},description:""},colN:{required:!0,tsType:{name:"number"},description:""},setM:{required:!0,tsType:{name:"any"},description:""},pixelGroups:{required:!0,tsType:{name:"any"},description:""},setPixelGroups:{required:!0,tsType:{name:"any"},description:""},clearPixel:{required:!0,tsType:{name:"any"},description:""}}};var shallow=__webpack_require__("./node_modules/zustand/esm/react/shallow.mjs");const Actions_hexColor=function hexColor(encodedString,mode){if("uncompressed"===mode||!encodedString)return[];const decodedString=atob(encodedString),charCodes=Array.from(decodedString).map((char=>char.charCodeAt(0)));return Array.from({length:charCodes.length/3},((_,i)=>({r:charCodes[3*i],g:charCodes[3*i+1],b:charCodes[3*i+2]})))},PixelGraphBase=_ref=>{var _virtuals$virtId,_virtuals$virtId2,_devices$virtuals$vir,_devices$virtuals$vir2,_virtuals$virtId3,_virtuals$virtId4,_virtuals$virtId4$con,_virtuals$virtId5,_virtuals$virtId5$con,_pixels$,_virtuals$virtId6;let{virtId,dummy=!1,className="",active=!1,intGraphs=!1,showMatrix=!1,fullScreen=!1,db=!1,onDoubleClick}=_ref;const[pixels,setPixels]=(0,react.useState)([]),[shape,setShape]=(0,react.useState)([null,null]),showWarning=(0,useStore.A)((state=>state.uiPersist.warnings.lessPixels)),round=(0,useStore.A)((state=>{var _state$uiPersist$pixe;return null===(_state$uiPersist$pixe=state.uiPersist.pixelGraphSettings)||void 0===_state$uiPersist$pixe?void 0:_state$uiPersist$pixe.round})),space=(0,useStore.A)((state=>{var _state$uiPersist$pixe2;return null===(_state$uiPersist$pixe2=state.uiPersist.pixelGraphSettings)||void 0===_state$uiPersist$pixe2?void 0:_state$uiPersist$pixe2.space})),stretch=(0,useStore.A)((state=>{var _state$uiPersist$pixe3;return null===(_state$uiPersist$pixe3=state.uiPersist.pixelGraphSettings)||void 0===_state$uiPersist$pixe3?void 0:_state$uiPersist$pixe3.stretch})),{pixelGraphs,virtuals,devices,graphs,config}=(0,useStore.A)((0,shallow.k)((state=>({pixelGraphs:state.pixelGraphs,virtuals:state.virtuals,devices:state.devices,graphs:state.graphs,config:state.config})))),rows=null!==(_virtuals$virtId=virtuals[virtId])&&void 0!==_virtuals$virtId&&_virtuals$virtId.is_device?"string"==typeof(null===(_virtuals$virtId2=virtuals[virtId])||void 0===_virtuals$virtId2?void 0:_virtuals$virtId2.is_device)&&(null===(_devices$virtuals$vir=devices[null===(_virtuals$virtId3=virtuals[virtId])||void 0===_virtuals$virtId3?void 0:_virtuals$virtId3.is_device])||void 0===_devices$virtuals$vir||null===(_devices$virtuals$vir2=_devices$virtuals$vir.config)||void 0===_devices$virtuals$vir2?void 0:_devices$virtuals$vir2.rows)||(null===(_virtuals$virtId4=virtuals[virtId])||void 0===_virtuals$virtId4||null===(_virtuals$virtId4$con=_virtuals$virtId4.config)||void 0===_virtuals$virtId4$con?void 0:_virtuals$virtId4$con.rows)||1:(null===(_virtuals$virtId5=virtuals[virtId])||void 0===_virtuals$virtId5||null===(_virtuals$virtId5$con=_virtuals$virtId5.config)||void 0===_virtuals$virtId5$con?void 0:_virtuals$virtId5$con.rows)||1,decodedPixels="compressed"===config.transmission_mode?pixels&&pixels.length&&Actions_hexColor(pixels,config.transmission_mode):pixels;(0,react.useEffect)((()=>{const handleWebsockets=e=>{e.detail.id===virtId&&(setPixels(e.detail.pixels),e.detail.shape[0]!==shape[0]&&e.detail.shape[1]!==shape[1]&&setShape(e.detail.shape))};return document.addEventListener("visualisation_update",handleWebsockets),()=>{document.removeEventListener("visualisation_update",handleWebsockets)}}),[virtuals,pixelGraphs,virtId]);const tooLessPixels=(0,useStore.A)((state=>{var _state$dialogs$lessPi;return(null===(_state$dialogs$lessPi=state.dialogs.lessPixels)||void 0===_state$dialogs$lessPi?void 0:_state$dialogs$lessPi.open)||!1}));if(!graphs&&!intGraphs)return null;const totalPixels=decodedPixels.length>0?decodedPixels.length:null===(_pixels$=pixels[0])||void 0===_pixels$?void 0:_pixels$.length,realPixelCount=(null===(_virtuals$virtId6=virtuals[virtId])||void 0===_virtuals$virtId6?void 0:_virtuals$virtId6.pixel_count)||totalPixels,realCols=Math.ceil(realPixelCount/rows),aspectRatio=realCols/rows,displayRows=shape&&shape[0]||(realPixelCount>4096?Math.sqrt(4096/aspectRatio):rows),displayCols=shape&&shape[1]||(realPixelCount>4096?4096/displayRows:realCols);return dummy||tooLessPixels&&showWarning?(0,jsx_runtime.jsx)("div",{style:{maxWidth:fullScreen?"100vw":"520px",maxHeight:fullScreen?"calc(100vh - 200px)":"unset",display:"flex",width:"100%",borderRadius:round?"10px":0,overflow:"hidden",margin:"0.5rem 0 0 0"},className:"".concat(className," ").concat(active?"active":""),onDoubleClick,children:(0,jsx_runtime.jsx)("div",{style:{backgroundColor:"#0002",height:"20px",flex:1,borderRadius:"0"}},1)}):(pixels.length||decodedPixels.length)&&rows>1&&showMatrix?(0,jsx_runtime.jsx)("div",{onDoubleClick:()=>{onDoubleClick()},style:{maxWidth:fullScreen?"100vw":"520px",maxHeight:fullScreen?"100vh":"unset",display:"flex",flexDirection:"launchpad-x"===virtuals[virtId].id||"launchpad-x-matrix"===virtuals[virtId].id?"column-reverse":"column",width:"100%",borderRadius:round?"10px":0,overflow:"hidden",margin:db?0:"0.5rem 0 0 0",objectFit:stretch?"fill":"contain"},className:"".concat(className," ").concat(active?"active":""),children:Array.from(Array(displayRows).keys()).map((row=>{var _pixels$2;return(0,jsx_runtime.jsx)("div",{style:{maxWidth:fullScreen?"100vw":"520px",maxHeight:fullScreen?"calc(100vh - 200px)":"unset",display:"flex",width:"100%",borderRadius:"0",overflow:"hidden",margin:"0"},className:"".concat(className," ").concat(active?"active":""),children:("compressed"===config.transmission_mode&&decodedPixels.length>0?decodedPixels.slice(row*displayCols,(row+1)*displayCols):null===(_pixels$2=pixels[0])||void 0===_pixels$2?void 0:_pixels$2.slice(row*displayCols,(row+1)*displayCols)).map(((_p,i)=>(0,jsx_runtime.jsx)("div",{style:{flex:1,margin:space?"".concat(db||totalPixels>100&&displayRows>7?1:2,"px"):0,borderRadius:round?db||totalPixels>100&&displayRows>7?"50%":"5px":0,position:"relative",overflow:"hidden",maxWidth:db?3.6:"".concat(100/displayCols,"%"),maxHeight:db?3.6:"".concat(100/displayCols,"%")},children:(0,jsx_runtime.jsx)("div",{style:{width:"100%",paddingBottom:"100%",backgroundColor:active?"compressed"===config.transmission_mode&&decodedPixels.length>0&&decodedPixels[row*displayCols+i]?"rgb(".concat(Object.values(decodedPixels[row*displayCols+i]),")"):"rgb(".concat(pixels[0][row*displayCols+i],",").concat(pixels[1][row*displayCols+i],",").concat(pixels[2][row*displayCols+i],")"):"#0002"}})},i)))},"row-".concat(row))}))}):(pixels[0]||decodedPixels).length?(0,jsx_runtime.jsx)("div",{style:{maxWidth:fullScreen?"100vw":"520px",maxHeight:fullScreen?"calc(100vh - 200px)":"unset",display:"flex",width:"100%",borderRadius:round?"10px":0,overflow:"hidden",margin:"0.5rem 0 0 0"},className:"".concat(className," ").concat(active?"active":""),children:("compressed"===config.transmission_mode?decodedPixels:pixels[0]).map(((p,i)=>(0,jsx_runtime.jsx)("div",{style:{height:"20px",flex:1,borderRadius:"0",backgroundColor:active?"compressed"===config.transmission_mode?"rgb(".concat(Object.values(p),")"):"rgb(".concat(pixels[0][i],",").concat(pixels[1][i],",").concat(pixels[2][i],")"):"#0002"}},i)))}):(0,jsx_runtime.jsx)("div",{style:{maxWidth:fullScreen?"100vw":"520px",maxHeight:fullScreen?"calc(100vh - 200px)":"unset",display:"flex",width:"100%",borderRadius:round?"10px":0,overflow:"hidden",margin:"0.5rem 0 0 0"},className:"".concat(className," ").concat(active?"active":""),children:(0,jsx_runtime.jsx)("div",{style:{height:"20px",borderRadius:"0",flex:1,backgroundColor:"#0002"}},1)})},PixelGraph_PixelGraphBase=PixelGraphBase;PixelGraphBase.__docgenInfo={description:"",methods:[],displayName:"PixelGraphBase",props:{virtId:{required:!0,tsType:{name:"string"},description:""},dummy:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},className:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"''",computed:!1}},active:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},intGraphs:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},showMatrix:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},fullScreen:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},db:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onDoubleClick:{required:!1,tsType:{name:"any"},description:""}}};var sockette=__webpack_require__("./node_modules/sockette/dist/sockette.mjs"),is_electron=__webpack_require__("./node_modules/is-electron/index.js"),is_electron_default=__webpack_require__.n(is_electron);const initialSubscriptions=[{event_type:"devices_updated",id:9002},{event_type:"device_created",id:9001},{event_type:"scene_activated",id:9003},{event_type:"effect_set",id:9004},{event_type:"client_connected",id:9005},{event_type:"client_disconnected",id:9006},{event_type:"client_sync",id:9007}],handlerConfig={visualisation_update:data=>(0,objectSpread2.A)((0,objectSpread2.A)({id:data.vis_id,pixels:data.pixels,shape:data.shape},data.rid&&{rid:data.id}),data.timestamp&&{timestamp:data.timestamp}),devices_updated:"devices_updated",device_created:data=>({id:"device_created",device_name:data.device_name}),scene_activated:data=>({id:"scene_activated",scene_id:data.scene_id}),virtual_diag:data=>({data}),graph_update:!0,effect_set:!0},WebSocketContext=(0,react.createContext)({send:()=>console.error("WebSocketProvider not mounted"),subscribe:()=>()=>console.error("WebSocketProvider not mounted"),isConnected:!1,getSocket:()=>null,errorState:null}),useSubscription=(eventName,callback)=>{const{subscribe}=(0,react.useContext)(WebSocketContext),callbackRef=(0,react.useRef)(callback);(0,react.useEffect)((()=>{callbackRef.current=callback})),(0,react.useEffect)((()=>subscribe(eventName,(data=>callbackRef.current(data)))),[eventName,subscribe])};(_ref=>{let{children}=_ref;const ws=(0,react.useRef)(null),[isConnected,setIsConnected]=(0,react.useState)(!1),[errorState,setErrorState]=(0,react.useState)(null),subscribers=(0,react.useRef)(new Map),send=(0,react.useCallback)((data=>{var _ws$current;null===(_ws$current=ws.current)||void 0===_ws$current||_ws$current.send(JSON.stringify(data))}),[]),getSocket=(0,react.useCallback)((()=>ws.current),[]),subscribe=(0,react.useCallback)(((eventName,callback)=>{subscribers.current.has(eventName)||subscribers.current.set(eventName,new Set);const eventSubscribers=subscribers.current.get(eventName);return eventSubscribers.add(callback),()=>{eventSubscribers.delete(callback)}}),[]);(0,react.useEffect)((()=>{const wsUrl=(window.localStorage.getItem("ledfx-host")||(is_electron_default()()?"http://localhost:8888":window.location.href.split("/#")[0].replace(/\/+$/,""))).replace("https://","wss://").replace("http://","ws://")+"/api/websocket";"https:"===window.location.protocol&&wsUrl.startsWith("ws://")&&(console.error("Mixed Content Error Detected: Attempting to connect to ws:// from https://."),setErrorState("mixedContent"));return ws.current=new sockette.A(wsUrl,{timeout:5e3,maxAttempts:10,onopen:()=>{setIsConnected(!0),setErrorState(null),useStore.A.getState().setDisconnected(!1),initialSubscriptions.forEach((sub=>{send((0,objectSpread2.A)((0,objectSpread2.A)({},sub),{},{type:"subscribe_event"}))}))},onmessage:event=>{const data=JSON.parse(event.data),eventType=null==data?void 0:data.event_type;if(!eventType)return;const rule=handlerConfig[eventType];let payload=data;!0===rule?payload=data:"function"==typeof rule?payload=rule(data):void 0!==rule&&(payload=rule),((eventName,data)=>{var _subscribers$current$;subscribers.current.has(eventName)&&(null===(_subscribers$current$=subscribers.current.get(eventName))||void 0===_subscribers$current$||_subscribers$current$.forEach((cb=>cb(data))))})(eventType,payload)},onclose:()=>{setIsConnected(!1),useStore.A.getState().setDisconnected(!0),window.localStorage.removeItem("core-init")},onerror:e=>{console.error("WebSocket Error:",e),setErrorState("connectionError")}}),()=>{var _ws$current2;null===(_ws$current2=ws.current)||void 0===_ws$current2||_ws$current2.close()}}),[send]);const value={send,subscribe,isConnected,getSocket,errorState};return(0,jsx_runtime.jsx)(WebSocketContext.Provider,{value,children})}).__docgenInfo={description:"",methods:[],displayName:"WebSocketProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const PixelGraphCanvas=_ref=>{var _virtuals$virtId$effe,_virtuals$virtId3,_virtuals$virtId3$con;let{virtId,className="",active=!1,intGraphs=!1,showMatrix=!1,fullScreen=!1,db=!1,fill=!1,onDoubleClick}=_ref;const canvasRef=(0,react.useRef)(null),{virtuals,graphs}=(0,useStore.A)((0,shallow.k)((state=>({virtuals:state.virtuals,graphs:state.graphs})))),smoothing=(0,useStore.A)((state=>{var _state$uiPersist$pixe;return null===(_state$uiPersist$pixe=state.uiPersist.pixelGraphSettings)||void 0===_state$uiPersist$pixe?void 0:_state$uiPersist$pixe.smoothing})),stretch=(0,useStore.A)((state=>{var _state$uiPersist$pixe2;return null===(_state$uiPersist$pixe2=state.uiPersist.pixelGraphSettings)||void 0===_state$uiPersist$pixe2?void 0:_state$uiPersist$pixe2.stretch})),handleVisualisationUpdate=(0,react.useCallback)((eventData=>{var _virtuals$virtId,_virtuals$virtId$conf,_virtuals$virtId2;if(eventData.id!==virtId)return;const canvas=canvasRef.current,ctx=null==canvas?void 0:canvas.getContext("2d");if(!canvas||!ctx)return;const{virtuals,config}=useStore.A.getState();ctx.imageSmoothingEnabled=!1;const pixels="compressed"===config.transmission_mode?Actions_hexColor(eventData.pixels,config.transmission_mode):eventData.pixels,rows=showMatrix&&(null===(_virtuals$virtId=virtuals[virtId])||void 0===_virtuals$virtId||null===(_virtuals$virtId$conf=_virtuals$virtId.config)||void 0===_virtuals$virtId$conf?void 0:_virtuals$virtId$conf.rows)||1,shape=eventData.shape,totalPixels=pixels.length,realPixelCount=(null===(_virtuals$virtId2=virtuals[virtId])||void 0===_virtuals$virtId2?void 0:_virtuals$virtId2.pixel_count)||totalPixels,realCols=Math.ceil(realPixelCount/rows),aspectRatio=realCols/rows;let displayRows,displayCols;showMatrix?(displayRows=shape&&shape[0]||(realPixelCount>4096?Math.sqrt(4096/aspectRatio):rows),displayCols=shape&&shape[1]||(realPixelCount>4096?4096/displayRows:realCols)):(displayRows=1,displayCols=totalPixels),canvas.width=displayCols,canvas.height=displayRows;const imageData=ctx.createImageData(displayCols,displayRows);for(let i=0;i<pixels.length;i++){const x=i%displayCols,index=4*(Math.floor(i/displayCols)*displayCols+x),color=pixels[i];imageData.data[index]=color.r,imageData.data[index+1]=color.g,imageData.data[index+2]=color.b,imageData.data[index+3]=255}ctx.putImageData(imageData,0,0)}),[virtId,showMatrix]);useSubscription("visualisation_update",handleVisualisationUpdate);const render=virtuals[virtId].active&&(null===(_virtuals$virtId$effe=virtuals[virtId].effect)||void 0===_virtuals$virtId$effe?void 0:_virtuals$virtId$effe.name)||virtuals[virtId].streaming;return graphs||intGraphs?(0,jsx_runtime.jsx)("canvas",{ref:canvasRef,className:"".concat(className," ").concat(active?"active":""),style:{maxWidth:fill?"unset":fullScreen?"100vw":"520px",maxHeight:fill?"unset":fullScreen?"100vh":"520px",height:!render||((null===(_virtuals$virtId3=virtuals[virtId])||void 0===_virtuals$virtId3||null===(_virtuals$virtId3$con=_virtuals$virtId3.config)||void 0===_virtuals$virtId3$con?void 0:_virtuals$virtId3$con.rows)||1)<2||!showMatrix?"20px":"auto",width:"100%",borderRadius:"10px",overflow:"hidden",margin:db||fill?0:"0.5rem 0 0 0",imageRendering:smoothing?"unset":"pixelated",objectFit:stretch&&fullScreen?"contain":"fill"},onDoubleClick}):null},PixelGraph_PixelGraphCanvas=PixelGraphCanvas;PixelGraphCanvas.__docgenInfo={description:"",methods:[],displayName:"PixelGraphCanvas",props:{virtId:{required:!0,tsType:{name:"string"},description:""},dummy:{required:!1,tsType:{name:"boolean"},description:""},className:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"''",computed:!1}},active:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},intGraphs:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},showMatrix:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},fullScreen:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},db:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onDoubleClick:{required:!1,tsType:{name:"any"},description:""},fill:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}}};const PixelGraphCanvasOffscreen=_ref=>{var _virtuals$virtId$effe,_virtuals$virtId2,_virtuals$virtId2$con;let{virtId,className="",active=!1,intGraphs=!1,showMatrix=!1,fullScreen=!1,db=!1,onDoubleClick}=_ref;const canvasRef=(0,react.useRef)(null),workerRef=(0,react.useRef)(null),transferredRef=(0,react.useRef)(!1),{pixelGraphs,virtuals,devices,graphs,config}=(0,useStore.A)((0,shallow.k)((state=>({pixelGraphs:state.pixelGraphs,virtuals:state.virtuals,devices:state.devices,graphs:state.graphs,config:state.config})))),smoothing=(0,useStore.A)((state=>{var _state$uiPersist$pixe;return null===(_state$uiPersist$pixe=state.uiPersist.pixelGraphSettings)||void 0===_state$uiPersist$pixe?void 0:_state$uiPersist$pixe.smoothing})),stretch=(0,useStore.A)((state=>{var _state$uiPersist$pixe2;return null===(_state$uiPersist$pixe2=state.uiPersist.pixelGraphSettings)||void 0===_state$uiPersist$pixe2?void 0:_state$uiPersist$pixe2.stretch}));(0,react.useEffect)((()=>{setTimeout((()=>{const canvas=canvasRef.current;if(!canvas||transferredRef.current)return;const offscreen=canvas.transferControlToOffscreen(),worker=new Worker(new URL(__webpack_require__.p+__webpack_require__.u(1258),__webpack_require__.b));workerRef.current=worker,transferredRef.current=!0,worker.postMessage({canvas:offscreen},[offscreen]);const handleWebsockets=e=>{if(e.detail.id===virtId){var _virtuals$virtId,_virtuals$virtId$conf;const pixels="compressed"===config.transmission_mode?Actions_hexColor(e.detail.pixels,config.transmission_mode):e.detail.pixels,rows=showMatrix&&(null===(_virtuals$virtId=virtuals[virtId])||void 0===_virtuals$virtId||null===(_virtuals$virtId$conf=_virtuals$virtId.config)||void 0===_virtuals$virtId$conf?void 0:_virtuals$virtId$conf.rows)||1,cols=Math.ceil(pixels.length/rows);worker.postMessage({pixels,rows,cols})}};return document.addEventListener("visualisation_update",handleWebsockets),()=>{document.removeEventListener("visualisation_update",handleWebsockets),worker.terminate()}}),200)}),[virtId,virtuals,pixelGraphs,devices,graphs,config,showMatrix]);const render=virtuals[virtId].active&&(null===(_virtuals$virtId$effe=virtuals[virtId].effect)||void 0===_virtuals$virtId$effe?void 0:_virtuals$virtId$effe.name)||virtuals[virtId].streaming;return graphs||intGraphs?(0,jsx_runtime.jsx)("canvas",{ref:canvasRef,className:"".concat(className," ").concat(active?"active":""),style:{maxWidth:fullScreen?"100vw":"520px",maxHeight:fullScreen?"100vh":"unset",height:!render||((null===(_virtuals$virtId2=virtuals[virtId])||void 0===_virtuals$virtId2||null===(_virtuals$virtId2$con=_virtuals$virtId2.config)||void 0===_virtuals$virtId2$con?void 0:_virtuals$virtId2$con.rows)||1)<2||!showMatrix?"20px":"auto",width:"100%",borderRadius:"10px",overflow:"hidden",margin:db?0:"0.5rem 0 0 0",imageRendering:smoothing?"unset":"pixelated",objectFit:stretch&&fullScreen?"contain":"fill"},onDoubleClick}):null},PixelGraph_PixelGraphCanvasOffscreen=PixelGraphCanvasOffscreen;PixelGraphCanvasOffscreen.__docgenInfo={description:"",methods:[],displayName:"PixelGraphCanvasOffscreen",props:{virtId:{required:!0,tsType:{name:"string"},description:""},dummy:{required:!1,tsType:{name:"boolean"},description:""},className:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"''",computed:!1}},active:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},intGraphs:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},showMatrix:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},fullScreen:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},db:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onDoubleClick:{required:!1,tsType:{name:"any"},description:""}}};const PixelGraphCanvasOffscreenWebGL=_ref=>{var _virtuals$virtId$effe,_virtuals$virtId2,_virtuals$virtId2$con;let{virtId,className="",active=!1,intGraphs=!1,showMatrix=!1,fullScreen=!1,db=!1,onDoubleClick}=_ref;const canvasRef=(0,react.useRef)(null),workerRef=(0,react.useRef)(null),transferredRef=(0,react.useRef)(!1),{pixelGraphs,virtuals,devices,graphs,config}=(0,useStore.A)((0,shallow.k)((state=>({pixelGraphs:state.pixelGraphs,virtuals:state.virtuals,devices:state.devices,graphs:state.graphs,config:state.config})))),smoothing=(0,useStore.A)((state=>{var _state$uiPersist$pixe;return null===(_state$uiPersist$pixe=state.uiPersist.pixelGraphSettings)||void 0===_state$uiPersist$pixe?void 0:_state$uiPersist$pixe.smoothing})),stretch=(0,useStore.A)((state=>{var _state$uiPersist$pixe2;return null===(_state$uiPersist$pixe2=state.uiPersist.pixelGraphSettings)||void 0===_state$uiPersist$pixe2?void 0:_state$uiPersist$pixe2.stretch}));(0,react.useEffect)((()=>{setTimeout((()=>{const canvas=canvasRef.current;if(!canvas||transferredRef.current)return;const offscreen=canvas.transferControlToOffscreen(),worker=new Worker(new URL(__webpack_require__.p+__webpack_require__.u(6393),__webpack_require__.b));workerRef.current=worker,transferredRef.current=!0,worker.postMessage({canvas:offscreen},[offscreen]);const handleWebsockets=e=>{if(e.detail.id===virtId){var _virtuals$virtId,_virtuals$virtId$conf;const pixels="compressed"===config.transmission_mode?Actions_hexColor(e.detail.pixels,config.transmission_mode):e.detail.pixels,rows=showMatrix&&(null===(_virtuals$virtId=virtuals[virtId])||void 0===_virtuals$virtId||null===(_virtuals$virtId$conf=_virtuals$virtId.config)||void 0===_virtuals$virtId$conf?void 0:_virtuals$virtId$conf.rows)||1,cols=Math.ceil(pixels.length/rows);worker.postMessage({pixels,rows,cols})}};return document.addEventListener("visualisation_update",handleWebsockets),()=>{document.removeEventListener("visualisation_update",handleWebsockets),worker.terminate()}}),200)}),[virtId,virtuals,pixelGraphs,devices,graphs,config,showMatrix]);const render=virtuals[virtId].active&&(null===(_virtuals$virtId$effe=virtuals[virtId].effect)||void 0===_virtuals$virtId$effe?void 0:_virtuals$virtId$effe.name)||virtuals[virtId].streaming;return graphs||intGraphs?(0,jsx_runtime.jsx)("canvas",{ref:canvasRef,className:"".concat(className," ").concat(active?"active":""),style:{maxWidth:fullScreen?"100vw":"520px",maxHeight:fullScreen?"100vh":"unset",height:!render||((null===(_virtuals$virtId2=virtuals[virtId])||void 0===_virtuals$virtId2||null===(_virtuals$virtId2$con=_virtuals$virtId2.config)||void 0===_virtuals$virtId2$con?void 0:_virtuals$virtId2$con.rows)||1)<2||!showMatrix?"20px":"auto",width:"100%",borderRadius:"10px",overflow:"hidden",margin:db?0:"0.5rem 0 0 0",imageRendering:smoothing?"unset":"pixelated",objectFit:stretch&&fullScreen?"contain":"fill"},onDoubleClick}):null},PixelGraph_PixelGraphCanvasOffscreenWebGL=PixelGraphCanvasOffscreenWebGL;PixelGraphCanvasOffscreenWebGL.__docgenInfo={description:"",methods:[],displayName:"PixelGraphCanvasOffscreenWebGL",props:{virtId:{required:!0,tsType:{name:"string"},description:""},dummy:{required:!1,tsType:{name:"boolean"},description:""},className:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"''",computed:!1}},active:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},intGraphs:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},showMatrix:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},fullScreen:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},db:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onDoubleClick:{required:!1,tsType:{name:"any"},description:""}}};const PixelGraphCanvasOffscreenWebGLSync=_ref=>{var _virtuals$virtId$effe,_virtuals$virtId2,_virtuals$virtId2$con;let{virtId,className="",active=!1,intGraphs=!1,showMatrix=!1,fullScreen=!1,db=!1,onDoubleClick}=_ref;const canvasRef=(0,react.useRef)(null),workerRef=(0,react.useRef)(null),transferredRef=(0,react.useRef)(!1),animationFrameRef=(0,react.useRef)(null),{pixelGraphs,virtuals,devices,graphs,config}=(0,useStore.A)((0,shallow.k)((state=>({pixelGraphs:state.pixelGraphs,virtuals:state.virtuals,devices:state.devices,graphs:state.graphs,config:state.config})))),smoothing=(0,useStore.A)((state=>{var _state$uiPersist$pixe;return null===(_state$uiPersist$pixe=state.uiPersist.pixelGraphSettings)||void 0===_state$uiPersist$pixe?void 0:_state$uiPersist$pixe.smoothing})),stretch=(0,useStore.A)((state=>{var _state$uiPersist$pixe2;return null===(_state$uiPersist$pixe2=state.uiPersist.pixelGraphSettings)||void 0===_state$uiPersist$pixe2?void 0:_state$uiPersist$pixe2.stretch}));(0,react.useEffect)((()=>{setTimeout((()=>{transferredRef.current||(async()=>{const canvas=canvasRef.current;if(!canvas)return;const offscreen=canvas.transferControlToOffscreen(),worker=new Worker(new URL(__webpack_require__.p+__webpack_require__.u(8774),__webpack_require__.b));workerRef.current=worker,transferredRef.current=!0,worker.postMessage({canvas:offscreen},[offscreen])})();const handleWebsockets=e=>{if(e.detail.id===virtId){var _virtuals$virtId,_virtuals$virtId$conf;const pixels="compressed"===config.transmission_mode?Actions_hexColor(e.detail.pixels,config.transmission_mode):e.detail.pixels,rows=showMatrix&&(null===(_virtuals$virtId=virtuals[virtId])||void 0===_virtuals$virtId||null===(_virtuals$virtId$conf=_virtuals$virtId.config)||void 0===_virtuals$virtId$conf?void 0:_virtuals$virtId$conf.rows)||1,cols=Math.ceil(pixels.length/rows);animationFrameRef.current&&cancelAnimationFrame(animationFrameRef.current),animationFrameRef.current=requestAnimationFrame((()=>{var _workerRef$current;null===(_workerRef$current=workerRef.current)||void 0===_workerRef$current||_workerRef$current.postMessage({pixels,rows,cols})}))}};return document.addEventListener("visualisation_update",handleWebsockets),()=>{var _workerRef$current2;document.removeEventListener("visualisation_update",handleWebsockets),null===(_workerRef$current2=workerRef.current)||void 0===_workerRef$current2||_workerRef$current2.terminate(),animationFrameRef.current&&cancelAnimationFrame(animationFrameRef.current)}}),200)}),[virtId,virtuals,pixelGraphs,devices,graphs,config,showMatrix]);const render=virtuals[virtId].active&&(null===(_virtuals$virtId$effe=virtuals[virtId].effect)||void 0===_virtuals$virtId$effe?void 0:_virtuals$virtId$effe.name)||virtuals[virtId].streaming;return graphs||intGraphs?(0,jsx_runtime.jsx)("canvas",{ref:canvasRef,className:"".concat(className," ").concat(active?"active":""),style:{maxWidth:fullScreen?"100vw":"520px",maxHeight:fullScreen?"100vh":"unset",height:!render||((null===(_virtuals$virtId2=virtuals[virtId])||void 0===_virtuals$virtId2||null===(_virtuals$virtId2$con=_virtuals$virtId2.config)||void 0===_virtuals$virtId2$con?void 0:_virtuals$virtId2$con.rows)||1)<2||!showMatrix?"20px":"auto",width:"100%",borderRadius:"10px",overflow:"hidden",margin:db?0:"0.5rem 0 0 0",imageRendering:smoothing?"unset":"pixelated",objectFit:stretch&&fullScreen?"contain":"fill"},onDoubleClick}):null},PixelGraph_PixelGraphCanvasOffscreenWebGLSync=PixelGraphCanvasOffscreenWebGLSync;PixelGraphCanvasOffscreenWebGLSync.__docgenInfo={description:"",methods:[],displayName:"PixelGraphCanvasOffscreenWebGLSync",props:{virtId:{required:!0,tsType:{name:"string"},description:""},dummy:{required:!1,tsType:{name:"boolean"},description:""},className:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"''",computed:!1}},active:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},intGraphs:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},showMatrix:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},fullScreen:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},db:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onDoubleClick:{required:!1,tsType:{name:"any"},description:""}}};const PixelGraph=_ref=>{let{virtId,dummy=!1,className="",active=!1,intGraphs=!1,showMatrix=!1,fullScreen=!1,db=!1,onDoubleClick,fill=!1}=_ref;const variants=(0,useStore.A)((state=>{var _state$uiPersist$pixe;return null===(_state$uiPersist$pixe=state.uiPersist.pixelGraphSettings)||void 0===_state$uiPersist$pixe?void 0:_state$uiPersist$pixe.variants}));return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["original"===variants&&(0,jsx_runtime.jsx)(PixelGraph_PixelGraphBase,{virtId,dummy,className,active,intGraphs,showMatrix,fullScreen,db,onDoubleClick}),"canvas"===variants&&(0,jsx_runtime.jsx)(PixelGraph_PixelGraphCanvas,{virtId,dummy,className,active,intGraphs,showMatrix,fullScreen,db,onDoubleClick,fill}),"canvasOffscreen"===variants&&(0,jsx_runtime.jsx)(PixelGraph_PixelGraphCanvasOffscreen,{virtId,dummy,className,active,intGraphs,showMatrix,fullScreen,db,onDoubleClick}),"canvasOffscreenWebGL"===variants&&(0,jsx_runtime.jsx)(PixelGraph_PixelGraphCanvasOffscreenWebGL,{virtId,dummy,className,active,intGraphs,showMatrix,fullScreen,db,onDoubleClick}),"canvasOffscreenWebGLSync"===variants&&(0,jsx_runtime.jsx)(PixelGraph_PixelGraphCanvasOffscreenWebGLSync,{virtId,dummy,className,active,intGraphs,showMatrix,fullScreen,db,onDoubleClick})]})},PixelGraph_PixelGraph=PixelGraph;PixelGraph.__docgenInfo={description:"",methods:[],displayName:"PixelGraph",props:{virtId:{required:!0,tsType:{name:"string"},description:""},dummy:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},className:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"''",computed:!1}},active:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},intGraphs:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},showMatrix:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},fullScreen:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},db:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},onDoubleClick:{required:!1,tsType:{name:"any"},description:""},fill:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}}};const EditMatrix=_ref=>{let{virtual}=_ref;const classes=M_styles(),theme=(0,useTheme.A)(),deviceRef=(0,react.useRef)(null),devices=(0,useStore.A)((state=>state.devices)),addDevice=(0,useStore.A)((state=>state.addDevice)),getDevices=(0,useStore.A)((state=>state.getDevices)),getVirtuals=(0,useStore.A)((state=>state.getVirtuals)),updateVirtual=(0,useStore.A)((state=>state.updateVirtual)),setEffect=(0,useStore.A)((state=>state.setEffect)),points=(0,useStore.A)((state=>state.points)),[error,setError]=(0,react.useState)([]),[currentDevice,setCurrentDevice]=(0,react.useState)(""),[rowN,setRowNumber]=(0,react.useState)(virtual.config.rows||8),[colN,setColNumber]=(0,react.useState)(Math.ceil(virtual.pixel_count/(virtual.config.rows||1))||8),[currentCell,setCurrentCell]=(0,react.useState)([-1,-1]),[open,setOpen]=(0,react.useState)(!1),[group,setGroup]=(0,react.useState)(!1),[selectedPixel,setSelectedPixel]=(0,react.useState)(0),[direction,setDirection]=(0,react.useState)("right"),[m,setM]=(0,react.useState)(Array(rowN).fill(Array(colN).fill(MCell))),[pixelGroups,setPixelGroups]=(0,react.useState)(0),[selectedGroup,setSelectedGroup]=(0,react.useState)(""),[move,setMove]=(0,react.useState)(!1),[dnd,setDnd]=(0,react.useState)(!1),[anchorEl,setAnchorEl]=(0,react.useState)(null),[isDragging,setIsDragging]=(0,react.useState)(!1),[hoveringCell,setHoveringCell]=(0,react.useState)([-1,-1]),[showPixelGraph,setShowPixelGraph]=(0,react.useState)(!1),handleContextMenu=(e,currentColIndex,currentRowIndex,yzcolumn)=>{var _m$currentRowIndex$cu;(e.preventDefault(),e.stopPropagation(),setCurrentCell([currentColIndex,currentRowIndex]),setCurrentDevice(""!==yzcolumn.deviceId?yzcolumn.deviceId:""),setSelectedPixel(yzcolumn.pixel||0),currentRowIndex>-1&&currentColIndex>-1)&&(""!==(null===(_m$currentRowIndex$cu=m[currentRowIndex][currentColIndex])||void 0===_m$currentRowIndex$cu?void 0:_m$currentRowIndex$cu.deviceId)?setAnchorEl(e.currentTarget):setOpen(!0))},closeClear=()=>{setOpen(!1),setCurrentDevice(""),setSelectedPixel(0),setGroup(!1)},clearPixel=()=>{const updatedM=clone(m),[col,row]=currentCell;updatedM[row][col]={deviceId:"",pixel:0,group:0},setM(updatedM),closeClear()},handleDragEnd=event=>{const{active,over}=event;if(setIsDragging(!1),!over||!over.id)return;const[startCol,startRow]=active.id.split("-").map(Number),[endCol,endRow]=over.id.split("-").map(Number);if(isNaN(startCol)||isNaN(startRow)||isNaN(endCol)||isNaN(endRow))console.error("DND parsing failed",{active,over});else if(move){var _m$startRow$startCol;const groupId=null===(_m$startRow$startCol=m[startRow][startCol])||void 0===_m$startRow$startCol?void 0:_m$startRow$startCol.group;if(groupId){((groupId,rowOffset,colOffset)=>{const groupPixels=[];for(let i=0;i<rowN;i++)for(let j=0;j<colN;j++)m[i][j].group===groupId&&groupPixels.push((0,objectSpread2.A)((0,objectSpread2.A)({},m[i][j]),{},{oldRow:i,oldCol:j}));if(0===groupPixels.length)return;for(const pixel of groupPixels){const targetRow=pixel.oldRow+rowOffset,targetCol=pixel.oldCol+colOffset;if(targetRow<0||targetRow>=rowN||targetCol<0||targetCol>=colN)return void console.error("Move aborted: group would go out of bounds.");const targetCell=m[targetRow][targetCol];if(""!==targetCell.deviceId&&targetCell.group!==groupId)return void console.error("Move aborted: collision with external pixel(s).")}const updatedM=clone(m);for(const pixel of groupPixels)updatedM[pixel.oldRow][pixel.oldCol]={deviceId:"",pixel:0,group:""};for(const pixel of groupPixels){const targetRow=pixel.oldRow+rowOffset,targetCol=pixel.oldCol+colOffset,pixelData=Object.assign({},((0,objectDestructuringEmpty.A)(pixel),pixel));updatedM[targetRow][targetCol]=pixelData}setM(updatedM)})(groupId,endRow-startRow,endCol-startCol)}}else{const updatedM=clone(m);""===updatedM[endRow][endCol].deviceId&&(updatedM[endRow][endCol]=updatedM[startRow][startCol],updatedM[startRow][startCol]={deviceId:"",pixel:0,group:0},setM(updatedM))}};return(0,react.useEffect)((()=>{group?"number"==typeof selectedPixel&&setSelectedPixel([selectedPixel,selectedPixel+1]):"number"!=typeof selectedPixel&&setSelectedPixel(selectedPixel[0])}),[group,selectedPixel]),(0,react.useEffect)((()=>{setM(Array(rowN).fill(Array(colN).fill(MCell)))}),[rowN,colN]),(0,react.useEffect)((()=>{0===virtual.segments.length?Object.values(devices).some((d=>d.id==="gap-".concat(virtual.id)))||addDevice({type:"dummy",config:{center_offset:0,icon_name:"mdi:eye-off",name:"gap-".concat(virtual.id),pixel_count:4096,refresh_rate:64}}).then((()=>{(0,ledfx.U)("/api/virtuals/".concat(virtual.id),"POST",{segments:[["gap-".concat(virtual.id),0,virtual.config.rows*virtual.config.rows-1,!1]]}).then((()=>{getDevices(),getVirtuals().then((()=>{setEffect(virtual.id,"equalizer2d",{bands:virtual.config.rows},!0).then((()=>{updateVirtual(virtual.id,!0)}))}))}))})):setM(reverseProcessArray(virtual.segments,colN))}),[]),(0,react.useEffect)((()=>{if(points.length>0){const updatedM=clone(m),p=points[points.length-1];!isNaN(p.x)&&!isNaN(p.y)&&p.x>0&&p.y>0&&p.x<=colN&&p.y<=rowN&&(updatedM[p.y-1][p.x-1]={deviceId:p.device,pixel:p.led,group:p.segment+1},setM(updatedM))}}),[points]),(0,jsx_runtime.jsxs)(EditMatrix_MWrapper,{move:dnd,children:[(0,jsx_runtime.jsx)(Stack.A,{direction:"column",spacing:2,bgcolor:theme.palette.action.disabledBackground,sx:{overflowY:"scroll",height:"100%",overflowX:"hidden",minWidth:440,paddingTop:"1rem"},children:(0,jsx_runtime.jsx)(MControls_MControls,{dnd,setDnd,rowN,colN,setRowNumber,setColNumber,virtual,m,setM,move,setMove,selectedGroup,setError,setShowPixelGraph,showPixelGraph,pixelGroups,setPixelGroups,setSelectedGroup})}),(0,jsx_runtime.jsx)(Box.A,{sx:{flexGrow:1,overflow:"hidden",height:"100%"},children:(0,jsx_runtime.jsx)(index_esm.GT,{disabled:dnd,centerZoomedOut:!0,minScale:.1,initialScale:100*colN<window.innerWidth||100*rowN<.8*window.innerHeight?1:.1,children:(0,jsx_runtime.jsx)(index_esm.WZ,{children:(0,jsx_runtime.jsxs)("div",{className:classes.gridCellContainer,style:{width:100*colN,height:100*rowN},children:[(0,jsx_runtime.jsx)("div",{style:{display:"flex",flexDirection:"column",zIndex:1},children:(0,jsx_runtime.jsx)(core_esm.Mp,{modifiers:[modifiers_esm.Mk],onDragStart:event=>{if(setIsDragging(!0),move){var _m$row$col;const[col,row]=event.active.id.split("-").map(Number),groupId=null===(_m$row$col=m[row][col])||void 0===_m$row$col?void 0:_m$row$col.group;groupId&&setSelectedGroup(groupId)}},onDragEnd:e=>handleDragEnd(e),onDragOver:e=>{var _e$over,_e$over$id;return setHoveringCell((null===(_e$over=e.over)||void 0===_e$over||null===(_e$over$id=_e$over.id)||void 0===_e$over$id?void 0:_e$over$id.split("-").map(Number))||[-1,-1])},children:m.map(((yzrow,currentRowIndex)=>(0,jsx_runtime.jsx)("div",{style:{display:"flex"},children:yzrow.map(((yzcolumn,currentColIndex)=>(0,jsx_runtime.jsx)(EditMatrix_Droppable,{cell:hoveringCell[0]>-1&&hoveringCell[1]>-1?m[hoveringCell[1]][hoveringCell[0]]:void 0,id:"".concat(currentColIndex,"-").concat(currentRowIndex),bg:""!==m[currentRowIndex][currentColIndex].deviceId?"transparent":"black",opacity:.8,onContextMenu:e=>handleContextMenu(e,currentColIndex,currentRowIndex,yzcolumn),onClick:()=>{console.log("Clicked cell: ".concat(currentColIndex,"-").concat(currentRowIndex)),move&&""===m[currentRowIndex][currentColIndex].deviceId&&setSelectedGroup("")},children:(0,jsx_runtime.jsx)(Box.A,{onContextMenu:e=>handleContextMenu(e,currentColIndex,currentRowIndex,yzcolumn),sx:{opacity:1},children:dnd?""!==m[currentRowIndex][currentColIndex].deviceId?(0,jsx_runtime.jsx)(EditMatrix_Draggable,{m,id:"".concat(currentColIndex,"-").concat(currentRowIndex),children:(0,jsx_runtime.jsx)(EditMatrix_Pixel,{m,currentColIndex,classes,currentRowIndex,move,yzcolumn,selectedGroup,error,setCurrentCell,setCurrentDevice,setSelectedPixel,openContextMenu:e=>setAnchorEl(e.currentTarget),isDragging})}):null:(0,jsx_runtime.jsx)(EditMatrix_Pixel,{m,currentColIndex,classes,currentRowIndex,move,yzcolumn,selectedGroup,error,setCurrentCell,setCurrentDevice,setSelectedPixel,openContextMenu:e=>setAnchorEl(e.currentTarget),isDragging})},"col-".concat(currentColIndex))},"col-".concat(currentColIndex))))},"row-".concat(currentRowIndex))))})}),virtual.id&&showPixelGraph&&(0,jsx_runtime.jsx)("div",{style:{position:"absolute",top:-2,left:0,right:0,bottom:0,zIndex:0},children:(0,jsx_runtime.jsx)(PixelGraph_PixelGraph,{showMatrix:!0,virtId:virtual.id,active:!0,dummy:!1,fullScreen:!0,fill:!0})}),(0,jsx_runtime.jsx)(EditMatrix_MContextMenu,{setDnd,setSelectedGroup,anchorEl,closeContextMenu:()=>setAnchorEl(null),currentCell,m,setOpen,setMove,clearPixel,clearPixelGroup:group=>{const updatedM=clone(m);m.forEach(((row,rowIndex)=>{row.forEach(((cell,colIndex)=>{cell.group===group&&(updatedM[rowIndex][colIndex]={deviceId:"",pixel:0,group:0})}))})),setM(updatedM)},pixelGroups,setPixelGroups}),(0,jsx_runtime.jsx)(EditMatrix_AssignPixelDialog,{open,closeClear,currentCell,m,setCurrentDevice,deviceRef,group,setGroup,direction,handleDirectionChange:d=>{if(setDirection(d),"number"!=typeof selectedPixel){const[col,row]=currentCell,maxRange=getMaxRange(direction,row,col,rowN,colN);selectedPixel[1]-selectedPixel[0]>maxRange&&setSelectedPixel([selectedPixel[0],selectedPixel[0]+maxRange])}},selectedPixel,handleSliderChange:(e,newPixelRange,activeThumb)=>{if("number"!=typeof newPixelRange){const[col,row]=currentCell,maxRange=getMaxRange(direction,row,col,rowN,colN),distance=Math.abs(newPixelRange[1]-newPixelRange[0]);let adjustedLeftThumb=newPixelRange[0],adjustedRightThumb=newPixelRange[1];distance>maxRange&&(0===activeThumb?adjustedRightThumb=adjustedLeftThumb+maxRange:adjustedLeftThumb=adjustedRightThumb-maxRange);setSelectedPixel("top"===direction?[adjustedRightThumb,adjustedLeftThumb]:[adjustedLeftThumb,adjustedRightThumb])}else setSelectedPixel(newPixelRange)},clearPixel,setM,currentDevice,pixelGroups,setPixelGroups,rowN,colN})]})})})})]})},M=EditMatrix;EditMatrix.__docgenInfo={description:"",methods:[],displayName:"EditMatrix",props:{virtual:{required:!0,tsType:{name:"any"},description:""}}};var List=__webpack_require__("./node_modules/@mui/material/esm/List/List.js"),ListItem=__webpack_require__("./node_modules/@mui/material/esm/ListItem/ListItem.js");const Tours_Tour=__webpack_require__("./node_modules/reactour/dist/reactour.esm.js").Ay;var ViewModule=__webpack_require__("./node_modules/@mui/icons-material/esm/ViewModule.js"),AspectRatio=__webpack_require__("./node_modules/@mui/icons-material/esm/AspectRatio.js"),OpenWith=__webpack_require__("./node_modules/@mui/icons-material/esm/OpenWith.js"),Edit=__webpack_require__("./node_modules/@mui/icons-material/esm/Edit.js"),Transform=__webpack_require__("./node_modules/@mui/icons-material/esm/Transform.js"),Timeline=__webpack_require__("./node_modules/@mui/icons-material/esm/Timeline.js"),CameraAlt=__webpack_require__("./node_modules/@mui/icons-material/esm/CameraAlt.js"),Help=__webpack_require__("./node_modules/@mui/icons-material/esm/Help.js");const TourStep=_ref=>{let{title,children,icon:Icon}=_ref;return(0,jsx_runtime.jsxs)(Box.A,{sx:{maxWidth:350,color:"white"},children:[(0,jsx_runtime.jsxs)(Typography.A,{variant:"h6",sx:{display:"flex",alignItems:"center",mb:1.5},children:[Icon&&(0,jsx_runtime.jsx)(Icon,{sx:{mr:1,color:"primary.main"}}),title]}),(0,jsx_runtime.jsx)(Divider.A,{sx:{mb:1.5}}),(0,jsx_runtime.jsx)(Typography.A,{variant:"body2",component:"div",children})]})},baseStyle={backgroundColor:"#303030",padding:"16px",borderRadius:"8px"},steps=[{selector:".yz",content:(0,jsx_runtime.jsxs)(TourStep,{title:"Welcome to 2D Mapping",icon:ViewModule.A,children:["This is the 2D Virtual Mapper. Here, you define the physical layout of your LEDs on a 2D grid.",(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("br",{}),"LedFx uses this grid to render 2D effects accurately onto your unique setup."]}),style:baseStyle},{selector:".step-2d-virtual-three",content:(0,jsx_runtime.jsxs)(TourStep,{title:"Define Grid Size",icon:AspectRatio.A,children:["Start by setting the total Rows and Columns for your 2D layout.",(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("br",{}),"This defines the canvas size you will map your pixels onto. Adjust these sliders to match your desired resolution."]}),style:baseStyle},{selector:".react-transform-wrapper",content:(0,jsx_runtime.jsxs)(TourStep,{title:"Navigating the Canvas",icon:OpenWith.A,children:["Interact with the grid:",(0,jsx_runtime.jsxs)(List.A,{dense:!0,sx:{listStyleType:"disc",pl:4},children:[(0,jsx_runtime.jsxs)(ListItem.Ay,{sx:{display:"list-item"},children:[(0,jsx_runtime.jsx)("strong",{children:"Zoom:"})," Use your mouse wheel."]}),(0,jsx_runtime.jsxs)(ListItem.Ay,{sx:{display:"list-item"},children:[(0,jsx_runtime.jsx)("strong",{children:"Pan:"})," Left-click and drag."]})]}),'This navigation is active when the "DND-Canvas" mode is selected.']}),style:baseStyle,action:()=>{const canvasTab=document.querySelector('.MuiTab-root[value="1"]');canvasTab&&canvasTab.click()}},{selector:".react-transform-component",content:(0,jsx_runtime.jsxs)(TourStep,{title:"Mapping Pixels",icon:Edit.A,children:["Time to map your physical LEDs onto this grid!",(0,jsx_runtime.jsxs)(List.A,{dense:!0,sx:{listStyleType:"disc",pl:4},children:[(0,jsx_runtime.jsxs)(ListItem.Ay,{sx:{display:"list-item"},children:[(0,jsx_runtime.jsx)("strong",{children:"Right-click"})," an empty cell on the grid."]}),(0,jsx_runtime.jsx)(ListItem.Ay,{sx:{display:"list-item"},children:"In the dialog, select a Device and assign the corresponding Pixel Index."}),(0,jsx_runtime.jsx)(ListItem.Ay,{sx:{display:"list-item"},children:'Use "Group Mapping" to assign a range of pixels quickly.'})]})]}),style:baseStyle},{selector:".react-transform-component",content:(0,jsx_runtime.jsxs)(TourStep,{title:"Editing & Moving Groups",children:["Once pixels are mapped, you can adjust them.",(0,jsx_runtime.jsxs)(List.A,{dense:!0,sx:{listStyleType:"disc",pl:4},children:[(0,jsx_runtime.jsxs)(ListItem.Ay,{sx:{display:"list-item"},children:[(0,jsx_runtime.jsx)("strong",{children:"Right-click"})," a mapped pixel to Edit, Clear, or Move its Group."]}),(0,jsx_runtime.jsx)(ListItem.Ay,{sx:{display:"list-item"},children:'If you select "Move Group", the directional controls (arrows) will appear in the sidebar.'})]})]}),style:baseStyle},{selector:".step-2d-virtual-four",content:(0,jsx_runtime.jsxs)(TourStep,{title:"Layout Tools",icon:Transform.A,children:["Use these tools to manipulate the entire grid:",(0,jsx_runtime.jsxs)(List.A,{dense:!0,sx:{listStyleType:"disc",pl:4},children:[(0,jsx_runtime.jsx)(ListItem.Ay,{sx:{display:"list-item"},children:"Rotate 90°, Flip Horizontally/Vertically."}),(0,jsx_runtime.jsxs)(ListItem.Ay,{sx:{display:"list-item"},children:["Use ",(0,jsx_runtime.jsx)("strong",{children:"Reset"})," to reload the saved configuration."]}),(0,jsx_runtime.jsxs)(ListItem.Ay,{sx:{display:"list-item"},children:["Don't forget to ",(0,jsx_runtime.jsx)("strong",{children:"Save"})," your mapping!"]})]})]}),style:baseStyle},{selector:".step-2d-virtual-two",content:(0,jsx_runtime.jsxs)(TourStep,{title:"Live Pixel Graph",icon:Timeline.A,children:["Click the Play button to overlay the live visualization onto your 2D grid.",(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("br",{}),"This helps you verify that your mapping correctly aligns with the effects being generated by LedFx in real-time."]}),style:baseStyle},{selector:".step-2d-virtual-six",content:(0,jsx_runtime.jsxs)(TourStep,{title:"Interaction Modes",icon:Settings.A,children:["Switch how you interact with the mapper:",(0,jsx_runtime.jsxs)(List.A,{dense:!0,sx:{listStyleType:"disc",pl:4},children:[(0,jsx_runtime.jsxs)(ListItem.Ay,{sx:{display:"list-item"},children:[(0,jsx_runtime.jsx)("strong",{children:"DND-Canvas:"})," For zooming/panning the whole grid and right-click mapping."]}),(0,jsx_runtime.jsxs)(ListItem.Ay,{sx:{display:"list-item"},children:[(0,jsx_runtime.jsx)("strong",{children:"DND-Pixels:"})," Drag and drop individual mapped pixels to reposition them (disables zoom/pan)."]})]})]}),style:baseStyle},{selector:".step-2d-virtual-cam-toggle",content:(0,jsx_runtime.jsxs)(TourStep,{title:"Camera Mapper [Beta]",icon:CameraAlt.A,children:["Automate the mapping process! Use your webcam to detect the physical location of your LEDs and map them automatically to the grid.",(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("br",{}),"Click here to start the Camera Mapper tool."]}),style:baseStyle},{selector:".step-2d-virtual-cam-initialize",content:(0,jsx_runtime.jsx)(TourStep,{title:"Initialize Camera",children:"First, initialize the camera. Ensure your LED setup is clearly visible in the camera feed."}),style:baseStyle},{selector:".step-2d-virtual-cam-adjust",content:(0,jsx_runtime.jsx)(TourStep,{title:"Adjust Camera Settings",icon:Tune.A,children:"Adjust brightness, contrast, and gamma to optimize the camera's view of your LEDs. The goal is clear visibility of the lights against the background."}),style:baseStyle},{selector:".step-2d-virtual-cam-calibrate",content:(0,jsx_runtime.jsx)(TourStep,{title:"Calibrate",children:"Calibration helps LedFx understand the perspective and dimensions of your setup. Follow the on-screen prompts during calibration."}),style:baseStyle},{selector:".step-2d-virtual-cam-crop",content:(0,jsx_runtime.jsx)(TourStep,{title:"Crop & Mask",children:"Use the cropping tools to focus the detection area precisely on your LEDs, excluding background noise or other light sources."}),style:baseStyle},{selector:".step-2d-virtual-cam-settings",content:(0,jsx_runtime.jsxs)(TourStep,{title:"Detection Thresholds",icon:Settings.A,children:["Fine-tune these settings to ensure accurate LED detection.",(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("br",{}),"Adjust the ",(0,jsx_runtime.jsx)("strong",{children:"LED brightness"})," and ",(0,jsx_runtime.jsx)("strong",{children:"detection threshold"})," so LedFx reliably identifies each pixel during the mapping process."]}),style:baseStyle}],Tour2dVirtual=()=>{const[isTourOpen,setIsTourOpen]=(0,react.useState)(!1),setTour=(0,useStore.A)((state=>state.setTour)),features=(0,useStore.A)((state=>state.features)),theme=(0,useTheme.A)(),manualMapperSteps=steps.slice(0,8),cameraMapperSteps=steps.slice(8),activeSteps=features.matrix_cam?[...manualMapperSteps,...cameraMapperSteps]:manualMapperSteps;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Tooltip.A,{title:"How to use 2D Virtuals",children:(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>{setIsTourOpen(!0),setTour("2d-virtual")},children:(0,jsx_runtime.jsx)(Help.A,{})})}),(0,jsx_runtime.jsx)(Tours_Tour,{steps:activeSteps,accentColor:theme.palette.primary.main,isOpen:isTourOpen,showNavigation:!0,onRequestClose:()=>setIsTourOpen(!1),showNumber:!0,lastStepNextButton:(0,jsx_runtime.jsx)(Box.A,{onClick:()=>{const exitCamMapperButton=document.querySelector(".step-2d-virtual-cam-toggle button");exitCamMapperButton&&exitCamMapperButton.innerText.includes("Exit")&&exitCamMapperButton.click()},children:"Done"})})]})},Tours_Tour2dVirtual=Tour2dVirtual;Tour2dVirtual.__docgenInfo={description:"",methods:[],displayName:"Tour2dVirtual"};var SubdirectoryArrowRight=__webpack_require__("./node_modules/@mui/icons-material/esm/SubdirectoryArrowRight.js");const AddExistingSegmentDialog_excluded=["onClose","value","open"],AddExistingSegmentDialog_classes={root:"".concat("_AddSegmentDialog","-root"),paper:"".concat("_AddSegmentDialog","-paper")},AddExistingSegmentDialog_Root=(0,styled.Ay)("div")((_ref=>{let{theme}=_ref;return{["&.".concat(AddExistingSegmentDialog_classes.root)]:{margin:"1rem",backgroundColor:theme.palette.background.paper},["& .".concat(AddExistingSegmentDialog_classes.paper)]:{width:"80%",maxHeight:435}}}));function AddExistingSegmentDialog_ConfirmationDialogRaw(props){const{onClose,value:valueProp,open}=props,other=(0,objectWithoutProperties.A)(props,AddExistingSegmentDialog_excluded),[value,setValue]=react.useState(valueProp),virtuals=(0,useStore.A)((state=>state.virtuals))||{},showComplex=(0,useStore.A)((state=>state.showComplex)),showGaps=(0,useStore.A)((state=>state.showGaps)),virtualKeys=Object.keys(virtuals).filter((v=>showComplex?v:!(v.endsWith("-mask")||v.endsWith("-foreground")||v.endsWith("-background")))).filter((v=>showGaps?v:!v.startsWith("gap-"))).filter((v=>1===virtuals[v].segments.length)),segments=virtualKeys.reduce(((acc,v)=>(acc[virtuals[v].config.name]=virtuals[v].segments.flat(),acc)),{});return(0,jsx_runtime.jsxs)(Dialog.A,(0,objectSpread2.A)((0,objectSpread2.A)({disableEscapeKeyDown:!0,maxWidth:"xs","aria-labelledby":"confirmation-dialog-title",open},other),{},{children:[(0,jsx_runtime.jsx)(DialogTitle.A,{id:"confirmation-dialog-title",children:"Select a segment"}),(0,jsx_runtime.jsx)(DialogContent.A,{dividers:!0,children:(0,jsx_runtime.jsx)(BladeFrame.A,{full:!0,children:(0,jsx_runtime.jsx)(Select.A,{value,style:{width:"100%"},onChange:event=>{setValue(event.target.value)},children:Object.keys(segments).map((v=>{const k=virtualKeys.find((vi=>virtuals[vi].config.name===v));return(0,jsx_runtime.jsxs)(MenuItem.A,{value:JSON.stringify({[v]:segments[v]}),children:[k&&virtuals[k].is_device?"":(0,jsx_runtime.jsx)(SubdirectoryArrowRight.A,{color:"disabled",sx:{mr:1}}),v]},v)}))})})}),(0,jsx_runtime.jsxs)(DialogActions.A,{children:[(0,jsx_runtime.jsx)(Button.A,{autoFocus:!0,onClick:()=>{onClose()},color:"primary",children:"Cancel"}),(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{onClose(value)},color:"primary",children:"Ok"})]})]}))}function AddExistingSegmentDialog(_ref2){let{virtual,config={}}=_ref2;const[open,setOpen]=react.useState(!1),deviceList=(0,useStore.A)((state=>state.devices))||{},virtuals=(0,useStore.A)((state=>state.virtuals))||{},updateSegments=(0,useStore.A)((state=>state.updateSegments)),getVirtuals=(0,useStore.A)((state=>state.getVirtuals)),highlightSegment=(0,useStore.A)((state=>state.highlightSegment)),setEffect=(0,useStore.A)((state=>state.setEffect));return(0,jsx_runtime.jsx)(AddExistingSegmentDialog_Root,{className:AddExistingSegmentDialog_classes.root,children:deviceList&&Object.keys(deviceList).length>0?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Button.A,{variant:"contained",color:"primary","aria-label":"Add",endIcon:(0,jsx_runtime.jsx)(AddCircle.A,{}),onClick:()=>{setOpen(!0)},role:"listitem",children:"ADD EXISTING SEGMENT"}),(0,jsx_runtime.jsx)(AddExistingSegmentDialog_ConfirmationDialogRaw,{classes:{paper:AddExistingSegmentDialog_classes.paper},config,id:"ringtone-menu",keepMounted:!0,open,onClose:newValue=>{if(setOpen(!1),!newValue)return;const[name,segments]=Object.entries(JSON.parse(newValue))[0];if(name&&segments){const deviceKey=Object.keys(deviceList).find((d=>deviceList[d].id===segments[0])),device=deviceKey?deviceList[deviceKey]:void 0,test=[...virtual.segments,segments].filter((t=>4===t.length));updateSegments(virtual.id,test).then((()=>{getVirtuals(),device&&!1===virtual.active&&0===virtual.segments.length&&(device.active_virtuals&&device.active_virtuals[0]&&virtuals&&virtuals[device.active_virtuals[0]]&&virtuals[device.active_virtuals[0]].effect&&virtuals[device.active_virtuals[0]].effect.type?setEffect(virtual.id,virtuals[device.active_virtuals[0]].effect.type,virtuals[device.active_virtuals[0]].effect.config,!0):setEffect(virtual.id,"rainbow",{},!0)),device&&highlightSegment(virtual.id,device.id,segments[1],segments[2],!1)}))}},value:"",deviceList})]}):null})}const Dialogs_AddExistingSegmentDialog=AddExistingSegmentDialog;AddExistingSegmentDialog.__docgenInfo={description:"",methods:[],displayName:"AddExistingSegmentDialog",props:{virtual:{required:!0,tsType:{name:"any"},description:""},config:{required:!1,tsType:{name:"any"},description:"",defaultValue:{value:"{}",computed:!1}}}};const Transition=react.forwardRef((function Transition(props,ref){return(0,jsx_runtime.jsx)(Slide.A,(0,objectSpread2.A)({direction:"up",ref},props))})),MuiMenuItem=react.forwardRef(((props,ref)=>{const{children}=props;return(0,jsx_runtime.jsx)(MenuItem.A,(0,objectSpread2.A)((0,objectSpread2.A)({ref},props),{},{children}))}));function EditVirtuals(_ref){var _virtual$segments;let{virtId,icon=(0,jsx_runtime.jsx)(Settings.A,{}),startIcon,label="",type,className,color="inherit",variant="contained",onClick=()=>{},innerKey}=_ref;const[matrix,setMatrix]=(0,react.useState)(!1),currentVirtual=(0,useStore.A)((state=>state.currentVirtual)),setCurrentVirtual=(0,useStore.A)((state=>state.setCurrentVirtual)),calibrationMode=(0,useStore.A)((state=>state.calibrationMode)),classes=EditVirtuals_styles(),showSnackbar=(0,useStore.A)((state=>state.ui.showSnackbar)),getDevices=(0,useStore.A)((state=>state.getDevices)),virtuals=(0,useStore.A)((state=>state.virtuals)),setDialogOpenEditVirtual=(0,useStore.A)((state=>state.setDialogOpenEditVirtual)),activeSegment=(0,useStore.A)((state=>state.activeSegment)),highlightSegment=(0,useStore.A)((state=>state.highlightSegment)),virtual=virtuals[currentVirtual||virtId],[open,setOpen]=react.useState(!!currentVirtual||!1),[calib,setCalib]=react.useState(!0),handleClickOpen=()=>{setOpen(!0)},handleClose=()=>{const output=(0,helpers.i5)(virtual.segments),overlap=Object.keys(output).find((k=>output[k].overlap));overlap?showSnackbar("warning","Overlapping in ".concat(overlap," detected! Please Check your config")):(setOpen(!1),setDialogOpenEditVirtual(!1),setCurrentVirtual(null),onClick())};return(0,react.useEffect)((()=>{getDevices()}),[getDevices]),(0,react.useEffect)((()=>{currentVirtual&&"hidden"===type&&setOpen(!0)}),[currentVirtual]),(0,react.useEffect)((()=>(null!=virtual&&virtual.id&&open&&calibrationMode(null==virtual?void 0:virtual.id,"on"),()=>{null!=virtual&&virtual.id&&open&&calibrationMode(null==virtual?void 0:virtual.id,"off")})),[null==virtual?void 0:virtual.id,open]),(0,react.useEffect)((()=>{matrix&&setCalib(!1)}),[matrix]),virtual&&virtual.config?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["menuItem"===type?(0,jsx_runtime.jsxs)(MuiMenuItem,{className,onClick:e=>{e.preventDefault(),handleClickOpen()},children:[(0,jsx_runtime.jsx)(ListItemIcon.A,{children:icon}),label]},innerKey):"hidden"===type?null:(0,jsx_runtime.jsxs)(Button.A,{variant,startIcon,color,onClick:()=>{handleClickOpen()},size:"small",className,children:[label,!startIcon&&icon]}),(0,jsx_runtime.jsxs)(Dialog.A,{fullScreen:!0,open,onClose:handleClose,TransitionComponent:Transition,children:[(0,jsx_runtime.jsx)(AppBar.A,{enableColorOnDark:!0,color:"secondary",className:classes.appBar,children:(0,jsx_runtime.jsxs)(Toolbar.A,{children:[(0,jsx_runtime.jsx)(Button.A,{autoFocus:!0,color:"primary",variant:"contained",startIcon:(0,jsx_runtime.jsx)(NavigateBefore.A,{}),onClick:handleClose,style:{marginRight:"1rem"},children:"back"}),(virtual.config.rows||1)>1&&(0,jsx_runtime.jsxs)(ToggleButtonGroup.A,{value:matrix,style:{marginRight:"1rem"},size:"small",exclusive:!0,onChange:()=>setMatrix(!matrix),"aria-label":"mode",children:[(0,jsx_runtime.jsx)(ToggleButton.A,{value:!1,children:(0,jsx_runtime.jsx)(BladeIcon.A,{name:"mdi:led-strip"})}),(0,jsx_runtime.jsx)(ToggleButton.A,{value:!0,children:(0,jsx_runtime.jsx)(GridOn.A,{})})]}),(0,jsx_runtime.jsxs)(Typography.A,{variant:"h6",className:classes.title,children:[virtual.config.name," "]}),(virtual.config.rows||1)>1&&(0,jsx_runtime.jsx)(Tours_Tour2dVirtual,{}),!matrix&&(0,jsx_runtime.jsx)(Tooltip.A,{title:"Preview Effect",children:(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>{calibrationMode(null==virtual?void 0:virtual.id,calib?"off":"on"),!calib&&virtual.segments[activeSegment]&&highlightSegment(virtual.id,virtual.segments[activeSegment][0],virtual.segments[activeSegment][1],virtual.segments[activeSegment][2],virtual.segments[activeSegment][3]),setCalib(!calib)},children:calib?(0,jsx_runtime.jsx)(Visibility.A,{}):(0,jsx_runtime.jsx)(VisibilityOff.A,{})})})]})}),matrix?(0,jsx_runtime.jsx)(M,{virtual}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:classes.segmentTitle,children:(0,jsx_runtime.jsx)(Typography.A,{variant:"caption",children:"Segments-Settings"})}),(null===(_virtual$segments=virtual.segments)||void 0===_virtual$segments?void 0:_virtual$segments.length)>0&&virtual.segments.map(((s,i)=>(0,jsx_runtime.jsx)(EditVirtuals_Segment,{s,i,virtual,segments:virtual.segments,calib},i))),(0,jsx_runtime.jsxs)("div",{className:classes.segmentButtonWrapper,children:[(0,jsx_runtime.jsx)(ConfirmationDialog,{virtual}),(0,jsx_runtime.jsx)(Dialogs_AddExistingSegmentDialog,{virtual})]})]})]})]}):null}EditVirtuals.__docgenInfo={description:"",methods:[],displayName:"EditVirtuals",props:{icon:{defaultValue:{value:"<Settings />",computed:!1},required:!1},label:{defaultValue:{value:"''",computed:!1},required:!1},color:{defaultValue:{value:"'inherit'",computed:!1},required:!1},variant:{defaultValue:{value:"'contained'",computed:!1},required:!1},onClick:{defaultValue:{value:"() => {}",computed:!1},required:!1}}};const DeviceCard_styles=(0,makeStyles.A)((()=>({virtualCardPortraitW:{margin:"0.5rem",display:"flex",alignItems:"flex-start",flexDirection:"column",minWidth:"230px",maxWidth:"400px",width:"100%",height:"100%",position:"relative",borderRadius:10,borderColor:"transparent",textDecoration:"none","@media (max-width: 410px)":{margin:"0.25rem 0"}},virtualCardPortrait:{padding:"0rem 0.6rem 0.2rem 0.6rem",display:"flex",alignItems:"flex-start",flexDirection:"column",minWidth:"230px",maxWidth:"400px",width:"100%",height:"100%",position:"relative",borderRadius:10,borderColor:"transparent"},virtualIconWrapper:{width:"50px",height:"55px",marginRight:"0.5rem"},virtualIcon:{marginBottom:"4px",marginRight:"0.5rem",fontSize:"50px",position:"absolute",transformOrigin:"top left","&.graphs":{transformOrigin:"center left"},transition:"transform 0.3s ease-in-out",transitionDelay:"0s","&.extended":{transform:"scale(1.7) translateY(-4px);",transformOrigin:"top left",transition:"transform 0.3s ease-in-out",transitionDelay:"0s"},"&.extended.graphs":{transform:"scale(1.25)",transformOrigin:"center left",transition:"transform 0.3s ease-in-out",transitionDelay:"0s"},"& svg":{transform:"unset",width:"100%",marginTop:"3px",height:"100%"}},virtualCardContainer:{display:"flex",alignItems:"center",width:"100%",height:"100%",minHeight:"73px",padding:"0 0.3rem",justifyContent:"space-between",flexDirection:"row","@media (max-width: 470px)":{paddingRight:"0"}},virtualSubline:{padding:"0 0.5rem"},iconMedia:{height:140,display:"flex",alignItems:"center",margin:"0 auto",fontSize:100,"& > span:before":{position:"relative"}},editButton:{minWidth:"unset"},editButtonMobile:{minWidth:"unset",flexGrow:1},buttonBarMobile:{width:"100%",height:"100%",textAlign:"right"},buttonBarMobileWrapper:{height:"100%",display:"flex",margin:0,padding:"0.5rem 80px 0.5rem 0.5rem",background:"rgba(0,0,0,0.93)",color:"#fff","& > div, & > button":{flexGrow:1,flexBasis:"30%"},"&.extended.graphs":{height:"100%",paddingTop:0,"& button":{fontSize:"smaller"}}},pixelbar:{opacity:1,transitionDuration:"0s",width:"100%"},pixelbarOut:{opacity:.2,transition:"opacity",transitionDuration:"1s"}}))),DeviceCard=_ref=>{let{graphsMulti,activateDevice,deviceName="My Wled",online=!0,effectName,virtId="yz-quad",index=1,handleDeleteDevice=()=>console.log("DELETING DEVICE"),handleEditVirtual=()=>console.log("EDITING VIRTUAL"),handleEditDevice=()=>console.log("EDITING DEVICE"),handleClearEffect=()=>console.log("CLEARING EFFECT"),handlePlayPause=()=>console.log("PLAY/PAUSE"),handlePlayLast=()=>console.log("PLAY LAST"),linkTo="/",additionalStyle={},iconName="wled",colorIndicator=!0,isPlaying=!0,isStreaming=!1,previewOnly=!0,dummy=!1,isEffectSet=!0,transitionTime=5,isDevice="yz-quad",graphsActive=!0,showMatrix=!1,onContextMenu,lastEffect}=_ref;const classes=DeviceCard_styles(),theme=(0,useTheme.A)(),[fade,_setFade]=(0,react.useState)(!1),[isActive,setIsActive]=(0,react.useState)(isEffectSet||isStreaming),[loading,setLoading]=(0,react.useState)(!1),[expanded,setExpanded]=(0,react.useState)(!1),virtuals=(0,useStore.A)((state=>state.virtuals)),handleExpandClick=()=>{setExpanded(!expanded)};return(0,react.useEffect)((()=>{setIsActive(isEffectSet||isStreaming)}),[isEffectSet,isStreaming]),(0,jsx_runtime.jsx)(chunk_NL6KNZEE.k2,{onContextMenu,to:linkTo,className:"".concat(classes.virtualCardPortraitW," ").concat(isEffectSet?"active":""," ").concat(online?"online":"offline"),style:(0,objectSpread2.A)((0,objectSpread2.A)({},additionalStyle),{},{width:"100%",background:theme.palette.background.paper}),children:(0,jsx_runtime.jsxs)(Card.A,{className:classes.virtualCardPortrait,sx:{background:theme.palette.background.paper,"&:hover":{borderColor:theme.palette.text.disabled}},children:[(0,jsx_runtime.jsxs)("div",{className:classes.virtualCardContainer,children:[(0,jsx_runtime.jsx)("div",{className:classes.virtualIconWrapper,children:(0,jsx_runtime.jsx)(BladeIcon.A,{colorIndicator:!1,name:iconName,className:"".concat(classes.virtualIcon," ").concat(graphsActive?"":"graphs"," ").concat(expanded?"extended":""),style:{zIndex:3,opacity:online?1:.3,color:expanded?"#fff":""},card:!0})}),(0,jsx_runtime.jsxs)("div",{className:classes.virtualSubline,children:[(0,jsx_runtime.jsx)(Typography.A,{variant:"h6",style:{lineHeight:1,color:colorIndicator?theme.palette.primary.light:"inherit",opacity:online?1:.3},children:deviceName}),online?effectName?(0,jsx_runtime.jsxs)(Typography.A,{component:"div",variant:"body1",color:"textSecondary",style:{height:25,display:"flex",alignItems:"center"},children:[effectName,(0,jsx_runtime.jsx)(Button.A,{variant:"text",size:"small",onClick:e=>{e.preventDefault(),handlePlayPause()},style:{color:"#999",minWidth:"unset",zIndex:expanded?1:3},children:isPlaying?(0,jsx_runtime.jsx)(Pause.A,{}):(0,jsx_runtime.jsx)(PlayArrow.A,{})}),(0,jsx_runtime.jsxs)(Box.A,{sx:{m:1,position:"relative"},children:[(0,jsx_runtime.jsx)(Button.A,{size:"small",variant:"text",disabled:loading,onClick:e=>{e.preventDefault(),handleClearEffect(virtId),setLoading(!0),setTimeout((()=>{setLoading(!1)}),1e3*(virtuals[virtId].config.transition_time||0))},style:{color:"#999",minWidth:"unset",zIndex:expanded?1:3},children:(0,jsx_runtime.jsx)(Stop.A,{})}),loading&&(0,jsx_runtime.jsx)(CircularProgress.A,{size:24,sx:{position:"absolute",top:"50%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]})]}):isStreaming?(0,jsx_runtime.jsx)(Typography.A,{variant:"body1",color:"textSecondary",style:{height:25},children:"Streaming..."}):(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:1,alignItems:"center",children:[(0,jsx_runtime.jsx)(Typography.A,{variant:"body1",style:{color:theme.palette.text.disabled,height:25},children:"off"}),lastEffect&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Typography.A,{variant:"body1",style:{color:theme.palette.text.disabled,height:25},children:" | "}),(0,jsx_runtime.jsx)(Typography.A,{variant:"body1",style:{color:theme.palette.text.disabled,height:25,paddingTop:1},children:lastEffect}),(0,jsx_runtime.jsx)(Button.A,{variant:"text",style:{color:"#999",minWidth:"unset",zIndex:expanded?1:3,padding:0},size:"small",onClick:e=>{e.preventDefault(),e.stopPropagation(),handlePlayLast()},children:(0,jsx_runtime.jsx)(PlayArrow.A,{})})]})]}):(0,jsx_runtime.jsxs)(Typography.A,{variant:"body1",color:"textSecondary",style:{height:25,display:"flex",alignItems:"center"},children:[(0,jsx_runtime.jsx)(Typography.A,{variant:"body1",component:"span",color:"textSecondary",style:{height:25,opacity:online?1:.3},children:"offline"}),(0,jsx_runtime.jsx)(Button.A,{variant:"text",size:"small",onClick:e=>{e.preventDefault(),isDevice&&activateDevice(isDevice)},style:{color:"inherit",marginLeft:"1rem",marginTop:"0rem",minWidth:"unset",zIndex:expanded?1:3},children:(0,jsx_runtime.jsx)(SyncProblem.A,{})})]})]}),(0,jsx_runtime.jsxs)("div",{children:[previewOnly&&(0,jsx_runtime.jsx)(Button.A,{variant:"text",disabled:!0,size:"small",children:(0,jsx_runtime.jsx)(Visibility.A,{})}),dummy&&(0,jsx_runtime.jsx)(Button.A,{variant:"text",disabled:!0,size:"small",children:(0,jsx_runtime.jsx)(PestControl.A,{})})]}),"activated"!==window.localStorage.getItem("guestmode")?(0,jsx_runtime.jsx)(IconButton.A,{sx:[{alignSelf:"flex-start",marginLeft:"auto",transition:theme.transitions.create("transform",{duration:theme.transitions.duration.shortest}),display:"flex"},expanded?{transform:"rotate(180deg)"}:{transform:"rotate(0deg)"}],onClick:e=>{e.preventDefault(),handleExpandClick()},"aria-expanded":expanded,"aria-label":"show more",style:{zIndex:3,color:"#999"},children:(0,jsx_runtime.jsx)(ExpandMore.A,{className:"step-devices-two-".concat(index)})}):(0,jsx_runtime.jsx)(Box.A,{sx:{alignSelf:"flex-start",marginLeft:"auto",display:"block"}})]}),graphsMulti&&(0,jsx_runtime.jsx)("div",{style:{opacity:fade?.2:1,transitionDuration:"".concat(fade?transitionTime||1:transitionTime||0,"s"),width:"100%",transition:"opacity"},children:(0,jsx_runtime.jsx)(PixelGraph_PixelGraph,{showMatrix,intGraphs:graphsActive,active:isActive,virtId:virtId||"",className:"step-devices-seven"})}),(0,jsx_runtime.jsx)("div",{style:{position:"absolute",left:0,top:0,bottom:0,right:0,zIndex:2},children:(0,jsx_runtime.jsx)(Collapse.A,{in:expanded,timeout:"auto",unmountOnExit:!0,className:classes.buttonBarMobile,sx:{height:"100% !important","& .MuiCollapse-wrapper":{height:"100%"}},children:(0,jsx_runtime.jsxs)("div",{className:"".concat(classes.buttonBarMobileWrapper," ").concat(graphsActive?"":"graphs"," ").concat(expanded?"extended":""),onClick:e=>e.preventDefault(),children:[(0,jsx_runtime.jsx)("div",{}),(0,jsx_runtime.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"center"},children:[(0,jsx_runtime.jsx)(Popover.A,{variant:"text",startIcon:(0,jsx_runtime.jsx)(Delete.A,{}),label:"delete",color:"inherit",onConfirm:()=>{handleDeleteDevice(virtId),handleExpandClick()},className:"step-devices-three-".concat(index),style:{width:"100%"}}),isDevice?(0,jsx_runtime.jsx)(Button.A,{variant:"text",color:"inherit",size:"small",startIcon:(0,jsx_runtime.jsx)(Build.A,{}),className:"step-devices-four-".concat(index),onClick:e=>{e.preventDefault(),handleEditDevice(isDevice),handleExpandClick()},sx:theme=>(0,objectSpread2.A)({color:"#fff",bgcolor:"transparent","&:hover":(0,objectSpread2.A)({color:"#000",bgcolor:theme.palette.primary.main},theme.applyStyles("light",{color:"#fff"}))},theme.applyStyles("light",{color:"#000"})),children:"Edit Device"}):(0,jsx_runtime.jsx)(EditVirtuals,{label:"Edit Virtual",variant:"text",color:"inherit",virtId,icon:void 0,className:"step-devices-six",startIcon:(0,jsx_runtime.jsx)(Tune.A,{}),type:void 0,innerKey:void 0,onClick:()=>handleExpandClick(),sx:theme=>(0,objectSpread2.A)({color:"#fff",bgcolor:"transparent","&:hover":(0,objectSpread2.A)({color:"#000",bgcolor:theme.palette.primary.main},theme.applyStyles("light",{color:"#fff"}))},theme.applyStyles("light",{color:"#000"}))}),(0,jsx_runtime.jsx)(Button.A,{variant:"text",size:"small",startIcon:(0,jsx_runtime.jsx)(Settings.A,{}),color:"inherit",className:"step-devices-five-".concat(index),onClick:e=>{e.preventDefault(),handleEditVirtual(virtId),handleExpandClick()},sx:theme=>(0,objectSpread2.A)({color:"#fff",bgcolor:"transparent","&:hover":(0,objectSpread2.A)({color:"#000",bgcolor:theme.palette.primary.main},theme.applyStyles("light",{color:"#fff"}))},theme.applyStyles("light",{color:"#000"})),children:"Settings"})]})]})})})]})})},DeviceCard_DeviceCard=DeviceCard;DeviceCard.__docgenInfo={description:"Pixelgraphs will not connect via Websocket in Storybook",methods:[],displayName:"DeviceCard",props:{deviceName:{required:!1,tsType:{name:"string"},description:"The Name of the device",defaultValue:{value:"'My Wled'",computed:!1}},iconName:{required:!1,tsType:{name:"string"},description:"IconName. Refer to `Icon`",defaultValue:{value:"'wled'",computed:!1}},effectName:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"Name of the current Effect",defaultValue:{value:"undefined",computed:!0}},isEffectSet:{required:!1,tsType:{name:"boolean"},description:"Flag if Effect is set",defaultValue:{value:"true",computed:!1}},online:{required:!1,tsType:{name:"boolean"},description:"Is device online",defaultValue:{value:"true",computed:!1}},isPlaying:{required:!1,tsType:{name:"boolean"},description:"Play/Pause",defaultValue:{value:"true",computed:!1}},isStreaming:{required:!1,tsType:{name:"boolean"},description:"Is streaming from other sources",defaultValue:{value:"false",computed:!1}},previewOnly:{required:!1,tsType:{name:"boolean"},description:"Do not send to leds",defaultValue:{value:"true",computed:!1}},dummy:{required:!1,tsType:{name:"boolean"},description:"Dummy Device",defaultValue:{value:"false",computed:!1}},transitionTime:{required:!1,tsType:{name:"number"},description:"TransitionTime of the Device",defaultValue:{value:"5",computed:!1}},isDevice:{required:!1,tsType:{name:"union",raw:"string | boolean | undefined",elements:[{name:"string"},{name:"boolean"},{name:"undefined"}]},description:"DeviceId if its a device, else undefined if its a virtual",defaultValue:{value:"'yz-quad'",computed:!1}},graphsActive:{required:!1,tsType:{name:"boolean"},description:"Graphs active?",defaultValue:{value:"true",computed:!1}},graphsMulti:{required:!1,tsType:{name:"boolean"},description:"Do not send to leds"},showMatrix:{required:!1,tsType:{name:"boolean"},description:"Show Matrix",defaultValue:{value:"false",computed:!1}},colorIndicator:{required:!1,tsType:{name:"boolean"},description:"Colorize?",defaultValue:{value:"true",computed:!1}},virtId:{required:!1,tsType:{name:"string"},description:"VirtualId",defaultValue:{value:"'yz-quad'",computed:!1}},index:{required:!1,tsType:{name:"number"},description:"Index",defaultValue:{value:"1",computed:!1}},handleDeleteDevice:{required:!1,tsType:{name:"any"},description:"Handle Function",defaultValue:{value:"() => console.log('DELETING DEVICE')",computed:!1}},handleEditVirtual:{required:!1,tsType:{name:"any"},description:"Handle Function",defaultValue:{value:"() => console.log('EDITING VIRTUAL')",computed:!1}},handleEditDevice:{required:!1,tsType:{name:"any"},description:"Handle Function",defaultValue:{value:"() => console.log('EDITING DEVICE')",computed:!1}},handleClearEffect:{required:!1,tsType:{name:"any"},description:"Handle Function",defaultValue:{value:"() => console.log('CLEARING EFFECT')",computed:!1}},handlePlayPause:{required:!1,tsType:{name:"any"},description:"Handle Function",defaultValue:{value:"() => console.log('PLAY/PAUSE')",computed:!1}},handlePlayLast:{required:!1,tsType:{name:"any"},description:"Handle Function",defaultValue:{value:"() => console.log('PLAY LAST')",computed:!1}},activateDevice:{required:!1,tsType:{name:"any"},description:"Handle Function"},linkTo:{required:!1,tsType:{name:"any"},description:"Handle Function",defaultValue:{value:"'/'",computed:!1}},additionalStyle:{required:!1,tsType:{name:"any"},description:"JSX styles",defaultValue:{value:"{}",computed:!1}},onContextMenu:{required:!1,tsType:{name:"any"},description:"On Context Menu"},lastEffect:{required:!1,tsType:{name:"union",raw:"null | string",elements:[{name:"null"},{name:"string"}]},description:"last effect"}}};const DeviceCard_stories={title:"UI Components/DeviceCard",component:DeviceCard_DeviceCard,decorators:[Story=>(0,jsx_runtime.jsx)(chunk_NL6KNZEE.fS,{children:Story()})],parameters:{options:{showPanel:!0}}},Default=(args=>(0,jsx_runtime.jsx)(DeviceCard_DeviceCard,(0,objectSpread2.A)({},args))).bind({});Default.args={deviceName:"My Wled",iconName:"wled",effectName:"Cool",isEffectSet:!0,isPlaying:!0,previewOnly:!0,colorIndicator:!0,isStreaming:!1,graphsActive:!0,handleDeleteDevice:void 0,handleEditVirtual:void 0,handleEditDevice:void 0,handleClearEffect:void 0,handlePlayPause:void 0,additionalStyle:{},transitionTime:5,virtId:"yz-quad",isDevice:"yz-quad",linkTo:"/",index:1};const __namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => <DeviceCard {...args} />",...Default.parameters?.docs?.source}}}}}]);