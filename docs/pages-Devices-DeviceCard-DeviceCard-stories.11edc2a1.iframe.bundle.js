"use strict";(self.webpackChunkledfx=self.webpackChunkledfx||[]).push([[5],{"./src/pages/Devices/DeviceCard/DeviceCard.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>DeviceCard_stories});var dist=__webpack_require__("./node_modules/react-router/dist/index.js"),react=__webpack_require__("./node_modules/react/index.js"),useTheme=__webpack_require__("./node_modules/@mui/material/styles/useTheme.js"),Card=__webpack_require__("./node_modules/@mui/material/Card/Card.js"),Button=__webpack_require__("./node_modules/@mui/material/Button/Button.js"),Settings=__webpack_require__("./node_modules/@mui/icons-material/Settings.js"),Visibility=__webpack_require__("./node_modules/@mui/icons-material/Visibility.js"),Tune=__webpack_require__("./node_modules/@mui/icons-material/Tune.js"),Build=__webpack_require__("./node_modules/@mui/icons-material/Build.js"),react_router_dom_dist=__webpack_require__("./node_modules/react-router-dom/dist/index.js"),Collapse=__webpack_require__("./node_modules/@mui/material/Collapse/Collapse.js"),ExpandMore=__webpack_require__("./node_modules/@mui/icons-material/ExpandMore.js"),IconButton=__webpack_require__("./node_modules/@mui/material/IconButton/IconButton.js"),Typography=__webpack_require__("./node_modules/@mui/material/Typography/Typography.js"),SyncProblem=__webpack_require__("./node_modules/@mui/icons-material/esm/SyncProblem.js"),Pause=__webpack_require__("./node_modules/@mui/icons-material/esm/Pause.js"),PlayArrow=__webpack_require__("./node_modules/@mui/icons-material/esm/PlayArrow.js"),Clear=__webpack_require__("./node_modules/@mui/icons-material/esm/Clear.js"),PestControl=__webpack_require__("./node_modules/@mui/icons-material/esm/PestControl.js"),Delete=__webpack_require__("./node_modules/@mui/icons-material/esm/Delete.js"),Box=__webpack_require__("./node_modules/@mui/material/Box/Box.js"),Popover=__webpack_require__("./src/components/Popover/Popover.tsx"),Dialog=__webpack_require__("./node_modules/@mui/material/Dialog/Dialog.js"),AppBar=__webpack_require__("./node_modules/@mui/material/AppBar/AppBar.js"),Toolbar=__webpack_require__("./node_modules/@mui/material/Toolbar/Toolbar.js"),NavigateBefore=__webpack_require__("./node_modules/@mui/icons-material/NavigateBefore.js"),Slide=__webpack_require__("./node_modules/@mui/material/Slide/Slide.js"),MenuItem=__webpack_require__("./node_modules/@mui/material/MenuItem/MenuItem.js"),ListItemIcon=__webpack_require__("./node_modules/@mui/material/ListItemIcon/ListItemIcon.js"),ToggleButtonGroup=__webpack_require__("./node_modules/@mui/material/ToggleButtonGroup/ToggleButtonGroup.js"),ToggleButton=__webpack_require__("./node_modules/@mui/material/ToggleButton/ToggleButton.js"),Tooltip=__webpack_require__("./node_modules/@mui/material/Tooltip/Tooltip.js"),esm_Settings=__webpack_require__("./node_modules/@mui/icons-material/esm/Settings.js"),GridOn=__webpack_require__("./node_modules/@mui/icons-material/esm/GridOn.js"),esm_Visibility=__webpack_require__("./node_modules/@mui/icons-material/esm/Visibility.js"),VisibilityOff=__webpack_require__("./node_modules/@mui/icons-material/esm/VisibilityOff.js"),helpers=__webpack_require__("./src/utils/helpers.ts"),useStore=__webpack_require__("./src/store/useStore.ts"),styled=__webpack_require__("./node_modules/@mui/material/styles/styled.js"),DialogTitle=__webpack_require__("./node_modules/@mui/material/DialogTitle/DialogTitle.js"),DialogContent=__webpack_require__("./node_modules/@mui/material/DialogContent/DialogContent.js"),Select=__webpack_require__("./node_modules/@mui/material/Select/Select.js"),DialogActions=__webpack_require__("./node_modules/@mui/material/DialogActions/DialogActions.js"),AddCircle=__webpack_require__("./node_modules/@mui/icons-material/AddCircle.js"),BladeFrame=__webpack_require__("./src/components/SchemaForm/components/BladeFrame.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const classes={root:"_AddSegmentDialog-root",paper:"_AddSegmentDialog-paper"},Root=(0,styled.Ay)("div")((_ref=>{let{theme}=_ref;return{[`&.${classes.root}`]:{margin:"1rem auto",backgroundColor:theme.palette.background.paper},[`& .${classes.paper}`]:{width:"80%",maxHeight:435}}}));function ConfirmationDialogRaw(props){const{onClose,value:valueProp,open,...other}=props,[value,setValue]=react.useState(valueProp);return delete other.deviceList,(0,jsx_runtime.jsxs)(Dialog.A,{disableEscapeKeyDown:!0,maxWidth:"xs","aria-labelledby":"confirmation-dialog-title",open,...other,children:[(0,jsx_runtime.jsx)(DialogTitle.A,{id:"confirmation-dialog-title",children:"Select a device"}),(0,jsx_runtime.jsx)(DialogContent.A,{dividers:!0,children:(0,jsx_runtime.jsx)(BladeFrame.A,{full:!0,children:(0,jsx_runtime.jsx)(Select.A,{value,style:{width:"100%"},onChange:event=>{setValue(event.target.value)},children:Object.keys(props.deviceList).map((device=>(0,jsx_runtime.jsx)(MenuItem.A,{value:props.deviceList[device].id,children:props.deviceList[device].config.name},props.deviceList[device].id)))})})}),(0,jsx_runtime.jsxs)(DialogActions.A,{children:[(0,jsx_runtime.jsx)(Button.A,{autoFocus:!0,onClick:()=>{onClose()},color:"primary",children:"Cancel"}),(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{onClose(value)},color:"primary",children:"Ok"})]})]})}function ConfirmationDialog(_ref2){let{virtual,config={}}=_ref2;const[open,setOpen]=react.useState(!1),deviceList=(0,useStore.A)((state=>state.devices))||{},virtuals=(0,useStore.A)((state=>state.virtuals))||{},updateSegments=(0,useStore.A)((state=>state.updateSegments)),getVirtuals=(0,useStore.A)((state=>state.getVirtuals)),highlightSegment=(0,useStore.A)((state=>state.highlightSegment)),setEffect=(0,useStore.A)((state=>state.setEffect));return(0,jsx_runtime.jsx)(Root,{className:classes.root,children:deviceList&&Object.keys(deviceList).length>0?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Button.A,{variant:"contained",color:"primary","aria-label":"Add",endIcon:(0,jsx_runtime.jsx)(AddCircle.A,{}),onClick:()=>{setOpen(!0)},role:"listitem",children:"ADD SEGMENT"}),(0,jsx_runtime.jsx)(ConfirmationDialogRaw,{classes:{paper:classes.paper},config,id:"ringtone-menu",keepMounted:!0,open,onClose:newValue=>{if(setOpen(!1),newValue){const device={...deviceList[Object.keys(deviceList).find((d=>deviceList[d].id===newValue))||0]};if(device&&device.config){const test=[...virtual.segments,[device.id,0,device.config.pixel_count-1,!1]].filter((t=>4===t.length));updateSegments(virtual.id,test).then((()=>{getVirtuals(),!1===virtual.active&&0===virtual.segments.length&&(device.active_virtuals&&device.active_virtuals[0]&&virtuals&&virtuals[device.active_virtuals[0]]&&virtuals[device.active_virtuals[0]].effect?setEffect(virtual.id,virtuals[device.active_virtuals[0]].effect.type,virtuals[device.active_virtuals[0]].effect.config,!0):setEffect(virtual.id,"rainbow",{},!0)),highlightSegment(virtual.id,device.id,0,device.config.pixel_count-1,!1)}))}}},value:"",deviceList})]}):null})}try{AddSegmentDialog.displayName="AddSegmentDialog",AddSegmentDialog.__docgenInfo={description:"",displayName:"AddSegmentDialog",props:{virtual:{defaultValue:null,description:"",name:"virtual",required:!0,type:{name:"any"}},config:{defaultValue:{value:"{}"},description:"",name:"config",required:!1,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Dialogs/_AddSegmentDialog.tsx#AddSegmentDialog"]={docgenInfo:AddSegmentDialog.__docgenInfo,name:"AddSegmentDialog",path:"src/components/Dialogs/_AddSegmentDialog.tsx#AddSegmentDialog"})}catch(__react_docgen_typescript_loader_error){}var Stack=__webpack_require__("./node_modules/@mui/material/Stack/Stack.js"),ExpandLess=__webpack_require__("./node_modules/@mui/icons-material/esm/ExpandLess.js"),esm_ExpandMore=__webpack_require__("./node_modules/@mui/icons-material/esm/ExpandMore.js"),SwapHoriz=__webpack_require__("./node_modules/@mui/icons-material/esm/SwapHoriz.js"),index_module=__webpack_require__("./node_modules/use-debounce/dist/index.module.js"),Slider=__webpack_require__("./node_modules/@mui/material/Slider/Slider.js"),TextField=__webpack_require__("./node_modules/@mui/material/TextField/TextField.js");const PixelSlider=_ref=>{let{s,handleRangeSegment}=_ref;const devices=(0,useStore.A)((state=>state.devices)),[range,setRange]=(0,react.useState)([s[1],s[2]]),throttled=(0,index_module.dh)(((_event,newValue)=>{newValue!==pixelRange&&handleRangeSegment(newValue[0],newValue[1])}),100);if((0,react.useEffect)((()=>{setRange([s[1],s[2]])}),[s]),!devices[s[0]])return null;const pixelRange=[s[1],s[2]],marks=[{value:0,label:1},{value:devices[s[0]].config.pixel_count-1,label:devices[s[0]].config.pixel_count}];return(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:5,alignItems:"flex-start",flexBasis:"100%",children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:1,alignItems:"flex-start",alignSelf:"flex-end",children:[(0,jsx_runtime.jsx)(TextField.A,{size:"small",type:"number",sx:{minWidth:"80px"},InputProps:{inputProps:{style:{padding:"4.5px 14px"},min:1,max:devices[s[0]].config.pixel_count}},value:range[0]+1,onChange:e=>{if(!(parseInt(e.target.value,10)>range[1]+1)){if(parseInt(e.target.value,10)<1)return setRange([0,range[1]]),void throttled(e,[0,range[1]]);setRange([parseInt(e.target.value,10)-1,range[1]]),throttled(e,[parseInt(e.target.value,10)-1,range[1]])}}}),(0,jsx_runtime.jsx)(TextField.A,{size:"small",type:"number",sx:{minWidth:"80px"},InputProps:{inputProps:{style:{padding:"4.5px 14px"},min:range[0]+1,max:devices[s[0]].config.pixel_count}},value:range[1]+1,onChange:e=>""===e.target.value||parseInt(e.target.value,10)<range[0]+1?(setRange([range[0],range[0]+1]),void throttled(e,[range[0],range[0]+1])):parseInt(e.target.value,10)>devices[s[0]].config.pixel_count?(setRange([range[0],devices[s[0]].config.pixel_count-1]),void throttled(e,[range[0],devices[s[0]].config.pixel_count-1])):(setRange([range[0],parseInt(e.target.value,10)-1]),void throttled(e,[range[0],parseInt(e.target.value,10)-1]))})]}),(0,jsx_runtime.jsx)(Slider.Ay,{sx:{alignSelf:"center"},value:range,marks,valueLabelFormat:e=>e+1,min:0,max:devices[s[0]].config.pixel_count-1,onChange:(_event,n)=>{setRange(n),throttled(_event,n)},"aria-labelledby":"range-slider",valueLabelDisplay:"auto"})]})},EditVirtuals_PixelSlider=PixelSlider;try{PixelSlider.displayName="PixelSlider",PixelSlider.__docgenInfo={description:"",displayName:"PixelSlider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/PixelSlider.tsx#PixelSlider"]={docgenInfo:PixelSlider.__docgenInfo,name:"PixelSlider",path:"src/pages/Devices/EditVirtuals/PixelSlider.tsx#PixelSlider"})}catch(__react_docgen_typescript_loader_error){}var makeStyles=__webpack_require__("./node_modules/@mui/styles/makeStyles/makeStyles.js");const Segment_styles=(0,makeStyles.A)((()=>({segmentsWrapper:{display:"flex",borderBottom:"1px dashed #aaa",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0"},segmentsColOrder:{display:"flex",justifyContent:"space-between",alignItems:"center"},segmentsButtonUp:{borderTopRightRadius:0,borderBottomRightRadius:0,minWidth:"50px"},segmentsButtonDown:{borderTopLeftRadius:0,borderBottomLeftRadius:0,minWidth:"50px",marginRight:"1rem"},segmentsColPixelSlider:{flex:"0 1 70%"},segmentsColActions:{display:"flex",justifyContent:"space-between",alignItems:"center"},"@media (max-width: 600px)":{segmentsColPixelSlider:{order:3,width:"calc(100% - 2rem)",margin:"2rem auto 0 auto"},segmentsWrapper:{flexDirection:"column",alignItems:"flex-start"},segmentsColActions:{position:"absolute",right:"1rem"}}}))),Segment=_ref=>{let{s,i,virtual,segments,calib}=_ref;const devices=(0,useStore.A)((state=>state.devices)),title=devices&&devices[devices&&Object.keys(devices).find((d=>d===s[0]))].config.name,classes=Segment_styles(),updateSegments=(0,useStore.A)((state=>state.updateSegments)),highlightSegment=(0,useStore.A)((state=>state.highlightSegment)),highlightOffSegment=(0,useStore.A)((state=>state.highlightOffSegment)),getVirtuals=(0,useStore.A)((state=>state.getVirtuals)),activeSegment=(0,useStore.A)((state=>state.activeSegment)),setActiveSegment=(0,useStore.A)((state=>state.setActiveSegment)),reorder=direction=>{const newSegments="UP"===direction?(0,helpers.wg)(segments,i-1,i):(0,helpers.wg)(segments,i,i+1);updateSegments(virtual.id,newSegments).then((()=>{getVirtuals(),calib&&(highlightSegment(virtual.id,newSegments["UP"===direction?i-1:i+1][0],newSegments["UP"===direction?i-1:i+1][1],newSegments["UP"===direction?i-1:i+1][2],newSegments["UP"===direction?i-1:i+1][3]),setActiveSegment("UP"===direction?i-1:i+1))}))};return(0,jsx_runtime.jsx)("div",{style:{padding:"0 1rem",background:calib&&i===activeSegment?"#ffffff18":""},children:(0,jsx_runtime.jsxs)("div",{className:classes.segmentsWrapper,children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",spacing:1,alignItems:"flex-start",children:[(0,jsx_runtime.jsx)(Typography.A,{color:"textSecondary",marginTop:1,marginBottom:-1,children:title}),(0,jsx_runtime.jsx)("div",{className:classes.segmentsColOrder,children:(0,jsx_runtime.jsxs)("div",{style:{display:"flex"},children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(Button.A,{disabled:0===i,color:"inherit",onClick:()=>reorder("UP"),size:"small",className:classes.segmentsButtonUp,children:(0,jsx_runtime.jsx)(ExpandLess.A,{})})}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(Button.A,{disabled:i===virtual.segments.length-1,color:"inherit",onClick:()=>reorder("DOWN"),size:"small",className:classes.segmentsButtonDown,children:(0,jsx_runtime.jsx)(esm_ExpandMore.A,{})})})]})})]}),(0,jsx_runtime.jsx)("div",{className:classes.segmentsColPixelSlider,style:{alignSelf:"stretch",display:"flex",flexDirection:"column"},children:(0,jsx_runtime.jsx)(EditVirtuals_PixelSlider,{s,handleRangeSegment:(start,end)=>{const newSegments=segments.map(((seg,index)=>index===i?[seg[0],start,end,seg[3]]:seg));updateSegments(virtual.id,newSegments).then((()=>{getVirtuals(),calib&&(highlightSegment(virtual.id,newSegments[i][0],newSegments[i][1],newSegments[i][2],newSegments[i][3]),setActiveSegment(i))}))}})}),(0,jsx_runtime.jsxs)("div",{className:classes.segmentsColActions,children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(Button.A,{variant:s[3]?"contained":"outlined",color:s[3]?"primary":"inherit",endIcon:(0,jsx_runtime.jsx)(SwapHoriz.A,{}),onClick:()=>{const newSegments=segments.map(((seg,index)=>index===i?[seg[0],seg[1],seg[2],!seg[3]]:seg));updateSegments(virtual.id,newSegments).then((()=>{getVirtuals(),calib&&(highlightSegment(virtual.id,newSegments[i][0],newSegments[i][1],newSegments[i][2],newSegments[i][3]),setActiveSegment(i))}))},style:{margin:"0 1rem 0 1.5rem"},children:"Flip"})}),(0,jsx_runtime.jsx)(Popover.A,{variant:"outlined",color:"primary",onConfirm:()=>{const newSegments=segments.filter(((_seg,index)=>index!==i));updateSegments(virtual.id,newSegments).then((()=>{getVirtuals(),calib&&(highlightOffSegment(virtual.id),setActiveSegment(-1))}))},style:{padding:"5px"}})]})]})})},EditVirtuals_Segment=Segment;try{Segment.displayName="Segment",Segment.__docgenInfo={description:"",displayName:"Segment",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/Segment.tsx#Segment"]={docgenInfo:Segment.__docgenInfo,name:"Segment",path:"src/pages/Devices/EditVirtuals/Segment.tsx#Segment"})}catch(__react_docgen_typescript_loader_error){}const EditVirtuals_styles=(0,makeStyles.A)((()=>({appBar:{position:"relative"},title:{flex:1},dialog:{},segmentTitle:{display:"flex",borderBottom:"1px dashed #aaa",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0",margin:"0 1rem"},segmentButtonWrapper:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0",margin:"0 1rem"},cloudEffectCard:{cursor:"pointer",width:280}})));var index_esm=__webpack_require__("./node_modules/react-zoom-pan-pinch/dist/index.esm.js"),core_esm=__webpack_require__("./node_modules/@dnd-kit/core/dist/core.esm.js"),modifiers_esm=__webpack_require__("./node_modules/@dnd-kit/modifiers/dist/modifiers.esm.js");const MCell={deviceId:"",pixel:0,group:"0-0"},getMaxRange=(direction,row,col,rowN,colN)=>{let maxRange=0;return direction.includes("right")?(maxRange=colN*rowN-(row*colN+col),direction.includes("flip")&&(maxRange=row*colN+colN-col)):direction.includes("left")?(maxRange=row*colN+col+1,direction.includes("flip")&&(maxRange=(rowN-row-1)*colN+col+1)):direction.includes("bottom")?(maxRange=colN*rowN-(rowN*col+(rowN-row-1)),direction.includes("flip")&&(maxRange=rowN*col+(rowN-row))):direction.includes("top")&&(maxRange=rowN*col+row+1,direction.includes("flip")&&(maxRange=colN*rowN-(rowN*col+(rowN-row-1)))),maxRange},clone=input=>JSON.parse(JSON.stringify(input));try{getMaxRange.displayName="getMaxRange",getMaxRange.__docgenInfo={description:"Calculates the maximum available pixel given the input data",displayName:"getMaxRange",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/EditMatrix/M.utils.tsx#getMaxRange"]={docgenInfo:getMaxRange.__docgenInfo,name:"getMaxRange",path:"src/pages/Devices/EditVirtuals/EditMatrix/M.utils.tsx#getMaxRange"})}catch(__react_docgen_typescript_loader_error){}try{clone.displayName="clone",clone.__docgenInfo={description:"deep clone",displayName:"clone",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/EditMatrix/M.utils.tsx#clone"]={docgenInfo:clone.__docgenInfo,name:"clone",path:"src/pages/Devices/EditVirtuals/EditMatrix/M.utils.tsx#clone"})}catch(__react_docgen_typescript_loader_error){}const M_styles=(0,makeStyles.A)((()=>({gridCell:{cursor:"copy",border:"1px solid #666",width:100,height:100,"&:hover":{}},gridCellContainer:{background:"#111",display:"flex",justifyContent:"center",alignItems:"center"},gridCellInner:{display:"flex",flexWrap:"wrap",height:"100%",width:"100%"},pixel:{display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center",height:"98px",background:"transparent",width:"98px",border:"5px solid #111",boxSizing:"border-box",padding:"8px",borderRadius:"10px"},centered:{display:"flex",width:"100%",justifyContent:"space-between"}}))),MWrapper=_ref=>{let{children,move}=_ref;return(0,jsx_runtime.jsx)(Box.A,{sx:{display:"flex",justifyContent:"flex-start",alignItems:"flex-start",flexDirection:"landscape"===window.screen.orientation.type.split("-")[0]?"row":"column",maxHeight:"calc(100vh - 64px)","& .react-transform-wrapper":{overflow:move?"auto":"hidden"}},children})},EditMatrix_MWrapper=MWrapper;try{MWrapper.displayName="MWrapper",MWrapper.__docgenInfo={description:"",displayName:"MWrapper",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/EditMatrix/MWrapper.tsx#MWrapper"]={docgenInfo:MWrapper.__docgenInfo,name:"MWrapper",path:"src/pages/Devices/EditVirtuals/EditMatrix/MWrapper.tsx#MWrapper"})}catch(__react_docgen_typescript_loader_error){}var Rotate90DegreesCw=__webpack_require__("./node_modules/@mui/icons-material/esm/Rotate90DegreesCw.js"),SwapVert=__webpack_require__("./node_modules/@mui/icons-material/esm/SwapVert.js"),Stop=__webpack_require__("./node_modules/@mui/icons-material/esm/Stop.js"),Loop=__webpack_require__("./node_modules/@mui/icons-material/esm/Loop.js"),Save=__webpack_require__("./node_modules/@mui/icons-material/esm/Save.js"),PanTool=__webpack_require__("./node_modules/@mui/icons-material/esm/PanTool.js"),ControlCamera=__webpack_require__("./node_modules/@mui/icons-material/esm/ControlCamera.js"),ArrowUpward=__webpack_require__("./node_modules/@mui/icons-material/esm/ArrowUpward.js"),ArrowBack=__webpack_require__("./node_modules/@mui/icons-material/esm/ArrowBack.js"),Cancel=__webpack_require__("./node_modules/@mui/icons-material/esm/Cancel.js"),ArrowForward=__webpack_require__("./node_modules/@mui/icons-material/esm/ArrowForward.js"),ArrowDownward=__webpack_require__("./node_modules/@mui/icons-material/esm/ArrowDownward.js"),EmergencyRecording=__webpack_require__("./node_modules/@mui/icons-material/esm/EmergencyRecording.js"),Alert=__webpack_require__("./node_modules/@mui/material/Alert/Alert.js"),Tab=__webpack_require__("./node_modules/@mui/material/Tab/Tab.js"),TabContext=__webpack_require__("./node_modules/@mui/lab/TabContext/TabContext.js"),TabList=__webpack_require__("./node_modules/@mui/lab/TabList/TabList.js"),TabPanel=__webpack_require__("./node_modules/@mui/lab/TabPanel/TabPanel.js"),ledfx=__webpack_require__("./src/api/ledfx.ts");function processArray(inputArray){let gapname=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const outputArray=[];let startPixel=null,endPixel=null,deviceId="",flip=!1,gapStart=null;for(let i=0;i<inputArray.length;i+=1)""!==inputArray[i].deviceId?""===deviceId?(null!==gapStart&&(outputArray.push([`gap-${gapname}`,gapStart,i-1,!1]),gapStart=null),deviceId=inputArray[i].deviceId,startPixel=inputArray[i].pixel,endPixel=inputArray[i].pixel,flip=!1):inputArray[i].deviceId===deviceId&&1===Math.abs(inputArray[i].pixel-endPixel)?(endPixel=inputArray[i].pixel,flip=inputArray[i].pixel<endPixel):(outputArray.push([deviceId,startPixel,endPixel,flip]),deviceId=inputArray[i].deviceId,startPixel=inputArray[i].pixel,endPixel=inputArray[i].pixel,flip=!1):(""!==deviceId&&(outputArray.push([deviceId,startPixel,endPixel,flip]),deviceId=""),null===gapStart&&(gapStart=i));""!==deviceId&&outputArray.push([deviceId,startPixel,endPixel,flip]),null!==gapStart&&outputArray.push([`gap-${gapname}`,gapStart,inputArray.length-1,!1]);for(let i=0;i<outputArray.length;i++){const item=outputArray[i];item[1]>item[2]&&(item[3]=item[1]>item[2],[item[1],item[2]]=[item[2],item[1]])}return outputArray}const Actions_moveSelectedGroupUp=_ref=>{let{m,rowN,colN,selectedGroup,setError,setM}=_ref;const updatedM=clone(m),conflictingCells=[];for(let i=0;i<rowN;i++)for(let j=0;j<colN;j+=1)if(m[i][j].group===selectedGroup){const targetRow=i-1;targetRow>=0&&(""!==updatedM[targetRow][j].deviceId?conflictingCells.push({row:targetRow,col:j}):(updatedM[targetRow][j]=m[i][j],updatedM[i][j]={deviceId:"",pixel:0,group:""}))}conflictingCells.length>0?setError(conflictingCells):setM(updatedM)},Actions_moveSelectedGroupLeft=_ref=>{let{m,rowN,colN,selectedGroup,setM}=_ref;const updatedM=clone(m);for(let i=0;i<rowN;i++)for(let j=0;j<colN;j++)if(m[i][j].group===selectedGroup){const targetCol=j-1;targetCol>=0&&""===m[i][0].deviceId&&(updatedM[i][targetCol]=m[i][j],updatedM[i][j]={deviceId:"",pixel:0,group:""})}setM(updatedM)},Actions_moveSelectedGroupRight=_ref=>{let{m,rowN,colN,selectedGroup,setM}=_ref;const updatedM=clone(m);for(let i=0;i<rowN;i++)for(let j=colN-1;j>=0;j--)if(m[i][j].group===selectedGroup){const targetCol=j+1;targetCol<colN&&""===m[i][colN-1].deviceId&&(updatedM[i][targetCol]=m[i][j],updatedM[i][j]={deviceId:"",pixel:0,group:""})}setM(updatedM)},Actions_moveSelectedGroupDown=_ref=>{let{m,rowN,colN,selectedGroup,setError,setM}=_ref;const updatedM=clone(m),conflictingCells=[];for(let i=rowN-1;i>=0;i--)for(let j=0;j<colN;j+=1)if(m[i][j].group===selectedGroup){const targetRow=i+1;targetRow<rowN&&(""!==updatedM[targetRow][j].deviceId?conflictingCells.push({row:targetRow,col:j}):(updatedM[targetRow][j]=m[i][j],updatedM[i][j]={deviceId:"",pixel:0,group:""}))}conflictingCells.length>0?setError(conflictingCells):setM(updatedM)};var FormControl=__webpack_require__("./node_modules/@mui/material/FormControl/FormControl.js"),InputLabel=__webpack_require__("./node_modules/@mui/material/InputLabel/InputLabel.js"),react_webcam=__webpack_require__("./node_modules/react-webcam/dist/react-webcam.js"),react_webcam_default=__webpack_require__.n(react_webcam);function transpose(inputX,inputY,inputWidth,inputHeight,outputWidth,outputHeight){return{x:Math.floor(inputX/inputWidth*outputWidth),y:Math.floor(inputY/inputHeight*outputHeight)}}const pixelUtils_wait=ms=>new Promise((resolve=>setTimeout(resolve,ms))),pixelUtils_wled=async body=>{const wledIp=useStore.A.getState().videoMapper.wledIp;try{const response=await fetch(`http://${wledIp}/json`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(body)});return await response.json()}catch(error){console.error(error)}},wledGet=async function(){let path=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"state";const wledIp=useStore.A.getState().videoMapper.wledIp;if(wledIp&&""!==wledIp)try{const response=await fetch(`http://${wledIp}/json/${path}`);return await response.json()||response}catch(error){console.error(error)}},pixelUtils_getLedCount=async wledIp=>{try{const response=await fetch(`http://${wledIp}/json/info`);return(await response.json()).leds.count}catch(error){console.error(error)}};function decodeBase64ToImageData(base64String){const base64Data=base64String.split(",")[1],imageData=atob(base64Data),buffer=new Uint8Array(imageData.length);for(let i=0;i<imageData.length;i++)buffer[i]=imageData.charCodeAt(i);return buffer}async function createImageFromData(imageData){const blob=new Blob([imageData],{type:"image/webp"}),url=URL.createObjectURL(blob),img=new Image;return img.src=url,await new Promise((resolve=>{img.onload=resolve})),img}async function processImages(img1b64,img2b64){let threshold=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128,ignoreTop=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,ignoreLeft=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,ignoreBottom=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,ignoreRight=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,pointsRef=arguments.length>7?arguments[7]:void 0;try{const imageData1=decodeBase64ToImageData(img1b64),image1=await createImageFromData(imageData1),imageData2=decodeBase64ToImageData(img2b64),diffData=function calculateImageDifference(img1,img2){let threshold=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128,ignoreTop=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,ignoreLeft=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,ignoreBottom=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,ignoreRight=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const width=img1.width-ignoreLeft-ignoreRight,height=img1.height-ignoreTop-ignoreBottom,canvas=document.createElement("canvas",{willReadFrequently:!0});canvas.width=width,canvas.height=height;const context=canvas.getContext("2d",{willReadFrequently:!0});context.drawImage(img1,ignoreLeft,ignoreTop,width,height,0,0,width,height);const imageData1=context.getImageData(0,0,width,height).data;context.clearRect(0,0,width,height),context.drawImage(img2,ignoreLeft,ignoreTop,width,height,0,0,width,height);const imageData2=context.getImageData(0,0,width,height).data,diffData=new Uint8ClampedArray(width*height*4);let whitePixels=[];for(let i=0;i<width*height*4;i+=4){const diffAlpha=255,outputValue=(Math.abs(imageData1[i]-imageData2[i])+Math.abs(imageData1[i+1]-imageData2[i+1])+Math.abs(imageData1[i+2]-imageData2[i+2]))/3>threshold?255:0;if(diffData[i]=outputValue,diffData[i+1]=outputValue,diffData[i+2]=outputValue,diffData[i+3]=diffAlpha,255===outputValue){const x=i/4%width,y=Math.floor(i/4/width);whitePixels.push({x,y})}}const whitePixelsCount=whitePixels.length,whitePixelsCenter=whitePixels.reduce(((acc,_ref)=>{let{x,y}=_ref;return{x:acc.x+x,y:acc.y+y}}),{x:0,y:0});return whitePixelsCenter.x/=whitePixelsCount,whitePixelsCenter.y/=whitePixelsCount,context.putImageData(new ImageData(diffData,width,height),0,0),context.beginPath(),context.arc(whitePixelsCenter.x,whitePixelsCenter.y,5,0,2*Math.PI,!1),context.fillStyle="red",context.fill(),{diffImage:canvas.toDataURL("image/webp"),whitePixelsCenter}}(image1,await createImageFromData(imageData2),threshold,ignoreTop,ignoreLeft,ignoreBottom,ignoreRight),diffImageBase64=diffData.diffImage;pointsRef&&(pointsRef.current=diffData.whitePixelsCenter);document.getElementById("diffImage").src=diffImageBase64}catch(error){console.error("Error processing images:",error)}}async function calibrate(wledIp,waitTime,pointsRef){let inputWidth=arguments.length>3&&void 0!==arguments[3]?arguments[3]:400,inputHeight=arguments.length>4&&void 0!==arguments[4]?arguments[4]:300,outputWidth=arguments.length>5&&void 0!==arguments[5]?arguments[5]:50,outputHeight=arguments.length>6&&void 0!==arguments[6]?arguments[6]:50,setPoints=arguments.length>7?arguments[7]:void 0,addPoint=arguments.length>8?arguments[8]:void 0,device=arguments.length>9?arguments[9]:void 0;const leds=await pixelUtils_getLedCount(wledIp);await async function(){let pixels=arguments.length>0&&void 0!==arguments[0]?arguments[0]:69;await pixelUtils_wled({seg:{i:[0,pixels,"000000"]}})}(leds),setPoints([]),await async function(waitingTime,pointsRef){let inputWidth=arguments.length>2&&void 0!==arguments[2]?arguments[2]:400,inputHeight=arguments.length>3&&void 0!==arguments[3]?arguments[3]:300,outputWidth=arguments.length>4&&void 0!==arguments[4]?arguments[4]:50,outputHeight=arguments.length>5&&void 0!==arguments[5]?arguments[5]:50,addPoint=arguments.length>6?arguments[6]:void 0,device=arguments.length>7?arguments[7]:void 0;const segments=(await wledGet()).seg;let totalPreviousLength=0;for(const segment of segments){for(let i=0;i<segment.len+1;i++){var _pointsRef$current,_pointsRef$current2;const singleLedOn={seg:{id:segment.id,i:0===i?[i,i+1,"FFFFFF",i+1,segment.len,"000000"]:[0,i,"000000",i,i+1,"FFFFFF",i+1,segment.len,"000000"]}};await pixelUtils_wled(singleLedOn);const transposed=transpose(null==pointsRef||null===(_pointsRef$current=pointsRef.current)||void 0===_pointsRef$current?void 0:_pointsRef$current.x,null==pointsRef||null===(_pointsRef$current2=pointsRef.current)||void 0===_pointsRef$current2?void 0:_pointsRef$current2.y,inputWidth,inputHeight,outputWidth,outputHeight);isNaN(transposed.x)||isNaN(transposed.y)||(addPoint({...transposed,segment:segment.id,led:totalPreviousLength+i,device}),await pixelUtils_wait(waitingTime))}totalPreviousLength+=segment.len}}(waitTime/7,pointsRef,inputWidth,inputHeight,outputWidth,outputHeight,addPoint,device),await(async()=>{await pixelUtils_wled({seg:{on:!0,col:[0,0,0]}})})(),setPoints([])}const Webcam=_ref=>{let{colN,rowN}=_ref;const webcamRef=(0,react.useRef)(null),pointsRef=(0,react.useRef)(null),setPoints=(0,useStore.A)((state=>state.setPoints)),addPoint=(0,useStore.A)((state=>state.addPoint)),devices=(0,useStore.A)((state=>state.devices)),wledIps=Object.keys(devices).filter((d=>"wled"===devices[d].type)).map((d=>devices[d].config.ip_address)),[deviceId,setDeviceId]=(0,react.useState)(""),[mDevices,setMDevices]=(0,react.useState)([]),[ip,setIp]=(0,react.useState)(""),wledIp=(0,useStore.A)((state=>state.videoMapper.wledIp)),wledDeviceId=Object.keys(devices).find((d=>devices[d].config.ip_address===wledIp)),setWledIp=(0,useStore.A)((state=>state.setWledIp)),[threshold,setThreshold]=(0,react.useState)(128),[singleLed,setSingleLed]=(0,react.useState)(0),[baseImage,setBaseImage]=(0,react.useState)(""),[maxLed,setMaxLed]=(0,react.useState)(0),[isAdjusting,setIsAdjusting]=(0,react.useState)(!1),[ignoreTop,setIgnoreTop]=(0,react.useState)(0),[ignoreLeft,setIgnoreLeft]=(0,react.useState)(0),[ignoreBottom,setIgnoreBottom]=(0,react.useState)(0),[ignoreRight,setIgnoreRight]=(0,react.useState)(0),[brightness,setBrightness]=(0,react.useState)(255),isCalibrating=(0,useStore.A)((state=>state.videoMapper.calibrating)),setIsCalibrating=(0,useStore.A)((state=>state.setCalibrating)),handleDevices=(0,react.useCallback)((mediaDevices=>{const videoDevices=mediaDevices.filter((_ref2=>{let{kind}=_ref2;return"videoinput"===kind}));""===deviceId&&videoDevices.length>0&&setDeviceId(videoDevices[0].deviceId),setMDevices(videoDevices)}),[setMDevices,deviceId]),capture=(0,react.useCallback)((async()=>{var _webcamRef$current;return null===(_webcamRef$current=webcamRef.current)||void 0===_webcamRef$current?void 0:_webcamRef$current.getScreenshot()}),[webcamRef]);return(0,react.useEffect)((()=>{navigator.mediaDevices.enumerateDevices().then(handleDevices)}),[handleDevices]),(0,react.useEffect)((()=>{setIp(wledIp);(async()=>{if(wledIp&&""!==wledIp){const c=await pixelUtils_getLedCount(wledIp);setMaxLed(c)}})()}),[wledIp]),(0,react.useEffect)((()=>{let animationFrameId=null,isCancelled=!1;const adjustFrame=async()=>{isAdjusting&&!isCancelled&&(await async function adjust(capture,initialImage){let threshold=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128,ignoreTop=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,ignoreLeft=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,ignoreBottom=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,ignoreRight=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,pointsRef=arguments.length>7?arguments[7]:void 0;processImages(initialImage,await capture(),threshold,ignoreTop,ignoreLeft,ignoreBottom,ignoreRight,pointsRef)}(capture,baseImage,threshold,ignoreTop,ignoreLeft,ignoreBottom,ignoreRight,pointsRef),animationFrameId=requestAnimationFrame(adjustFrame))};return async function preadjust(){await pixelUtils_wled({on:!0}),await pixelUtils_wled({seg:{on:!0,col:[[255,0,0],[255,0,0],[255,0,0]]}})}(),adjustFrame(),()=>{isCancelled=!0,animationFrameId&&cancelAnimationFrame(animationFrameId)}}),[isAdjusting,threshold,baseImage,capture,ignoreTop,ignoreLeft,ignoreBottom,ignoreRight]),(0,react.useEffect)((()=>{isCalibrating&&calibrate(wledIp,100,pointsRef,400-ignoreLeft-ignoreRight,300-ignoreBottom-ignoreTop,colN,rowN,setPoints,addPoint,wledDeviceId).then((()=>{setIsCalibrating(!1)}))}),[isCalibrating,wledIp,ignoreTop,ignoreLeft,ignoreBottom,ignoreRight,wledDeviceId,colN,rowN,setPoints,addPoint,setIsCalibrating]),(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",spacing:2,sx:{width:400},children:[(0,jsx_runtime.jsxs)(FormControl.A,{fullWidth:!0,className:"step-2d-virtual-seven",children:[(0,jsx_runtime.jsx)(InputLabel.A,{id:"wled",children:"WLED Devices"}),wledIps.length>0&&(0,jsx_runtime.jsxs)(Select.A,{variant:"outlined",label:"WLED Devices",labelId:"wled",value:wledIp,onChange:e=>setWledIp(e.target.value),children:[(0,jsx_runtime.jsx)(MenuItem.A,{value:"",disabled:!0,children:"Select WLED Device"},""),wledIps.map((wledip=>(0,jsx_runtime.jsx)(MenuItem.A,{value:wledip,children:wledip},wledip)))]})]}),(0,jsx_runtime.jsx)(TextField.A,{fullWidth:!0,sx:{display:"none"},label:"IP",value:ip,onChange:e=>setIp(e.target.value)}),(0,jsx_runtime.jsxs)(FormControl.A,{fullWidth:!0,className:"step-2d-virtual-eight",children:[(0,jsx_runtime.jsx)(InputLabel.A,{id:"camera",children:"Camera"}),(0,jsx_runtime.jsx)(Select.A,{label:"Camera",labelId:"camera",variant:"outlined",value:deviceId,onChange:e=>setDeviceId(e.target.value),children:mDevices.map(((device,key)=>(0,jsx_runtime.jsx)(MenuItem.A,{value:device.deviceId,children:device.label||`Device ${key+1}`},device.deviceId)))})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Button.A,{onClick:async()=>{const img=await async function initialize(capture){return await pixelUtils_wled({seg:{on:!1}}),await pixelUtils_wait(1e3),await capture()}(capture);setBaseImage(img)},className:"step-2d-virtual-nine",children:"Initialize"}),(0,jsx_runtime.jsx)(Button.A,{onClick:()=>setIsAdjusting(!isAdjusting),className:"step-2d-virtual-ten",children:isAdjusting?"Stop Adjust":"Adjust"}),(0,jsx_runtime.jsx)(Button.A,{disabled:isCalibrating||!isAdjusting,onClick:()=>setIsCalibrating(!0),className:"step-2d-virtual-eleven",children:isCalibrating?"Calibrating":"Calibrate"})]}),(0,jsx_runtime.jsx)(react_webcam_default(),{ref:webcamRef,width:"100%",mirrored:!1,audio:!1,videoConstraints:{deviceId}}),(0,jsx_runtime.jsx)("br",{}),!isCalibrating&&!isAdjusting&&(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",className:"step-2d-virtual-twelve",children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Typography.A,{width:120,children:"Cut Top"}),(0,jsx_runtime.jsx)(Slider.Ay,{min:0,max:150,value:ignoreTop,onChange:(_,v)=>setIgnoreTop(v)})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Typography.A,{width:120,children:"Cut Left"}),(0,jsx_runtime.jsx)(Slider.Ay,{min:0,max:200,value:ignoreLeft,onChange:(_,v)=>setIgnoreLeft(v)})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Typography.A,{width:120,children:"Cut Bottom"}),(0,jsx_runtime.jsx)(Slider.Ay,{min:0,max:150,value:ignoreBottom,onChange:(_,v)=>setIgnoreBottom(v)})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Typography.A,{width:120,children:"Cut Right"}),(0,jsx_runtime.jsx)(Slider.Ay,{min:0,max:200,value:ignoreRight,onChange:(_,v)=>setIgnoreRight(v)})]})]}),!isCalibrating&&isAdjusting&&(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",className:"step-2d-virtual-thirteen",children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Typography.A,{width:120,children:"Led"}),(0,jsx_runtime.jsx)(Slider.Ay,{min:0,step:1,max:maxLed,value:singleLed,onChange:(_,v)=>{setSingleLed(v),(async led=>{const segments=(await wledGet("state")).seg;let totalLedCount=0;for(const segment of segments){const allLedsOff={seg:{id:segment.id,i:[0,segment.len,"000000"]}};await pixelUtils_wled(allLedsOff)}for(const segment of segments)if(totalLedCount+=segment.len,totalLedCount>=led){const ledInSegment=led-(totalLedCount-segment.len),singleLedOn={seg:{id:segment.id,i:[ledInSegment,ledInSegment+1,"FFFFFF"]}};await pixelUtils_wled(singleLedOn);break}})(v)}})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Typography.A,{width:120,children:"Brightness"}),(0,jsx_runtime.jsx)(Slider.Ay,{min:0,max:255,value:brightness,onChange:(_,v)=>{setBrightness(v),async function(){let brightness=arguments.length>0&&void 0!==arguments[0]?arguments[0]:255;await pixelUtils_wled({bri:brightness})}(v)}})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(Typography.A,{width:120,children:"Threshold"}),(0,jsx_runtime.jsx)(Slider.Ay,{min:0,max:255,value:threshold,onChange:(_,v)=>setThreshold(v)})]})]}),!isAdjusting&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("br",{}),"Base Image:",(0,jsx_runtime.jsxs)("div",{style:{position:"relative",margin:0,height:300},children:[(0,jsx_runtime.jsx)("img",{src:baseImage,alt:"baseImage"},"baseImage"),(0,jsx_runtime.jsx)("div",{style:{position:"absolute",top:0,left:0,bottom:0,right:400-ignoreLeft,background:"#444"}}),(0,jsx_runtime.jsx)("div",{style:{position:"absolute",top:300-ignoreBottom,left:0,bottom:0,right:0,background:"#444"}}),(0,jsx_runtime.jsx)("div",{style:{position:"absolute",top:0,left:0,bottom:300-ignoreTop,right:0,background:"#444"}}),(0,jsx_runtime.jsx)("div",{style:{position:"absolute",top:0,left:400-ignoreRight,bottom:0,right:0,background:"#444"}})]})]}),isAdjusting&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Diff Image:",(0,jsx_runtime.jsx)("img",{id:"diffImage",alt:"diff"})]})]})},Webcam_Webcam=Webcam;try{Webcam.displayName="Webcam",Webcam.__docgenInfo={description:"",displayName:"Webcam",props:{colN:{defaultValue:null,description:"",name:"colN",required:!0,type:{name:"number"}},rowN:{defaultValue:null,description:"",name:"rowN",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Webcam/Webcam.tsx#Webcam"]={docgenInfo:Webcam.__docgenInfo,name:"Webcam",path:"src/components/Webcam/Webcam.tsx#Webcam"})}catch(__react_docgen_typescript_loader_error){}const MControls=_ref=>{let{rowN,colN,setRowNumber,setColNumber,virtual,m,setM,move,dnd,setMove,setDnd,selectedGroup,setError,setPixels}=_ref;const[tab,setTab]=(0,react.useState)("1"),[camMapper,setCamMapper]=(0,react.useState)(!1),getVirtuals=(0,useStore.A)((state=>state.getVirtuals)),getDevices=(0,useStore.A)((state=>state.getDevices)),[showPixelGraph,setShowPixelGraph]=(0,react.useState)(!1),pixelGraphs=(0,useStore.A)((state=>state.pixelGraphs)),virtuals=(0,useStore.A)((state=>state.virtuals)),infoAlerts=(0,useStore.A)((state=>state.ui.infoAlerts)),setInfoAlerts=(0,useStore.A)((state=>state.ui.setInfoAlerts)),features=(0,useStore.A)((state=>state.features));return(0,react.useEffect)((()=>{dnd&&"2"!==tab&&setTab("2"),dnd||"1"===tab||setTab("1")}),[dnd]),(0,react.useEffect)((()=>{const handleWebsockets=e=>{e.detail.id===virtual.id&&setPixels(e.detail.pixels)};return showPixelGraph&&virtual.id?document.addEventListener("visualisation_update",handleWebsockets):document.removeEventListener("visualisation_update",handleWebsockets),()=>{document.removeEventListener("visualisation_update",handleWebsockets)}}),[virtuals,pixelGraphs,showPixelGraph,virtual]),(0,jsx_runtime.jsxs)(Stack.A,{minWidth:400,direction:"column",spacing:2,style:{marginBottom:"1rem"},p:2,children:[(0,jsx_runtime.jsxs)(Collapse.A,{in:!camMapper,children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",justifyContent:"flex-start",alignItems:"flex-start",sx:{"& .MuiButton-root":{minWidth:0}},children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",justifyContent:"flex-start",alignItems:"flex-start",className:"step-2d-virtual-three",children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",width:400,justifyContent:"space-between",children:[(0,jsx_runtime.jsx)(Typography.A,{width:100,variant:"body1",children:"Rows:"}),(0,jsx_runtime.jsx)(Box.A,{width:250,children:(0,jsx_runtime.jsx)(Slider.Ay,{min:1,max:50,value:rowN,onChange:(e,newRowNumber)=>"number"==typeof newRowNumber&&setRowNumber(newRowNumber)})}),rowN]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",width:400,justifyContent:"space-between",children:[(0,jsx_runtime.jsx)(Typography.A,{width:100,variant:"body1",children:"Columns:"}),(0,jsx_runtime.jsx)(Box.A,{width:250,children:(0,jsx_runtime.jsx)(Slider.Ay,{min:1,max:50,value:colN,onChange:(e,newColNumber)=>"number"==typeof newColNumber&&setColNumber(newColNumber)})}),colN]})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",width:400,justifyContent:"space-between",margin:"1rem 0",className:"step-2d-virtual-four",spacing:1,children:[(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",justifyContent:"flex-start",spacing:.5,children:[(0,jsx_runtime.jsx)(Tooltip.A,{title:"Rotate 90Â°",children:(0,jsx_runtime.jsx)(Button.A,{onClick:()=>setM((0,helpers.mg)(m)),children:(0,jsx_runtime.jsx)(Rotate90DegreesCw.A,{})})}),(0,jsx_runtime.jsx)(Tooltip.A,{title:"Swap Vertically",children:(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{const toReverse=JSON.parse(JSON.stringify(m));setM(toReverse.reverse())},children:(0,jsx_runtime.jsx)(SwapVert.A,{})})}),(0,jsx_runtime.jsx)(Tooltip.A,{title:"Swap Horizontally",children:(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{const toReverse=JSON.parse(JSON.stringify(m));for(let index=0;index<toReverse.length;index+=1)toReverse[index]=toReverse[index].reverse();setM(toReverse)},children:(0,jsx_runtime.jsx)(SwapHoriz.A,{})})})]}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",justifyContent:"flex-start",spacing:.5,children:[(0,jsx_runtime.jsx)(Tooltip.A,{title:(showPixelGraph?"Hide":"Show")+" Pixel Graph",className:"step-2d-virtual-two",children:(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{setShowPixelGraph(!showPixelGraph)},children:showPixelGraph?(0,jsx_runtime.jsx)(Stop.A,{}):(0,jsx_runtime.jsx)(PlayArrow.A,{})})}),(0,jsx_runtime.jsx)(Tooltip.A,{title:"Load / Reset",children:(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{setM(function reverseProcessArray(outputArray,rows){const inputArray=[],finalArray=[];let group="0-0";for(let i=0;i<outputArray.length;i+=1){const[deviceId,startPixel,endPixel,flip]=outputArray[i];if(deviceId.startsWith("gap-"))for(let j=startPixel;j<=endPixel;j+=1)inputArray.push({deviceId:"",pixel:j,group:"0-0"});else if(flip)for(let j=endPixel;j>=startPixel;j-=1)group=`${Math.floor(i/(rows||1))}-${i%(rows||1)}`,inputArray.push({deviceId,pixel:j,group});else for(let j=startPixel;j<=endPixel;j+=1)group=`${Math.floor(i/(rows||1))}-${i%(rows||1)}`,inputArray.push({deviceId,pixel:j,group})}if(rows){for(let i=0;i<inputArray.length;i+=rows)finalArray.push(inputArray.slice(i,i+rows));return finalArray}return[inputArray]}(virtual.segments,colN))},children:(0,jsx_runtime.jsx)(Loop.A,{})})}),(0,jsx_runtime.jsx)(Tooltip.A,{title:"Clear",children:(0,jsx_runtime.jsx)(Box.A,{children:(0,jsx_runtime.jsx)(Popover.A,{color:"inherit",variant:"outlined",onConfirm:()=>{setM(Array(rowN).fill(Array(colN).fill(MCell)))}})})}),(0,jsx_runtime.jsx)(Tooltip.A,{title:"Save",children:(0,jsx_runtime.jsx)(Button.A,{onClick:()=>{(0,ledfx.U)(`/api/virtuals/${virtual.id}`,"POST",{segments:processArray(m.flat(),virtual.id)}).then((()=>{getVirtuals(),getDevices()}))},onContextMenu:e=>{e.preventDefault(),(0,ledfx.U)(`/api/virtuals/${virtual.id}`,"POST",{segments:processArray(m.flat(),virtual.id),matrix:m})},children:(0,jsx_runtime.jsx)(Save.A,{})})})]})]})]}),(0,jsx_runtime.jsxs)(TabContext.Ay,{value:tab,children:[(0,jsx_runtime.jsx)(Box.A,{sx:{borderBottom:1,borderColor:"divider",marginTop:"0 !important"},className:"step-2d-virtual-six",children:(0,jsx_runtime.jsxs)(TabList.A,{onChange:(event,newValue)=>{"1"===newValue&&setDnd(!1),"2"===newValue&&setDnd(!0),setTab(newValue)},"aria-label":"lab API tabs example",children:[(0,jsx_runtime.jsx)(Tab.A,{icon:(0,jsx_runtime.jsx)(PanTool.A,{}),iconPosition:"start",label:"DND-Canvas",value:"1"}),(0,jsx_runtime.jsx)(Tab.A,{icon:(0,jsx_runtime.jsx)(ControlCamera.A,{}),iconPosition:"start",label:"DND-Pixels",value:"2"})]})}),(0,jsx_runtime.jsx)(TabPanel.A,{value:"1",sx:{padding:0},children:(0,jsx_runtime.jsx)(Collapse.A,{in:infoAlerts.camera,children:(0,jsx_runtime.jsxs)(Alert.A,{severity:"info",sx:{width:"100%"},onClose:()=>{setInfoAlerts("camera",!1)},children:[(0,jsx_runtime.jsx)("strong",{children:"DND-Canvas Mode"}),(0,jsx_runtime.jsxs)("ul",{style:{padding:"0 1rem"},children:[(0,jsx_runtime.jsx)("li",{children:"Use Mousewheel to Zoom"}),(0,jsx_runtime.jsx)("li",{children:"Use left-click with drag&drop to move around"}),(0,jsx_runtime.jsx)("li",{children:"Use right-click to:"}),(0,jsx_runtime.jsxs)("ul",{children:[(0,jsx_runtime.jsx)("li",{children:"assign pixel or pixel-group"}),(0,jsx_runtime.jsx)("li",{children:"edit a pixel"}),(0,jsx_runtime.jsx)("li",{children:"clear a pixel"}),(0,jsx_runtime.jsx)("li",{children:"move a pixel-group"})]}),(0,jsx_runtime.jsx)("li",{children:"Enter DND-Pixels mode to move pixels individually"})]})]})})}),(0,jsx_runtime.jsx)(TabPanel.A,{value:"2",children:(0,jsx_runtime.jsx)(Collapse.A,{in:infoAlerts.pixelMode,sx:{marginTop:"0 !important"},children:(0,jsx_runtime.jsxs)(Alert.A,{severity:"info",sx:{width:"100%"},onClose:()=>setInfoAlerts("pixelMode",!1),children:[(0,jsx_runtime.jsx)("strong",{children:"DND-Pixels Mode"}),(0,jsx_runtime.jsx)("ul",{style:{padding:"0 1rem"},children:(0,jsx_runtime.jsx)("li",{children:"move pixels individually with your mouse"})})]})})})]}),move?(0,jsx_runtime.jsxs)(Box.A,{children:[(0,jsx_runtime.jsx)(Box.A,{className:"step-2d-virtual-five",children:(0,jsx_runtime.jsx)(Tab.A,{icon:(0,jsx_runtime.jsx)(ControlCamera.A,{}),iconPosition:"start",label:"Move Group",value:!0})}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",spacing:0,alignItems:"center",justifyContent:"center",children:[(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>Actions_moveSelectedGroupUp({m,rowN,colN,selectedGroup,setError,setM}),children:(0,jsx_runtime.jsx)(ArrowUpward.A,{})}),(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:0,justifyContent:"center",children:[(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>Actions_moveSelectedGroupLeft({m,rowN,colN,selectedGroup,setM}),children:(0,jsx_runtime.jsx)(ArrowBack.A,{})}),(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>setMove(!1),children:(0,jsx_runtime.jsx)(Cancel.A,{})}),(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>Actions_moveSelectedGroupRight({m,rowN,colN,selectedGroup,setM}),children:(0,jsx_runtime.jsx)(ArrowForward.A,{})})]}),(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>Actions_moveSelectedGroupDown({m,rowN,colN,selectedGroup,setError,setM}),children:(0,jsx_runtime.jsx)(ArrowDownward.A,{})})]})]}):(0,jsx_runtime.jsx)(Collapse.A,{in:infoAlerts.matrixGroups,children:(0,jsx_runtime.jsx)(Alert.A,{severity:"info",sx:{width:400,marginTop:2},onClose:()=>{setInfoAlerts("matrixGroups",!1)},children:(0,jsx_runtime.jsxs)("strong",{children:["Right-Click an element to move a group.",(0,jsx_runtime.jsx)("br",{}),"Groups can only be moved with the UI buttons"]})})})]}),features.matrix_cam&&(0,jsx_runtime.jsxs)(Button.A,{sx:{alignItems:"center",textTransform:"none"},onClick:()=>{getDevices(),setCamMapper(!camMapper)},children:[(0,jsx_runtime.jsx)(EmergencyRecording.A,{sx:{marginRight:1}}),camMapper?"Exit CameraMapper":"Map Pixels via Camera"]}),(0,jsx_runtime.jsx)(Collapse.A,{in:camMapper,children:(0,jsx_runtime.jsx)(Webcam_Webcam,{rowN,colN})})]})},EditMatrix_MControls=MControls;try{MControls.displayName="MControls",MControls.__docgenInfo={description:"",displayName:"MControls",props:{rowN:{defaultValue:null,description:"",name:"rowN",required:!0,type:{name:"number"}},colN:{defaultValue:null,description:"",name:"colN",required:!0,type:{name:"number"}},setRowNumber:{defaultValue:null,description:"",name:"setRowNumber",required:!0,type:{name:"any"}},setColNumber:{defaultValue:null,description:"",name:"setColNumber",required:!0,type:{name:"any"}},virtual:{defaultValue:null,description:"",name:"virtual",required:!0,type:{name:"any"}},m:{defaultValue:null,description:"",name:"m",required:!0,type:{name:"any"}},setM:{defaultValue:null,description:"",name:"setM",required:!0,type:{name:"any"}},move:{defaultValue:null,description:"",name:"move",required:!0,type:{name:"boolean"}},dnd:{defaultValue:null,description:"",name:"dnd",required:!0,type:{name:"boolean"}},setMove:{defaultValue:null,description:"",name:"setMove",required:!0,type:{name:"any"}},setDnd:{defaultValue:null,description:"",name:"setDnd",required:!0,type:{name:"any"}},selectedGroup:{defaultValue:null,description:"",name:"selectedGroup",required:!0,type:{name:"string"}},setError:{defaultValue:null,description:"",name:"setError",required:!0,type:{name:"any"}},setPixels:{defaultValue:null,description:"",name:"setPixels",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/EditMatrix/MControls.tsx#MControls"]={docgenInfo:MControls.__docgenInfo,name:"MControls",path:"src/pages/Devices/EditVirtuals/EditMatrix/MControls.tsx#MControls"})}catch(__react_docgen_typescript_loader_error){}function Droppable(_ref){let{id,children,cell,bg,opacity=1,onContextMenu}=_ref;const{isOver,setNodeRef}=(0,core_esm.zM)({id}),style={opacity,background:isOver?""===(null==cell?void 0:cell.deviceId)?"rgba(0, 255, 0, 0.1)":"rgba(255, 0, 0, 0.1)":bg},classes=M_styles();return(0,jsx_runtime.jsx)("div",{ref:setNodeRef,style,className:classes.gridCell,onContextMenu,children})}const EditMatrix_Droppable=Droppable;try{Droppable.displayName="Droppable",Droppable.__docgenInfo={description:"",displayName:"Droppable",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},cell:{defaultValue:null,description:"",name:"cell",required:!1,type:{name:"IMCell"}},bg:{defaultValue:null,description:"",name:"bg",required:!0,type:{name:"string"}},opacity:{defaultValue:{value:"1"},description:"",name:"opacity",required:!1,type:{name:"number"}},onContextMenu:{defaultValue:null,description:"",name:"onContextMenu",required:!1,type:{name:"MouseEventHandler<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/EditMatrix/Droppable.tsx#Droppable"]={docgenInfo:Droppable.__docgenInfo,name:"Droppable",path:"src/pages/Devices/EditVirtuals/EditMatrix/Droppable.tsx#Droppable"})}catch(__react_docgen_typescript_loader_error){}function Draggable(_ref){let{children,id,...props}=_ref;const{attributes,listeners,setNodeRef,transform}=(0,core_esm.PM)({id}),style=transform?{width:"100px",transform:`translate3d(${transform.x}px, ${transform.y}px, 0)`}:void 0;return(0,jsx_runtime.jsx)("div",{type:"button",ref:setNodeRef,style,...props,...listeners,...attributes,children})}const EditMatrix_Draggable=Draggable;try{Draggable.displayName="Draggable",Draggable.__docgenInfo={description:"",displayName:"Draggable",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/EditMatrix/Draggable.tsx#Draggable"]={docgenInfo:Draggable.__docgenInfo,name:"Draggable",path:"src/pages/Devices/EditVirtuals/EditMatrix/Draggable.tsx#Draggable"})}catch(__react_docgen_typescript_loader_error){}const Pixel=_ref=>{let{m,currentColIndex,classes,currentRowIndex,move,decodedPixels,colN,pixels,yzcolumn,selectedGroup,error,setCurrentCell,setCurrentDevice,setSelectedPixel,openContextMenu,isDragging}=_ref;const devices=(0,useStore.A)((state=>state.devices)),mode=(0,useStore.A)((state=>state.config)).transmission_mode;return error.length>0&&console.log(isDragging,error),(0,jsx_runtime.jsx)(Box.A,{sx:{backgroundColor:"compressed"===mode&&decodedPixels?decodedPixels[currentRowIndex*colN+currentColIndex]?`rgb(${Object.values(decodedPixels[currentRowIndex*colN+currentColIndex])})`:"#222":pixels&&pixels[0]&&pixels[0].length?`rgb(${pixels[0][currentRowIndex*colN+currentColIndex]},${pixels[1][currentRowIndex*colN+currentColIndex]},${pixels[2][currentRowIndex*colN+currentColIndex]})`:"#222",opacity:isDragging?.3:move&&(null==yzcolumn?void 0:yzcolumn.group)===selectedGroup?1:move&&(null==yzcolumn?void 0:yzcolumn.group)!==selectedGroup||""===selectedGroup?.9:""!==yzcolumn.deviceId?1:.3},onContextMenu:e=>{var _m$currentRowIndex$cu;e.preventDefault(),setCurrentCell([currentColIndex,currentRowIndex]),setCurrentDevice(""!==yzcolumn.deviceId?yzcolumn.deviceId:""),setSelectedPixel(yzcolumn.pixel||0),currentRowIndex>-1&&currentColIndex>-1&&""!==(null===(_m$currentRowIndex$cu=m[currentRowIndex][currentColIndex])||void 0===_m$currentRowIndex$cu?void 0:_m$currentRowIndex$cu.deviceId)&&openContextMenu(e)},children:""!==yzcolumn.deviceId&&(0,jsx_runtime.jsxs)("div",{className:classes.pixel,children:[(0,jsx_runtime.jsx)(Typography.A,{variant:"caption",children:devices[yzcolumn.deviceId].config.name}),(0,jsx_runtime.jsx)(Typography.A,{variant:"caption",children:yzcolumn.pixel})]})},`col-${currentColIndex}`)},EditMatrix_Pixel=Pixel;try{Pixel.displayName="Pixel",Pixel.__docgenInfo={description:"",displayName:"Pixel",props:{m:{defaultValue:null,description:"",name:"m",required:!0,type:{name:"IMCell[][]"}},currentColIndex:{defaultValue:null,description:"",name:"currentColIndex",required:!0,type:{name:"number"}},classes:{defaultValue:null,description:"",name:"classes",required:!0,type:{name:"any"}},currentRowIndex:{defaultValue:null,description:"",name:"currentRowIndex",required:!0,type:{name:"number"}},move:{defaultValue:null,description:"",name:"move",required:!0,type:{name:"boolean"}},decodedPixels:{defaultValue:null,description:"",name:"decodedPixels",required:!0,type:{name:"any"}},colN:{defaultValue:null,description:"",name:"colN",required:!0,type:{name:"number"}},pixels:{defaultValue:null,description:"",name:"pixels",required:!0,type:{name:"any"}},yzcolumn:{defaultValue:null,description:"",name:"yzcolumn",required:!0,type:{name:"IMCell"}},selectedGroup:{defaultValue:null,description:"",name:"selectedGroup",required:!0,type:{name:"string"}},error:{defaultValue:null,description:"",name:"error",required:!0,type:{name:"{ row: number; col: number; }[]"}},setCurrentCell:{defaultValue:null,description:"",name:"setCurrentCell",required:!0,type:{name:"any"}},setCurrentDevice:{defaultValue:null,description:"",name:"setCurrentDevice",required:!0,type:{name:"any"}},setSelectedPixel:{defaultValue:null,description:"",name:"setSelectedPixel",required:!0,type:{name:"any"}},openContextMenu:{defaultValue:null,description:"",name:"openContextMenu",required:!0,type:{name:"any"}},isDragging:{defaultValue:null,description:"",name:"isDragging",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/EditMatrix/Pixel.tsx#Pixel"]={docgenInfo:Pixel.__docgenInfo,name:"Pixel",path:"src/pages/Devices/EditVirtuals/EditMatrix/Pixel.tsx#Pixel"})}catch(__react_docgen_typescript_loader_error){}const Actions_hexColor=function hexColor(encodedString,mode){if("uncompressed"===mode||!encodedString)return[];const decodedString=atob(encodedString),charCodes=Array.from(decodedString).map((char=>char.charCodeAt(0)));return Array.from({length:charCodes.length/3},((_,i)=>({r:charCodes[3*i],g:charCodes[3*i+1],b:charCodes[3*i+2]})))};var Menu=__webpack_require__("./node_modules/@mui/material/Menu/Menu.js");const MContextMenu=_ref=>{let{anchorEl,closeContextMenu,setOpen,setSelectedGroup,setMove,currentCell,m,setDnd,clearPixel,clearPixelGroup}=_ref;const contextMenuOpen=Boolean(anchorEl);return(0,jsx_runtime.jsxs)(Menu.A,{id:"basic-menu",anchorEl,open:contextMenuOpen,onClose:closeContextMenu,onContextMenu:e=>{e.preventDefault(),closeContextMenu()},MenuListProps:{"aria-labelledby":"basic-button"},children:[(0,jsx_runtime.jsx)(MenuItem.A,{onClick:()=>{setOpen(!0)},children:"Edit"}),(0,jsx_runtime.jsx)(MenuItem.A,{onClick:()=>{setSelectedGroup(m[currentCell[1]][currentCell[0]].group||"0-0"),setDnd(!0),closeContextMenu()},children:"Move Pixel in DND"}),(0,jsx_runtime.jsx)(MenuItem.A,{onClick:()=>{setSelectedGroup(m[currentCell[1]][currentCell[0]].group||"0-0"),setMove(!0),closeContextMenu()},children:"Move Group"}),(0,jsx_runtime.jsx)(MenuItem.A,{onClick:e=>{clearPixel(),closeContextMenu(e)},children:"Clear Pixel"}),(0,jsx_runtime.jsx)(MenuItem.A,{onClick:e=>{clearPixelGroup(m[currentCell[1]][currentCell[0]].group||"0-0"),closeContextMenu(e)},children:"Clear Group"})]})},EditMatrix_MContextMenu=MContextMenu;try{MContextMenu.displayName="MContextMenu",MContextMenu.__docgenInfo={description:"",displayName:"MContextMenu",props:{anchorEl:{defaultValue:null,description:"",name:"anchorEl",required:!0,type:{name:"any"}},closeContextMenu:{defaultValue:null,description:"",name:"closeContextMenu",required:!0,type:{name:"any"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!0,type:{name:"any"}},setSelectedGroup:{defaultValue:null,description:"",name:"setSelectedGroup",required:!0,type:{name:"any"}},setMove:{defaultValue:null,description:"",name:"setMove",required:!0,type:{name:"any"}},currentCell:{defaultValue:null,description:"",name:"currentCell",required:!0,type:{name:"[number, number]"}},m:{defaultValue:null,description:"",name:"m",required:!0,type:{name:"any"}},setDnd:{defaultValue:null,description:"",name:"setDnd",required:!0,type:{name:"any"}},clearPixel:{defaultValue:null,description:"",name:"clearPixel",required:!0,type:{name:"any"}},clearPixelGroup:{defaultValue:null,description:"",name:"clearPixelGroup",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/EditMatrix/MContextMenu.tsx#MContextMenu"]={docgenInfo:MContextMenu.__docgenInfo,name:"MContextMenu",path:"src/pages/Devices/EditVirtuals/EditMatrix/MContextMenu.tsx#MContextMenu"})}catch(__react_docgen_typescript_loader_error){}const MDialogTitle=_ref=>{var _m$currentCell$1$curr;let{currentCell,m}=_ref;const classes=M_styles();return(0,jsx_runtime.jsx)(DialogTitle.A,{children:(0,jsx_runtime.jsxs)("div",{className:classes.centered,children:[currentCell[1]>=0&&currentCell[0]>=0&&""!==(null===(_m$currentCell$1$curr=m[currentCell[1]][currentCell[0]])||void 0===_m$currentCell$1$curr?void 0:_m$currentCell$1$curr.deviceId)?"Edit":"Assign"," ","Pixel",(0,jsx_runtime.jsxs)(Typography.A,{variant:"caption",align:"right",children:["Row: ",currentCell[1]+1,(0,jsx_runtime.jsx)("br",{}),"Column: ",currentCell[0]+1]})]})})},EditMatrix_MDialogTitle=MDialogTitle;try{MDialogTitle.displayName="MDialogTitle",MDialogTitle.__docgenInfo={description:"",displayName:"MDialogTitle",props:{currentCell:{defaultValue:null,description:"",name:"currentCell",required:!0,type:{name:"number[]"}},m:{defaultValue:null,description:"",name:"m",required:!0,type:{name:"any[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/EditMatrix/MDialogTitle.tsx#MDialogTitle"]={docgenInfo:MDialogTitle.__docgenInfo,name:"MDialogTitle",path:"src/pages/Devices/EditVirtuals/EditMatrix/MDialogTitle.tsx#MDialogTitle"})}catch(__react_docgen_typescript_loader_error){}var Switch=__webpack_require__("./node_modules/@mui/material/Switch/Switch.js");const MSwitch=_ref=>{let{group,setGroup}=_ref;return(0,jsx_runtime.jsxs)(BladeFrame.A,{title:"Group",style:{justifyContent:"space-between",paddingRight:2,marginBottom:"1rem"},children:[(0,jsx_runtime.jsx)(Typography.A,{children:"Assign multiple"}),(0,jsx_runtime.jsx)(Switch.A,{checked:group,onClick:()=>setGroup(!group)})]})},EditMatrix_MSwitch=MSwitch;try{MSwitch.displayName="MSwitch",MSwitch.__docgenInfo={description:"",displayName:"MSwitch",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/EditMatrix/MSwitch.tsx#MSwitch"]={docgenInfo:MSwitch.__docgenInfo,name:"MSwitch",path:"src/pages/Devices/EditVirtuals/EditMatrix/MSwitch.tsx#MSwitch"})}catch(__react_docgen_typescript_loader_error){}var Chip=__webpack_require__("./node_modules/@mui/material/Chip/Chip.js"),Divider=__webpack_require__("./node_modules/@mui/material/Divider/Divider.js");const right=__webpack_require__.p+"static/media/right.4437fb1e43fe564bd36af3f80b309a8c.svg";const right_snake=__webpack_require__.p+"static/media/right-snake.48646339a693661b2cbfb01036d4347d.svg";const right_flip=__webpack_require__.p+"static/media/right-flip.333ebf75f0fd0acb954b88d922e3ac19.svg";const right_snake_flip=__webpack_require__.p+"static/media/right-snake-flip.b3333c6771d73adb6415dfe752af3c80.svg";const bottom=__webpack_require__.p+"static/media/bottom.79f0473144db3f40a3b90b0889337363.svg";const bottom_flip=__webpack_require__.p+"static/media/bottom-flip.ca351932435166e77b4f79d8f60bc19e.svg";const bottom_snake=__webpack_require__.p+"static/media/bottom-snake.9b9a83d44ad5de6f52df46864a7815b8.svg";const bottom_snake_flip=__webpack_require__.p+"static/media/bottom-snake-flip.31c9ebc7594a96a686cf410bc65371dd.svg";const left=__webpack_require__.p+"static/media/left.6fc7083f4cd641bf654b08a26f944457.svg";const left_snake=__webpack_require__.p+"static/media/left-snake.77e313afd0b58fc57bc1b98df60eacfd.svg";const left_flip=__webpack_require__.p+"static/media/left-flip.e480ec339cb34df32d7412153a07216e.svg";const left_snake_flip=__webpack_require__.p+"static/media/left-snake-flip.866a1a9f220801e888735cdfa6f22698.svg";const assets_top=__webpack_require__.p+"static/media/top.6afc5413907a8835fb28c65c2927530e.svg";const top_right=__webpack_require__.p+"static/media/top-right.743c4f79f4eccef25cf772c7665c2cf7.svg";const bottom_right=__webpack_require__.p+"static/media/bottom-right.4dce284267cee3a5fd26be79e2f0150f.svg";const bottom_left=__webpack_require__.p+"static/media/bottom-left.c848fedc2cf975a03639f873c701251d.svg";const top_left=__webpack_require__.p+"static/media/top-left.aa14327ce1c00dde7d5e0e2556542ebf.svg";const top_snake=__webpack_require__.p+"static/media/top-snake.855c837598a62a68d139910f0e0b9ba4.svg";const top_flip=__webpack_require__.p+"static/media/top-flip.16c423f83594173bc5d78a0345983929.svg";const top_snake_flip=__webpack_require__.p+"static/media/top-snake-flip.4ac4f4730616467aeaf4461771bfa2cc.svg",MFillSelector=_ref=>{let{direction,onChange}=_ref;return(0,jsx_runtime.jsx)(BladeFrame.A,{title:"Fill Direction",full:!1,style:{marginBottom:"1rem"},children:(0,jsx_runtime.jsxs)(Select.A,{value:direction,variant:"standard",fullWidth:!0,MenuProps:{PaperProps:{style:{maxHeight:300}}},onChange:e=>onChange(e.target.value),children:[(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"right",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:right,alt:"rightSnake"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"right-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:right_flip,alt:"rightFlip"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"right-snake",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:right_snake,alt:"rightSnake"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"right-snake-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:right_snake_flip,alt:"rightSnakeFlip"})]})}),(0,jsx_runtime.jsx)(Divider.A,{}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"bottom",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:bottom,alt:"bottomSnake"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"bottom-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:bottom_flip,alt:"bottomSnakeFlip"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"bottom-snake",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:bottom_snake,alt:"bottomSnake"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"bottom-snake-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:bottom_snake_flip,alt:"bottomSnakeFlip"})]})}),(0,jsx_runtime.jsx)(Divider.A,{}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"left-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:left_flip,alt:"leftFlip"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"left",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:left,alt:"left"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"left-snake",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:left_snake,alt:"leftSnake"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"left-snake-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:left_snake_flip,alt:"leftSnakeFlip"})]})}),(0,jsx_runtime.jsx)(Divider.A,{}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"top",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:assets_top,alt:"top"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"top-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Linear",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:top_flip,alt:"topFlip"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"top-snake",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:top_snake,alt:"topSnake"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"top-snake-flip",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Snake",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:top_snake_flip,alt:"topSnakeFlip"})]})}),(0,jsx_runtime.jsx)(Divider.A,{}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"diagonal-top-right",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Diagonal",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:top_right,alt:"topRight"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"diagonal-bottom-right",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Diagonal",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Right",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:bottom_right,alt:"bottomRight"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"diagonal-bottom-left",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Diagonal",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Down",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:bottom_left,alt:"bottomLeft"})]})}),(0,jsx_runtime.jsx)(MenuItem.A,{sx:{justifyContent:"space-between"},value:"diagonal-top-left",children:(0,jsx_runtime.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("div",{children:["Diagonal",(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Up",variant:"outlined"}),(0,jsx_runtime.jsx)(Chip.A,{size:"small",label:"Left",variant:"outlined"})]}),(0,jsx_runtime.jsx)("img",{width:"30px",src:top_left,alt:"topLeft"})]})})]})})},EditMatrix_MFillSelector=MFillSelector;try{MFillSelector.displayName="MFillSelector",MFillSelector.__docgenInfo={description:"",displayName:"MFillSelector",props:{direction:{defaultValue:null,description:"",name:"direction",required:!0,type:{name:"enum",value:[{value:'"bottom"'},{value:'"top"'},{value:'"left"'},{value:'"right"'},{value:'"right-snake"'},{value:'"right-flip"'},{value:'"right-snake-flip"'},{value:'"left-snake"'},{value:'"left-flip"'},{value:'"left-snake-flip"'},{value:'"top-snake"'},{value:'"top-flip"'},{value:'"top-snake-flip"'},{value:'"bottom-snake"'},{value:'"bottom-flip"'},{value:'"bottom-snake-flip"'}]}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/EditMatrix/MFillSelector.tsx#MFillSelector"]={docgenInfo:MFillSelector.__docgenInfo,name:"MFillSelector",path:"src/pages/Devices/EditVirtuals/EditMatrix/MFillSelector.tsx#MFillSelector"})}catch(__react_docgen_typescript_loader_error){}const MSlider=_ref=>{let{group,devices,currentDevice,selectedPixel,handleSliderChange}=_ref;return(0,jsx_runtime.jsx)(BladeFrame.A,{title:"Pixel"+(group?"s":""),full:!1,style:{marginBottom:"1rem"},children:(0,jsx_runtime.jsxs)(Stack.A,{direction:"column",spacing:2,flex:1,minHeight:120,justifyContent:"space-between",children:[(0,jsx_runtime.jsx)(Slider.Ay,{marks:[{value:0,label:"0"},{value:devices[currentDevice].config.pixel_count,label:devices[currentDevice].config.pixel_count}],valueLabelDisplay:"auto",min:0,max:devices[currentDevice].config.pixel_count,value:selectedPixel,onChange:handleSliderChange}),"number"==typeof selectedPixel?(0,jsx_runtime.jsx)(TextField.A,{type:"number",variant:"outlined",value:selectedPixel,onChange:e=>handleSliderChange(e,parseInt(e.target.value))}):(0,jsx_runtime.jsxs)(Stack.A,{direction:"row",spacing:2,children:[(0,jsx_runtime.jsx)(TextField.A,{type:"number",variant:"outlined",value:selectedPixel[0],onBlur:e=>handleSliderChange(e,[parseInt(e.target.value),selectedPixel[1]],0)}),(0,jsx_runtime.jsx)(TextField.A,{type:"number",variant:"outlined",value:selectedPixel[1],onBlur:e=>handleSliderChange(e,[selectedPixel[0],parseInt(e.target.value)],1)})]})]})})},EditMatrix_MSlider=MSlider;try{MSlider.displayName="MSlider",MSlider.__docgenInfo={description:"",displayName:"MSlider",props:{group:{defaultValue:null,description:"",name:"group",required:!0,type:{name:"boolean"}},devices:{defaultValue:null,description:"",name:"devices",required:!0,type:{name:"any"}},selectedPixel:{defaultValue:null,description:"",name:"selectedPixel",required:!0,type:{name:"number | number[]"}},currentDevice:{defaultValue:null,description:"",name:"currentDevice",required:!0,type:{name:"any"}},handleSliderChange:{defaultValue:null,description:"",name:"handleSliderChange",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/EditMatrix/MSlider.tsx#MSlider"]={docgenInfo:MSlider.__docgenInfo,name:"MSlider",path:"src/pages/Devices/EditVirtuals/EditMatrix/MSlider.tsx#MSlider"})}catch(__react_docgen_typescript_loader_error){}const Actions_assignPixels=_ref=>{let{m,rowN,colN,currentCell,currentDevice,selectedPixel,direction,setM,closeClear,pixelGroups,setPixelGroups}=_ref,updatedM=clone(m);const[col,row]=currentCell;if("number"==typeof selectedPixel)updatedM[row][col]={deviceId:currentDevice,pixel:selectedPixel,group:`${row}-${col}`};else for(let index=0;index<=Math.abs(selectedPixel[1]-selectedPixel[0]);index+=1){const newM={deviceId:currentDevice,pixel:Math.min(selectedPixel[0],selectedPixel[1])+index,group:`${row}-${col}`};if(direction.includes("diagonal-top-right"))for(let index=0;index<=Math.abs(selectedPixel[1]-selectedPixel[0])&&row-index>=0&&col+index<colN;index++){const newM={deviceId:currentDevice,pixel:Math.min(selectedPixel[0],selectedPixel[1])+index,group:`${row}-${col}`};updatedM[row-index][col+index]=newM}else if(direction.includes("diagonal-bottom-right"))for(let index=0;index<=Math.abs(selectedPixel[1]-selectedPixel[0])&&row+index<rowN&&col+index<colN;index++){const newM={deviceId:currentDevice,pixel:Math.min(selectedPixel[0],selectedPixel[1])+index,group:`${row}-${col}`};updatedM[row+index][col+index]=newM}else if(direction.includes("diagonal-bottom-left"))for(let index=0;index<=Math.abs(selectedPixel[1]-selectedPixel[0])&&row+index<rowN&&col-index>=0;index++){const newM={deviceId:currentDevice,pixel:Math.min(selectedPixel[0],selectedPixel[1])+index,group:`${row}-${col}`};updatedM[row+index][col-index]=newM}else if(direction.includes("diagonal-top-left"))for(let index=0;index<=Math.abs(selectedPixel[1]-selectedPixel[0])&&row-index>=0&&col-index>=0;index++){const newM={deviceId:currentDevice,pixel:Math.min(selectedPixel[0],selectedPixel[1])+index,group:`${row}-${col}`};updatedM[row-index][col-index]=newM}else direction.includes("right")?direction.includes("flip")?updatedM[row-Math.floor((index+col)/colN)][(index+col)%colN]=newM:updatedM[row+Math.floor((index+col)/colN)][(index+col)%colN]=newM:direction.includes("bottom")?direction.includes("flip")?updatedM[(index+row)%rowN][col-Math.floor((index+row)/rowN)]=newM:updatedM[(index+row)%rowN][col+Math.floor((index+row)/rowN)]=newM:direction.includes("left")?direction.includes("flip")?updatedM[row+Math.abs(Math.floor((col-index)/colN))][(colN+(col-index)%colN)%colN]=newM:updatedM[row-Math.abs(Math.floor((col-index)/colN))][(colN+(col-index)%colN)%colN]=newM:direction.includes("top")&&(direction.includes("flip")?updatedM[(rowN+(row-index)%rowN)%rowN][col+Math.abs(Math.floor((row-index)/rowN))]=newM:updatedM[(rowN+(row-index)%rowN)%rowN][col-Math.abs(Math.floor((row-index)/rowN))]=newM)}if(direction.includes("right-snake"))if(direction.includes("flip"))for(let i=row;i>=0;i-=1){const currentRow=[...updatedM[i]];(i+row)%2==1&&(updatedM[i]=currentRow.reverse())}else for(let i=row;i<rowN;i+=1){const currentRow=[...updatedM[i]];(i+row)%2==1&&(updatedM[i]=currentRow.reverse())}if(direction.includes("bottom-snake"))if(direction.includes("flip")){const mat=clone(updatedM),temp=(0,helpers.mg)(mat);for(let i=col;i>=0;i-=1){const currentCol=[...temp[i]];(i+col)%2==1&&(temp[i]=currentCol.reverse())}updatedM=(0,helpers.mg)(temp)}else{const mat=clone(updatedM),temp=(0,helpers.mg)(mat);for(let i=col;i<colN;i+=1){const currentCol=[...temp[i]];(i+col)%2==1&&(temp[i]=currentCol.reverse())}updatedM=(0,helpers.mg)(temp)}if(direction.includes("left-snake"))if(direction.includes("flip"))for(let i=row;i<rowN;i+=1){const currentRow=[...updatedM[i]];(i+row)%2==1&&(updatedM[i]=currentRow.reverse())}else for(let i=row;i>=0;i-=1){const currentRow=[...updatedM[i]];(i+row)%2==1&&(updatedM[i]=currentRow.reverse())}if(direction.includes("top-snake"))if(direction.includes("flip")){const mat=clone(updatedM),temp=(0,helpers.mg)(mat);for(let i=col;i<colN;i+=1){const currentCol=[...temp[i]];(i+col)%2==1&&(temp[i]=currentCol.reverse())}updatedM=(0,helpers.mg)(temp)}else{const mat=clone(updatedM),temp=(0,helpers.mg)(mat);for(let i=col;i>=0;i-=1){const currentCol=[...temp[i]];(i+col)%2==1&&(temp[i]=currentCol.reverse())}updatedM=(0,helpers.mg)(temp)}setPixelGroups(pixelGroups+1),setM(updatedM),closeClear()},AssignPixelDialog=_ref=>{let{open,closeClear,currentCell,m,currentDevice,setCurrentDevice,deviceRef,group,setGroup,direction,handleDirectionChange,selectedPixel,handleSliderChange,rowN,colN,setM,pixelGroups,setPixelGroups,clearPixel}=_ref;const devices=(0,useStore.A)((state=>state.devices));return(0,jsx_runtime.jsxs)(Dialog.A,{onClose:()=>closeClear(),open,PaperProps:{sx:{width:"100%",maxWidth:320}},children:[(0,jsx_runtime.jsx)(EditMatrix_MDialogTitle,{currentCell,m}),(0,jsx_runtime.jsxs)(DialogContent.A,{children:[(0,jsx_runtime.jsx)(BladeFrame.A,{title:"Device",style:{marginBottom:"1rem"},children:(0,jsx_runtime.jsx)(Select.A,{value:currentDevice,onChange:e=>setCurrentDevice(e.target.value||""),inputRef:deviceRef,variant:"standard",fullWidth:!0,children:devices&&Object.keys(devices).map(((d,i)=>(0,jsx_runtime.jsx)(MenuItem.A,{value:devices[d].id,children:devices[d].config.name},i)))})}),currentDevice&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(EditMatrix_MSwitch,{group,setGroup}),group&&(0,jsx_runtime.jsx)(EditMatrix_MFillSelector,{direction,onChange:handleDirectionChange}),(0,jsx_runtime.jsx)(EditMatrix_MSlider,{group,devices,currentDevice,selectedPixel,handleSliderChange})]})]}),(0,jsx_runtime.jsxs)(DialogActions.A,{children:[(0,jsx_runtime.jsx)(Button.A,{onClick:()=>clearPixel(),children:"Clear"}),(0,jsx_runtime.jsx)(Button.A,{onClick:()=>Actions_assignPixels({m,rowN,colN,currentCell,currentDevice,selectedPixel,direction,setM,closeClear,pixelGroups,setPixelGroups}),children:"Save"})]})]})},EditMatrix_AssignPixelDialog=AssignPixelDialog;try{AssignPixelDialog.displayName="AssignPixelDialog",AssignPixelDialog.__docgenInfo={description:"",displayName:"AssignPixelDialog",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},closeClear:{defaultValue:null,description:"",name:"closeClear",required:!0,type:{name:"any"}},currentCell:{defaultValue:null,description:"",name:"currentCell",required:!0,type:{name:"[number, number]"}},m:{defaultValue:null,description:"",name:"m",required:!0,type:{name:"any"}},currentDevice:{defaultValue:null,description:"",name:"currentDevice",required:!0,type:{name:"string"}},setCurrentDevice:{defaultValue:null,description:"",name:"setCurrentDevice",required:!0,type:{name:"any"}},deviceRef:{defaultValue:null,description:"",name:"deviceRef",required:!0,type:{name:"any"}},group:{defaultValue:null,description:"",name:"group",required:!0,type:{name:"boolean"}},setGroup:{defaultValue:null,description:"",name:"setGroup",required:!0,type:{name:"any"}},direction:{defaultValue:null,description:"",name:"direction",required:!0,type:{name:"enum",value:[{value:'"bottom"'},{value:'"top"'},{value:'"left"'},{value:'"right"'},{value:'"right-snake"'},{value:'"right-flip"'},{value:'"right-snake-flip"'},{value:'"left-snake"'},{value:'"left-flip"'},{value:'"left-snake-flip"'},{value:'"top-snake"'},{value:'"top-flip"'},{value:'"top-snake-flip"'},{value:'"bottom-snake"'},{value:'"bottom-flip"'},{value:'"bottom-snake-flip"'}]}},handleDirectionChange:{defaultValue:null,description:"",name:"handleDirectionChange",required:!0,type:{name:"any"}},selectedPixel:{defaultValue:null,description:"",name:"selectedPixel",required:!0,type:{name:"number | number[]"}},handleSliderChange:{defaultValue:null,description:"",name:"handleSliderChange",required:!0,type:{name:"any"}},rowN:{defaultValue:null,description:"",name:"rowN",required:!0,type:{name:"number"}},colN:{defaultValue:null,description:"",name:"colN",required:!0,type:{name:"number"}},setM:{defaultValue:null,description:"",name:"setM",required:!0,type:{name:"any"}},pixelGroups:{defaultValue:null,description:"",name:"pixelGroups",required:!0,type:{name:"any"}},setPixelGroups:{defaultValue:null,description:"",name:"setPixelGroups",required:!0,type:{name:"any"}},clearPixel:{defaultValue:null,description:"",name:"clearPixel",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/EditMatrix/AssignPixelDialog.tsx#AssignPixelDialog"]={docgenInfo:AssignPixelDialog.__docgenInfo,name:"AssignPixelDialog",path:"src/pages/Devices/EditVirtuals/EditMatrix/AssignPixelDialog.tsx#AssignPixelDialog"})}catch(__react_docgen_typescript_loader_error){}const EditMatrix_M=_ref=>{let{virtual}=_ref;const classes=M_styles(),theme=(0,useTheme.A)(),deviceRef=(0,react.useRef)(null),devices=(0,useStore.A)((state=>state.devices)),mode=(0,useStore.A)((state=>state.config)).transmission_mode,addDevice=(0,useStore.A)((state=>state.addDevice)),getDevices=(0,useStore.A)((state=>state.getDevices)),getVirtuals=(0,useStore.A)((state=>state.getVirtuals)),updateVirtual=(0,useStore.A)((state=>state.updateVirtual)),setEffect=(0,useStore.A)((state=>state.setEffect)),points=(0,useStore.A)((state=>state.points)),[error,setError]=(0,react.useState)([]),[currentDevice,setCurrentDevice]=(0,react.useState)(""),[rowN,setRowNumber]=(0,react.useState)(virtual.config.rows||8),[colN,setColNumber]=(0,react.useState)(Math.ceil(virtual.pixel_count/(virtual.config.rows||1))||8),[currentCell,setCurrentCell]=(0,react.useState)([-1,-1]),[open,setOpen]=(0,react.useState)(!1),[group,setGroup]=(0,react.useState)(!1),[selectedPixel,setSelectedPixel]=(0,react.useState)(0),[direction,setDirection]=(0,react.useState)("right"),[m,setM]=(0,react.useState)(Array(rowN).fill(Array(colN).fill(MCell))),[pixelGroups,setPixelGroups]=(0,react.useState)(0),[selectedGroup,setSelectedGroup]=(0,react.useState)("0-0"),[pixels,setPixels]=(0,react.useState)([]),[move,setMove]=(0,react.useState)(!1),[dnd,setDnd]=(0,react.useState)(!1),[anchorEl,setAnchorEl]=(0,react.useState)(null),[isDragging,setIsDragging]=(0,react.useState)(!1),[hoveringCell,setHoveringCell]=(0,react.useState)([-1,-1]),decodedPixels="compressed"===mode?pixels&&pixels.length&&Actions_hexColor(pixels,mode):pixels,handleContextMenu=(e,currentColIndex,currentRowIndex,yzcolumn)=>{var _m$currentRowIndex$cu;(e.preventDefault(),e.stopPropagation(),setCurrentCell([currentColIndex,currentRowIndex]),setCurrentDevice(""!==yzcolumn.deviceId?yzcolumn.deviceId:""),setSelectedPixel(yzcolumn.pixel||0),currentRowIndex>-1&&currentColIndex>-1)&&(""!==(null===(_m$currentRowIndex$cu=m[currentRowIndex][currentColIndex])||void 0===_m$currentRowIndex$cu?void 0:_m$currentRowIndex$cu.deviceId)?setAnchorEl(e.currentTarget):setOpen(!0))},closeClear=()=>{setOpen(!1),setCurrentDevice(""),setSelectedPixel(0),setGroup(!1)},clearPixel=()=>{const updatedM=clone(m),[col,row]=currentCell;updatedM[row][col]={deviceId:"",pixel:0,group:0},setM(updatedM),closeClear()};return(0,react.useEffect)((()=>{group?"number"==typeof selectedPixel&&setSelectedPixel([selectedPixel,selectedPixel+1]):"number"!=typeof selectedPixel&&setSelectedPixel(selectedPixel[0])}),[group,selectedPixel]),(0,react.useEffect)((()=>{setM(Array(rowN).fill(Array(colN).fill(MCell)))}),[rowN,colN]),(0,react.useEffect)((()=>{0===virtual.segments.length&&(Object.values(devices).some((d=>d.id===`gap-${virtual.id}`))||addDevice({type:"dummy",config:{center_offset:0,icon_name:"mdi:eye-off",name:`gap-${virtual.id}`,pixel_count:4096,refresh_rate:64}}).then((()=>{(0,ledfx.U)(`/api/virtuals/${virtual.id}`,"POST",{segments:[[`gap-${virtual.id}`,0,virtual.config.rows*virtual.config.rows-1,!1]]}).then((()=>{getDevices(),getVirtuals().then((()=>{setEffect(virtual.id,"equalizer2d",{bands:virtual.config.rows},!0).then((()=>{updateVirtual(virtual.id,!0)}))}))}))})))}),[]),(0,react.useEffect)((()=>{setRowNumber(virtual.config.rows||8),setColNumber(Math.ceil(virtual.pixel_count/(virtual.config.rows||1))||8)}),[virtual]),(0,react.useEffect)((()=>{if(points.length>0){const updatedM=clone(m),p=points[points.length-1];!isNaN(p.x)&&!isNaN(p.y)&&p.x>0&&p.y>0&&p.x<=colN&&p.y<=rowN&&(updatedM[p.y-1][p.x-1]={deviceId:p.device,pixel:p.led,group:p.segment+1},setM(updatedM))}}),[points]),(0,jsx_runtime.jsxs)(EditMatrix_MWrapper,{move:dnd,children:[(0,jsx_runtime.jsx)(Stack.A,{direction:"column",spacing:2,bgcolor:theme.palette.action.disabledBackground,sx:{overflowY:"scroll",height:"100%",overflowX:"hidden",minWidth:440,paddingTop:"1rem"},children:(0,jsx_runtime.jsx)(EditMatrix_MControls,{dnd,setDnd,rowN,colN,setRowNumber,setColNumber,virtual,m,setM,move,setMove,selectedGroup,setError,setPixels})}),(0,jsx_runtime.jsx)(Box.A,{sx:{flexGrow:1,overflow:"hidden",height:"100%"},children:(0,jsx_runtime.jsx)(index_esm.GT,{disabled:dnd,centerZoomedOut:!0,minScale:.1,initialScale:100*colN<window.innerWidth||100*rowN<.8*window.innerHeight?1:.1,children:(0,jsx_runtime.jsx)(index_esm.WZ,{children:(0,jsx_runtime.jsxs)("div",{className:classes.gridCellContainer,style:{width:100*colN,height:100*rowN},children:[(0,jsx_runtime.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(0,jsx_runtime.jsx)(core_esm.Mp,{modifiers:[modifiers_esm.Mk],onDragEnd:e=>(event=>{if(event.over&&event.over.id){const updatedM=clone(m),[xOver,yOver]=event.over.id.split("-").map(Number);if(""===updatedM[yOver][xOver].deviceId){const[xActive,yActive]=event.active.id.split("-").map(Number);updatedM[yOver][xOver]=updatedM[yActive][xActive],updatedM[yActive][xActive]={deviceId:"",pixel:0,group:0},setM(updatedM)}}setIsDragging(!1)})(e),onDragOver:e=>{var _e$over,_e$over$id;return setHoveringCell((null===(_e$over=e.over)||void 0===_e$over||null===(_e$over$id=_e$over.id)||void 0===_e$over$id?void 0:_e$over$id.split("-").map(Number))||[-1,-1])},onDragStart:()=>{setIsDragging(!0)},children:m.map(((yzrow,currentRowIndex)=>(0,jsx_runtime.jsx)("div",{style:{display:"flex"},children:yzrow.map(((yzcolumn,currentColIndex)=>{const bg=((mode,decodedPixels,pixels,currentRowIndex,colN,currentColIndex)=>"compressed"===mode&&decodedPixels?decodedPixels[currentRowIndex*colN+currentColIndex]?`rgb(${Object.values(decodedPixels[currentRowIndex*colN+currentColIndex])})`:"#222":pixels&&pixels[0]&&pixels[0].length?`rgb(${pixels[0][currentRowIndex*colN+currentColIndex]},${pixels[1][currentRowIndex*colN+currentColIndex]},${pixels[2][currentRowIndex*colN+currentColIndex]})`:"#222")(mode,decodedPixels,pixels,currentRowIndex,colN,currentColIndex),op=((move,yzcolumn,selectedGroup)=>move&&(null==yzcolumn?void 0:yzcolumn.group)===selectedGroup?1:move&&(null==yzcolumn?void 0:yzcolumn.group)!==selectedGroup||""===selectedGroup?.3:""!==yzcolumn.deviceId?1:.3)(move,yzcolumn,selectedGroup);return(0,jsx_runtime.jsx)(EditMatrix_Droppable,{cell:hoveringCell[0]>-1&&hoveringCell[1]>-1?m[hoveringCell[1]][hoveringCell[0]]:void 0,id:`${currentColIndex}-${currentRowIndex}`,bg,opacity:op,onContextMenu:e=>handleContextMenu(e,currentColIndex,currentRowIndex,yzcolumn),children:(0,jsx_runtime.jsx)(Box.A,{onContextMenu:e=>handleContextMenu(e,currentColIndex,currentRowIndex,yzcolumn),sx:{backgroundColor:bg,opacity:op},children:dnd?""!==m[currentRowIndex][currentColIndex].deviceId?(0,jsx_runtime.jsx)(EditMatrix_Draggable,{m,id:`${currentRowIndex}-${currentColIndex}`,children:(0,jsx_runtime.jsx)(EditMatrix_Pixel,{m,currentColIndex,classes,currentRowIndex,move,decodedPixels,colN,pixels,yzcolumn,selectedGroup,error,setCurrentCell,setCurrentDevice,setSelectedPixel,openContextMenu:e=>setAnchorEl(e.currentTarget),isDragging})}):null:(0,jsx_runtime.jsx)(EditMatrix_Pixel,{m,currentColIndex,classes,currentRowIndex,move,decodedPixels,colN,pixels,yzcolumn,selectedGroup,error,setCurrentCell,setCurrentDevice,setSelectedPixel,openContextMenu:e=>setAnchorEl(e.currentTarget),isDragging})},`col-${currentColIndex}`)},`col-${currentColIndex}`)}))},`row-${currentRowIndex}`)))})}),(0,jsx_runtime.jsx)(EditMatrix_MContextMenu,{setDnd,setSelectedGroup,anchorEl,closeContextMenu:()=>setAnchorEl(null),currentCell,m,setOpen,setMove,clearPixel,clearPixelGroup:group=>{const updatedM=clone(m);m.forEach(((row,rowIndex)=>{row.forEach(((cell,colIndex)=>{cell.group===group&&(updatedM[rowIndex][colIndex]={deviceId:"",pixel:0,group:0})}))})),setM(updatedM)}}),(0,jsx_runtime.jsx)(EditMatrix_AssignPixelDialog,{open,closeClear,currentCell,m,setCurrentDevice,deviceRef,group,setGroup,direction,handleDirectionChange:d=>{if(setDirection(d),"number"!=typeof selectedPixel){const[col,row]=currentCell,maxRange=getMaxRange(direction,row,col,rowN,colN);selectedPixel[1]-selectedPixel[0]>maxRange&&setSelectedPixel([selectedPixel[0],selectedPixel[0]+maxRange])}},selectedPixel,handleSliderChange:(e,newPixelRange,activeThumb)=>{if("number"!=typeof newPixelRange){const[col,row]=currentCell,maxRange=getMaxRange(direction,row,col,rowN,colN),distance=Math.abs(newPixelRange[1]-newPixelRange[0]);let adjustedLeftThumb=newPixelRange[0],adjustedRightThumb=newPixelRange[1];distance>maxRange&&(0===activeThumb?adjustedRightThumb=adjustedLeftThumb+maxRange:adjustedLeftThumb=adjustedRightThumb-maxRange);setSelectedPixel("top"===direction?[adjustedRightThumb,adjustedLeftThumb]:[adjustedLeftThumb,adjustedRightThumb])}else setSelectedPixel(newPixelRange)},clearPixel,setM,currentDevice,pixelGroups,setPixelGroups,rowN,colN})]})})})})]})};try{M.displayName="M",M.__docgenInfo={description:"",displayName:"M",props:{virtual:{defaultValue:null,description:"",name:"virtual",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/EditMatrix/M.tsx#M"]={docgenInfo:M.__docgenInfo,name:"M",path:"src/pages/Devices/EditVirtuals/EditMatrix/M.tsx#M"})}catch(__react_docgen_typescript_loader_error){}var BladeIcon=__webpack_require__("./src/components/Icons/BladeIcon/BladeIcon.tsx"),reactour_esm=__webpack_require__("./node_modules/reactour/dist/reactour.esm.js"),Help=__webpack_require__("./node_modules/@mui/icons-material/esm/Help.js");const steps=[{selector:".step-2d-virtual-one",content:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h2",{children:"2D Virtuals"}),"Some Intro Text for 2D Virtuals"]}),style:{backgroundColor:"#303030"}},{selector:".step-2d-virtual-two",content:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h2",{children:"Explain"}),"import from segments and show pixel graph"]}),style:{backgroundColor:"#303030"}},{selector:".step-2d-virtual-three",content:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h2",{children:"Explain"}),"Rows & Cols"]}),style:{backgroundColor:"#303030"}},{selector:".step-2d-virtual-four",content:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h2",{children:"Dummy Headline"}),"Dummy Text"]}),style:{backgroundColor:"#303030"}},{selector:".step-2d-virtual-five",content:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h2",{children:"Dummy Headline"}),"Dummy Text"]}),style:{backgroundColor:"#303030"}},{selector:".step-2d-virtual-six",content:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h2",{children:"Dummy Headline"}),"Dummy Text"]}),style:{backgroundColor:"#303030"}},{selector:".step-2d-virtual-seven",content:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h2",{children:"Dummy Headline"}),"Dummy Text"]}),style:{backgroundColor:"#303030"}},{selector:".step-2d-virtual-eight",content:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h2",{children:"Dummy Headline"}),"Dummy Text"]}),style:{backgroundColor:"#303030"}},{selector:".step-2d-virtual-nine",content:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h2",{children:"Initialze"}),"Dummy Text"]}),style:{backgroundColor:"#303030"}},{selector:".step-2d-virtual-ten",content:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h2",{children:"Adjust"}),"Dummy Text"]}),style:{backgroundColor:"#303030"}},{selector:".step-2d-virtual-eleven",content:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h2",{children:"Calibrate"}),"Dummy Text"]}),style:{backgroundColor:"#303030"}},{selector:".step-2d-virtual-twelve",content:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h2",{children:"Crop"}),"Dummy Text"]}),style:{backgroundColor:"#303030"}},{selector:".step-2d-virtual-thirteen",content:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h2",{children:"Led, brightness, threshold"}),"Dummy Text"]}),style:{backgroundColor:"#303030"}}],Tours_Tour2dVirtual=()=>{const[isTourOpen,setIsTourOpen]=(0,react.useState)(!1),setTour=(0,useStore.A)((state=>state.setTour)),features=(0,useStore.A)((state=>state.features)),theme=(0,useTheme.A)();return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Tooltip.A,{title:"How to use 2D Virtuals",children:(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>{setIsTourOpen(!0),setTour("2d-virtual")},children:(0,jsx_runtime.jsx)(Help.A,{})})}),(0,jsx_runtime.jsx)(reactour_esm.Ay,{steps:steps.slice(0,features.matrix_cam?steps.length:5),accentColor:theme.palette.primary.main,isOpen:isTourOpen,showNavigation:!1,onRequestClose:()=>setIsTourOpen(!1),showNumber:!1})]})},Transition=react.forwardRef((function Transition(props,ref){return(0,jsx_runtime.jsx)(Slide.A,{direction:"up",ref,...props})})),MuiMenuItem=react.forwardRef(((props,ref)=>{const{children}=props;return(0,jsx_runtime.jsx)(MenuItem.A,{ref,...props,children})}));function EditVirtuals(_ref){var _virtual$segments;let{virtId,icon=(0,jsx_runtime.jsx)(esm_Settings.A,{}),startIcon,label="",type,className,color="inherit",variant="contained",onClick=()=>{},innerKey}=_ref;const[matrix,setMatrix]=(0,react.useState)(!1),currentVirtual=(0,useStore.A)((state=>state.currentVirtual)),setCurrentVirtual=(0,useStore.A)((state=>state.setCurrentVirtual)),calibrationMode=(0,useStore.A)((state=>state.calibrationMode)),classes=EditVirtuals_styles(),showSnackbar=(0,useStore.A)((state=>state.ui.showSnackbar)),getDevices=(0,useStore.A)((state=>state.getDevices)),virtuals=(0,useStore.A)((state=>state.virtuals)),setDialogOpenEditVirtual=(0,useStore.A)((state=>state.setDialogOpenEditVirtual)),activeSegment=(0,useStore.A)((state=>state.activeSegment)),highlightSegment=(0,useStore.A)((state=>state.highlightSegment)),virtual=virtuals[currentVirtual||virtId],[open,setOpen]=react.useState(!!currentVirtual||!1),[calib,setCalib]=react.useState(!0),handleClickOpen=()=>{setOpen(!0)},handleClose=()=>{const output=(0,helpers.i5)(virtual.segments),overlap=Object.keys(output).find((k=>output[k].overlap));overlap?showSnackbar("warning",`Overlapping in ${overlap} detected! Please Check your config`):(setOpen(!1),setDialogOpenEditVirtual(!1),setCurrentVirtual(null),onClick())};return(0,react.useEffect)((()=>{getDevices()}),[getDevices]),(0,react.useEffect)((()=>{currentVirtual&&"hidden"===type&&setOpen(!0)}),[currentVirtual]),(0,react.useEffect)((()=>(null!=virtual&&virtual.id&&open&&calibrationMode(null==virtual?void 0:virtual.id,"on"),()=>{null!=virtual&&virtual.id&&open&&calibrationMode(null==virtual?void 0:virtual.id,"off")})),[null==virtual?void 0:virtual.id,open]),virtual&&virtual.config?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["menuItem"===type?(0,jsx_runtime.jsxs)(MuiMenuItem,{className,onClick:e=>{e.preventDefault(),handleClickOpen()},children:[(0,jsx_runtime.jsx)(ListItemIcon.A,{children:icon}),label]},innerKey):"hidden"===type?null:(0,jsx_runtime.jsxs)(Button.A,{variant,startIcon,color,onClick:()=>{handleClickOpen()},size:"small",className,children:[label,!startIcon&&icon]}),(0,jsx_runtime.jsxs)(Dialog.A,{fullScreen:!0,open,onClose:handleClose,TransitionComponent:Transition,children:[(0,jsx_runtime.jsx)(AppBar.A,{enableColorOnDark:!0,className:classes.appBar,children:(0,jsx_runtime.jsxs)(Toolbar.A,{children:[(0,jsx_runtime.jsx)(Button.A,{autoFocus:!0,color:"primary",variant:"contained",startIcon:(0,jsx_runtime.jsx)(NavigateBefore.A,{}),onClick:handleClose,style:{marginRight:"1rem"},children:"back"}),virtual.config.rows>1&&(0,jsx_runtime.jsxs)(ToggleButtonGroup.A,{value:matrix,style:{marginRight:"1rem"},size:"small",exclusive:!0,onChange:()=>setMatrix(!matrix),"aria-label":"mode",children:[(0,jsx_runtime.jsx)(ToggleButton.A,{value:!1,children:(0,jsx_runtime.jsx)(BladeIcon.A,{name:"mdi:led-strip"})}),(0,jsx_runtime.jsx)(ToggleButton.A,{value:!0,children:(0,jsx_runtime.jsx)(GridOn.A,{})})]}),(0,jsx_runtime.jsxs)(Typography.A,{variant:"h6",className:classes.title,children:[virtual.config.name," "]}),(0,jsx_runtime.jsx)(Tours_Tour2dVirtual,{}),(0,jsx_runtime.jsx)(Tooltip.A,{title:"Preview Effect",children:(0,jsx_runtime.jsx)(IconButton.A,{onClick:()=>{calibrationMode(null==virtual?void 0:virtual.id,calib?"off":"on"),!calib&&virtual.segments[activeSegment]&&highlightSegment(virtual.id,virtual.segments[activeSegment][0],virtual.segments[activeSegment][1],virtual.segments[activeSegment][2],virtual.segments[activeSegment][3]),setCalib(!calib)},children:calib?(0,jsx_runtime.jsx)(esm_Visibility.A,{}):(0,jsx_runtime.jsx)(VisibilityOff.A,{})})})]})}),matrix?(0,jsx_runtime.jsx)(EditMatrix_M,{virtual}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:classes.segmentTitle,children:(0,jsx_runtime.jsx)(Typography.A,{variant:"caption",children:"Segments-Settings"})}),(null===(_virtual$segments=virtual.segments)||void 0===_virtual$segments?void 0:_virtual$segments.length)>0&&virtual.segments.map(((s,i)=>(0,jsx_runtime.jsx)(EditVirtuals_Segment,{s,i,virtual,segments:virtual.segments,calib},i))),(0,jsx_runtime.jsx)("div",{className:classes.segmentButtonWrapper,children:(0,jsx_runtime.jsx)(ConfirmationDialog,{virtual})})]})]})]}):null}try{EditVirtuals.displayName="EditVirtuals",EditVirtuals.__docgenInfo={description:"",displayName:"EditVirtuals",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/EditVirtuals/EditVirtuals.tsx#EditVirtuals"]={docgenInfo:EditVirtuals.__docgenInfo,name:"EditVirtuals",path:"src/pages/Devices/EditVirtuals/EditVirtuals.tsx#EditVirtuals"})}catch(__react_docgen_typescript_loader_error){}const PixelGraph=_ref=>{var _devices$virtuals$vir,_devices$virtuals$vir2;let{virtId,dummy=!1,className="",active=!1,intGraphs=!1,showMatrix=!1,fullScreen=!1}=_ref;const[pixels,setPixels]=(0,react.useState)([]),{pixelGraphs,virtuals,devices,graphs,config}=(0,useStore.A)((state=>({pixelGraphs:state.pixelGraphs,virtuals:state.virtuals,devices:state.devices,graphs:state.graphs,config:state.config}))),rows=virtuals[virtId].is_device?(null===(_devices$virtuals$vir=devices[virtuals[virtId].is_device])||void 0===_devices$virtuals$vir||null===(_devices$virtuals$vir2=_devices$virtuals$vir.config)||void 0===_devices$virtuals$vir2?void 0:_devices$virtuals$vir2.rows)||virtuals[virtId].config.rows||1:virtuals[virtId].config.rows||1,decodedPixels="compressed"===config.transmission_mode?pixels&&pixels.length&&Actions_hexColor(pixels,config.transmission_mode):pixels;(0,react.useEffect)((()=>{const handleWebsockets=e=>{e.detail.id===virtId&&setPixels(e.detail.pixels)};return document.addEventListener("visualisation_update",handleWebsockets),()=>{document.removeEventListener("visualisation_update",handleWebsockets)}}),[virtuals,pixelGraphs,virtId]);const tooLessPixels=(0,useStore.A)((state=>{var _state$dialogs$lessPi;return(null===(_state$dialogs$lessPi=state.dialogs.lessPixels)||void 0===_state$dialogs$lessPi?void 0:_state$dialogs$lessPi.open)||!1}));return graphs||intGraphs?dummy||tooLessPixels?(0,jsx_runtime.jsx)("div",{style:{maxWidth:fullScreen?"100vw":"520px",maxHeight:fullScreen?"calc(100vh - 200px)":"unset",display:"flex",width:"100%",borderRadius:"10px",overflow:"hidden",margin:"0.5rem 0 0 0"},className:`${className} ${active?"active":""}`,children:(0,jsx_runtime.jsx)("div",{style:{backgroundColor:"#0002",height:"20px",flex:1,borderRadius:"0"}},1)}):(pixels.length||decodedPixels.length)&&rows>1&&showMatrix?(0,jsx_runtime.jsx)("div",{style:{maxWidth:fullScreen?"100vw":"520px",maxHeight:fullScreen?"calc(100vh - 200px)":"unset",display:"flex",flexDirection:"launchpad-x"===virtuals[virtId].id||"launchpad-x-matrix"===virtuals[virtId].id?"column-reverse":"column",width:"100%",borderRadius:"10px",overflow:"hidden",margin:"0.5rem 0 0 0"},className:`${className}  ${active?"active":""}`,children:Array.from(Array(rows).keys()).map((row=>(0,jsx_runtime.jsx)("div",{style:{maxWidth:fullScreen?"100vw":"520px",maxHeight:fullScreen?"calc(100vh - 200px)":"unset",display:"flex",width:"100%",borderRadius:"0",overflow:"hidden",margin:"0"},className:`${className}  ${active?"active":""}`,children:("compressed"===config.transmission_mode&&decodedPixels.length>0?decodedPixels.slice(row*decodedPixels.length/rows,(row+1)*decodedPixels.length/rows):pixels[0].slice(row*pixels[0].length/rows,(row+1)*pixels[0].length/rows)).map(((_p,i)=>(0,jsx_runtime.jsx)("div",{style:{flex:1,margin:(("compressed"===config.transmission_mode&&decodedPixels.length>0?decodedPixels.length:pixels[0].length)>100&&rows>7?1:2)+"px",borderRadius:("compressed"===config.transmission_mode&&decodedPixels.length>0?decodedPixels.length:pixels[0].length)>100&&rows>7?"50%":"5px",position:"relative",overflow:"hidden",maxWidth:100/Math.max(rows,Math.ceil(pixels[0].length/rows))+"%",maxHeight:100/Math.max(rows,Math.ceil(pixels[0].length/rows))+"%"},children:(0,jsx_runtime.jsx)("div",{style:{width:"100%",paddingBottom:"100%",backgroundColor:active?"compressed"===config.transmission_mode&&decodedPixels.length>0&&decodedPixels[row*decodedPixels.length/rows+i]?`rgb(${Object.values(decodedPixels[row*decodedPixels.length/rows+i])})`:`rgb(${pixels[0][row*pixels[0].length/rows+i]},${pixels[1][row*pixels[0].length/rows+i]},${pixels[2][row*pixels[0].length/rows+i]})`:"#0002"}})},i)))},`row-${row}`)))}):(pixels[0]||decodedPixels).length?(0,jsx_runtime.jsx)("div",{style:{maxWidth:fullScreen?"100vw":"520px",maxHeight:fullScreen?"calc(100vh - 200px)":"unset",display:"flex",width:"100%",borderRadius:"10px",overflow:"hidden",margin:"0.5rem 0 0 0"},className:`${className}  ${active?"active":""}`,children:("compressed"===config.transmission_mode?decodedPixels:pixels[0]).map(((p,i)=>(0,jsx_runtime.jsx)("div",{style:{height:"20px",flex:1,borderRadius:"0",backgroundColor:active?"compressed"===config.transmission_mode?`rgb(${Object.values(p)})`:`rgb(${pixels[0][i]},${pixels[1][i]},${pixels[2][i]})`:"#0002"}},i)))}):(0,jsx_runtime.jsx)("div",{style:{maxWidth:fullScreen?"100vw":"520px",maxHeight:fullScreen?"calc(100vh - 200px)":"unset",display:"flex",width:"100%",borderRadius:"10px",overflow:"hidden",margin:"0.5rem 0 0 0"},className:`${className} ${active?"active":""}`,children:(0,jsx_runtime.jsx)("div",{style:{height:"20px",borderRadius:"0",flex:1,backgroundColor:"#0002"}},1)}):null},components_PixelGraph=PixelGraph;try{PixelGraph.displayName="PixelGraph",PixelGraph.__docgenInfo={description:"",displayName:"PixelGraph",props:{virtId:{defaultValue:null,description:"",name:"virtId",required:!0,type:{name:"string"}},dummy:{defaultValue:{value:"false"},description:"",name:"dummy",required:!1,type:{name:"boolean"}},className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string"}},active:{defaultValue:{value:"false"},description:"",name:"active",required:!1,type:{name:"boolean"}},intGraphs:{defaultValue:{value:"false"},description:"",name:"intGraphs",required:!1,type:{name:"boolean"}},showMatrix:{defaultValue:{value:"false"},description:"",name:"showMatrix",required:!1,type:{name:"boolean"}},fullScreen:{defaultValue:{value:"false"},description:"",name:"fullScreen",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/PixelGraph.tsx#PixelGraph"]={docgenInfo:PixelGraph.__docgenInfo,name:"PixelGraph",path:"src/components/PixelGraph.tsx#PixelGraph"})}catch(__react_docgen_typescript_loader_error){}const DeviceCard_styles=(0,makeStyles.A)((()=>({virtualCardPortraitW:{margin:"0.5rem",display:"flex",alignItems:"flex-start",flexDirection:"column",minWidth:"230px",maxWidth:"400px",width:"100%",height:"100%",position:"relative",borderRadius:10,borderColor:"transparent",textDecoration:"none","@media (max-width: 410px)":{margin:"0.25rem 0"}},virtualCardPortrait:{padding:"1rem 0.7rem 0.7rem 0.7rem",display:"flex",alignItems:"flex-start",flexDirection:"column",minWidth:"230px",maxWidth:"400px",width:"100%",height:"100%",position:"relative",borderRadius:10,borderColor:"transparent"},virtualIconWrapper:{width:"50px",height:"55px",marginRight:"0.5rem"},virtualIcon:{marginBottom:"4px",marginRight:"0.5rem",fontSize:"50px",position:"absolute",transformOrigin:"top left","&.graphs":{transformOrigin:"center left"},transition:"transform 0.3s ease-in-out",transitionDelay:"0s","&.extended":{transform:"scale(1.7) translateY(-4px);",transformOrigin:"top left",transition:"transform 0.3s ease-in-out",transitionDelay:"0s"},"&.extended.graphs":{transform:"scale(1.25)",transformOrigin:"center left",transition:"transform 0.3s ease-in-out",transitionDelay:"0s"},"& svg":{transform:"unset",width:"100%",marginTop:"3px",height:"100%"}},virtualCardContainer:{display:"flex",alignItems:"center",width:"100%",height:"100%",minHeight:"73px",padding:"0 0.3rem",justifyContent:"space-between",flexDirection:"row"},virtualSubline:{padding:"0 0.5rem"},iconMedia:{height:140,display:"flex",alignItems:"center",margin:"0 auto",fontSize:100,"& > span:before":{position:"relative"}},editButton:{minWidth:"unset"},editButtonMobile:{minWidth:"unset",flexGrow:1},buttonBarMobile:{width:"100%",height:"100%",textAlign:"right"},buttonBarMobileWrapper:{height:110,display:"flex",margin:0,padding:"0.5rem 80px 0.5rem 0.5rem",background:"rgba(0,0,0,0.93)",color:"#fff","& > div, & > button":{flexGrow:1,flexBasis:"30%"},"&.extended.graphs":{height:"auto",paddingTop:0,"& button":{fontSize:"smaller"}}},pixelbar:{opacity:1,transitionDuration:"0s",width:"100%"},pixelbarOut:{opacity:.2,transition:"opacity",transitionDuration:"1s"}}))),DeviceCard=_ref=>{let{graphsMulti,activateDevice,deviceName="My Wled",online=!0,effectName,virtId="yz-quad",index=1,handleDeleteDevice=()=>console.log("DELETING DEVICE"),handleEditVirtual=()=>console.log("EDITING VIRTUAL"),handleEditDevice=()=>console.log("EDITING DEVICE"),handleClearEffect=()=>console.log("CLEARING EFFECT"),handlePlayPause=()=>console.log("PLAY/PAUSE"),linkTo="/",additionalStyle={},iconName="wled",colorIndicator=!0,isPlaying=!0,isStreaming=!1,previewOnly=!0,dummy=!1,isEffectSet=!0,transitionTime=5,isDevice="yz-quad",graphsActive=!0,showMatrix=!1}=_ref;const classes=DeviceCard_styles(),theme=(0,useTheme.A)(),[fade,_setFade]=(0,react.useState)(!1),[isActive,setIsActive]=(0,react.useState)(isEffectSet||isStreaming),[expanded,setExpanded]=(0,react.useState)(!1),handleExpandClick=()=>{setExpanded(!expanded)};return(0,react.useEffect)((()=>{setIsActive(isEffectSet||isStreaming)}),[isEffectSet,isStreaming]),(0,jsx_runtime.jsx)(react_router_dom_dist.k2,{to:linkTo,className:`${classes.virtualCardPortraitW} ${isEffectSet?"active":""} ${online?"online":"offline"}`,style:{...additionalStyle,width:"100%",background:theme.palette.background.paper},children:(0,jsx_runtime.jsxs)(Card.A,{className:classes.virtualCardPortrait,sx:{background:theme.palette.background.paper,"&:hover":{borderColor:theme.palette.text.disabled}},children:[(0,jsx_runtime.jsxs)("div",{className:classes.virtualCardContainer,children:[(0,jsx_runtime.jsx)("div",{className:classes.virtualIconWrapper,children:(0,jsx_runtime.jsx)(BladeIcon.A,{colorIndicator:!1,name:iconName,className:`${classes.virtualIcon} ${graphsActive?"":"graphs"} ${expanded?"extended":""}`,style:{zIndex:3,opacity:online?1:.3,color:expanded?"#fff":""},card:!0})}),(0,jsx_runtime.jsxs)("div",{className:classes.virtualSubline,children:[(0,jsx_runtime.jsx)(Typography.A,{variant:"h6",style:{lineHeight:1,color:colorIndicator?theme.palette.primary.light:"inherit",opacity:online?1:.3},children:deviceName}),online?effectName?(0,jsx_runtime.jsxs)(Typography.A,{variant:"body1",color:"textSecondary",style:{height:25,display:"flex",alignItems:"center"},children:[(0,jsx_runtime.jsx)("span",{className:"hideMobile",children:"Effect:Â "}),effectName,(0,jsx_runtime.jsx)(Button.A,{variant:"text",size:"small",onClick:e=>{e.preventDefault(),handlePlayPause()},style:{color:"#999",minWidth:"unset",zIndex:expanded?1:3},children:isPlaying?(0,jsx_runtime.jsx)(Pause.A,{}):(0,jsx_runtime.jsx)(PlayArrow.A,{})}),(0,jsx_runtime.jsx)(Button.A,{size:"small",variant:"text",onClick:e=>{e.preventDefault(),handleClearEffect(virtId)},style:{color:"#999",minWidth:"unset",zIndex:expanded?1:3},children:(0,jsx_runtime.jsx)(Clear.A,{})})]}):isStreaming?(0,jsx_runtime.jsx)(Typography.A,{variant:"body1",color:"textSecondary",style:{height:25},children:"Streaming..."}):(0,jsx_runtime.jsx)(Typography.A,{variant:"body1",style:{color:theme.palette.text.disabled,height:25},children:"off"}):(0,jsx_runtime.jsxs)(Typography.A,{variant:"body1",color:"textSecondary",style:{height:25,display:"flex",alignItems:"center"},children:[(0,jsx_runtime.jsx)(Typography.A,{variant:"body1",component:"span",color:"textSecondary",style:{height:25,opacity:online?1:.3},children:"offline"}),(0,jsx_runtime.jsx)(Button.A,{variant:"text",size:"small",onClick:e=>{e.preventDefault(),isDevice&&activateDevice(isDevice)},style:{color:"inherit",marginLeft:"1rem",marginTop:"0rem",minWidth:"unset",zIndex:expanded?1:3},children:(0,jsx_runtime.jsx)(SyncProblem.A,{})})]})]}),(0,jsx_runtime.jsxs)("div",{children:[previewOnly&&(0,jsx_runtime.jsx)(Button.A,{variant:"text",disabled:!0,size:"small",children:(0,jsx_runtime.jsx)(Visibility.A,{})}),dummy&&(0,jsx_runtime.jsx)(Button.A,{variant:"text",disabled:!0,size:"small",children:(0,jsx_runtime.jsx)(PestControl.A,{})})]}),"activated"!==window.localStorage.getItem("guestmode")?(0,jsx_runtime.jsx)(IconButton.A,{sx:{transform:expanded?"rotate(180deg)":"rotate(0deg)",alignSelf:"flex-start",marginLeft:"auto",transition:theme.transitions.create("transform",{duration:theme.transitions.duration.shortest}),display:"block"},onClick:e=>{e.preventDefault(),handleExpandClick()},"aria-expanded":expanded,"aria-label":"show more",style:{zIndex:3,color:"#999"},children:(0,jsx_runtime.jsx)(ExpandMore.A,{className:`step-devices-two-${index}`})}):(0,jsx_runtime.jsx)(Box.A,{sx:{alignSelf:"flex-start",marginLeft:"auto",display:"block"}})]}),graphsMulti&&(0,jsx_runtime.jsx)("div",{style:{opacity:fade?.2:1,transitionDuration:fade?`${transitionTime||1}s`:`${transitionTime||0}s`,width:"100%",transition:"opacity"},children:(0,jsx_runtime.jsx)(components_PixelGraph,{showMatrix,intGraphs:graphsActive,active:isActive,virtId:virtId||"",className:"step-devices-seven"})}),(0,jsx_runtime.jsx)("div",{style:{position:"absolute",left:0,top:0,bottom:0,right:0,zIndex:2},children:(0,jsx_runtime.jsx)(Collapse.A,{in:expanded,timeout:"auto",unmountOnExit:!0,className:classes.buttonBarMobile,children:(0,jsx_runtime.jsxs)("div",{className:`${classes.buttonBarMobileWrapper} ${graphsActive?"":"graphs"} ${expanded?"extended":""}`,onClick:e=>e.preventDefault(),children:[(0,jsx_runtime.jsx)("div",{}),(0,jsx_runtime.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"center"},children:[(0,jsx_runtime.jsx)(Popover.A,{variant:"text",startIcon:(0,jsx_runtime.jsx)(Delete.A,{}),label:"delete",color:"inherit",onConfirm:()=>{handleDeleteDevice(virtId),handleExpandClick()},className:`step-devices-three-${index}`,style:{width:"100%"}}),isDevice?(0,jsx_runtime.jsx)(Button.A,{variant:"text",color:"inherit",size:"small",startIcon:(0,jsx_runtime.jsx)(Build.A,{}),className:`step-devices-four-${index}`,onClick:e=>{e.preventDefault(),handleEditDevice(isDevice),handleExpandClick()},children:"Edit Device"}):(0,jsx_runtime.jsx)(EditVirtuals,{label:"Edit Virtual",variant:"text",color:"inherit",virtId,icon:void 0,className:"step-devices-six",startIcon:(0,jsx_runtime.jsx)(Tune.A,{}),type:void 0,innerKey:void 0,onClick:()=>handleExpandClick()}),(0,jsx_runtime.jsx)(Button.A,{variant:"text",size:"small",startIcon:(0,jsx_runtime.jsx)(Settings.A,{}),color:"inherit",className:`step-devices-five-${index}`,onClick:e=>{e.preventDefault(),handleEditVirtual(virtId),handleExpandClick()},children:"Settings"})]})]})})})]})})},DeviceCard_DeviceCard=DeviceCard;try{DeviceCard.displayName="DeviceCard",DeviceCard.__docgenInfo={description:"Pixelgraphs will not connect via Websocket in Storybook",displayName:"DeviceCard",props:{deviceName:{defaultValue:{value:"My Wled"},description:"The Name of the device",name:"deviceName",required:!1,type:{name:"string"}},iconName:{defaultValue:{value:"wled"},description:"IconName. Refer to `Icon`",name:"iconName",required:!1,type:{name:"string"}},effectName:{defaultValue:{value:"undefined"},description:"Name of the current Effect",name:"effectName",required:!1,type:{name:"string"}},isEffectSet:{defaultValue:{value:"true"},description:"Flag if Effect is set",name:"isEffectSet",required:!1,type:{name:"boolean"}},online:{defaultValue:{value:"true"},description:"Is device online",name:"online",required:!1,type:{name:"boolean"}},isPlaying:{defaultValue:{value:"true"},description:"Play/Pause",name:"isPlaying",required:!1,type:{name:"boolean"}},isStreaming:{defaultValue:{value:"false"},description:"Is streaming from other sources",name:"isStreaming",required:!1,type:{name:"boolean"}},previewOnly:{defaultValue:{value:"true"},description:"Do not send to leds",name:"previewOnly",required:!1,type:{name:"boolean"}},dummy:{defaultValue:{value:"false"},description:"Dummy Device",name:"dummy",required:!1,type:{name:"boolean"}},transitionTime:{defaultValue:{value:"5"},description:"TransitionTime of the Device",name:"transitionTime",required:!1,type:{name:"number"}},isDevice:{defaultValue:{value:"yz-quad"},description:"DeviceId if its a device, else undefined if its a virtual",name:"isDevice",required:!1,type:{name:"string"}},graphsActive:{defaultValue:{value:"true"},description:"Graphs active?",name:"graphsActive",required:!1,type:{name:"boolean"}},graphsMulti:{defaultValue:null,description:"Do not send to leds",name:"graphsMulti",required:!1,type:{name:"boolean"}},showMatrix:{defaultValue:{value:"false"},description:"Show Matrix",name:"showMatrix",required:!1,type:{name:"boolean"}},colorIndicator:{defaultValue:{value:"true"},description:"Colorize?",name:"colorIndicator",required:!1,type:{name:"boolean"}},virtId:{defaultValue:{value:"yz-quad"},description:"VirtualId",name:"virtId",required:!1,type:{name:"string"}},index:{defaultValue:{value:"1"},description:"Index",name:"index",required:!1,type:{name:"number"}},handleDeleteDevice:{defaultValue:{value:"() => console.log('DELETING DEVICE')"},description:"Handle Function",name:"handleDeleteDevice",required:!1,type:{name:"any"}},handleEditVirtual:{defaultValue:{value:"() => console.log('EDITING VIRTUAL')"},description:"Handle Function",name:"handleEditVirtual",required:!1,type:{name:"any"}},handleEditDevice:{defaultValue:{value:"() => console.log('EDITING DEVICE')"},description:"Handle Function",name:"handleEditDevice",required:!1,type:{name:"any"}},handleClearEffect:{defaultValue:{value:"() => console.log('CLEARING EFFECT')"},description:"Handle Function",name:"handleClearEffect",required:!1,type:{name:"any"}},handlePlayPause:{defaultValue:{value:"() => console.log('PLAY/PAUSE')"},description:"Handle Function",name:"handlePlayPause",required:!1,type:{name:"any"}},activateDevice:{defaultValue:null,description:"Handle Function",name:"activateDevice",required:!1,type:{name:"any"}},linkTo:{defaultValue:{value:"/"},description:"Handle Function",name:"linkTo",required:!1,type:{name:"any"}},additionalStyle:{defaultValue:{value:"{}"},description:"onClick Link",name:"additionalStyle",required:!1,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/pages/Devices/DeviceCard/DeviceCard.tsx#DeviceCard"]={docgenInfo:DeviceCard.__docgenInfo,name:"DeviceCard",path:"src/pages/Devices/DeviceCard/DeviceCard.tsx#DeviceCard"})}catch(__react_docgen_typescript_loader_error){}const DeviceCard_stories={title:"UI Components/DeviceCard",component:DeviceCard_DeviceCard,decorators:[Story=>(0,jsx_runtime.jsx)(dist.fS,{children:Story()})],parameters:{options:{showPanel:!0}}},Default=(args=>(0,jsx_runtime.jsx)(DeviceCard_DeviceCard,{...args})).bind({});Default.args={deviceName:"My Wled",iconName:"wled",effectName:"Super Effect",isEffectSet:!0,isPlaying:!0,previewOnly:!0,colorIndicator:!0,isStreaming:!1,graphsActive:!0,handleDeleteDevice:void 0,handleEditVirtual:void 0,handleEditDevice:void 0,handleClearEffect:void 0,handlePlayPause:void 0,additionalStyle:{},transitionTime:5,virtId:"yz-quad",isDevice:"yz-quad",linkTo:"/",index:1};const __namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => <DeviceCard {...args} />",...Default.parameters?.docs?.source}}}},"./src/components/Popover/Popover.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_mui_material__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@mui/material/styles/useTheme.js"),_mui_material__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@mui/material/MenuItem/MenuItem.js"),_mui_material__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@mui/material/ListItemIcon/ListItemIcon.js"),_mui_material__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@mui/material/Button/Button.js"),_mui_material__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@mui/material/Fab/Fab.js"),_mui_material__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@mui/material/IconButton/IconButton.js"),_mui_material__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@mui/material/Popover/Popover.js"),_mui_material__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@mui/material/Typography/Typography.js"),_mui_icons_material__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@mui/icons-material/esm/Delete.js"),_mui_icons_material__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@mui/icons-material/esm/Check.js"),_mui_icons_material__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@mui/icons-material/esm/Close.js"),use_long_press__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/use-long-press/index.mjs"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");const Popover=_ref=>{let{onConfirm,onCancel,confirmDisabled,confirmContent,onSingleClick,onDoubleClick,openOnDoubleClick=!1,openOnLongPress=!1,noIcon=!1,disabled=!1,variant="contained",color="secondary",vertical="center",horizontal="left",size="small",text="Are you sure?",label,anchorOrigin,transformOrigin,startIcon,icon=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_icons_material__WEBPACK_IMPORTED_MODULE_3__.A,{}),content,footer,className,style={},sx,popoverStyle,wrapperStyle,type="button",children}=_ref;const theme=(0,_mui_material__WEBPACK_IMPORTED_MODULE_4__.A)(),[anchorEl,setAnchorEl]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),openPopover=event=>{setAnchorEl((()=>event.currentTarget||event.target))},longPress=(0,use_long_press__WEBPACK_IMPORTED_MODULE_1__.HZ)((e=>openPopover(e)),{onCancel:e=>{onSingleClick&&onSingleClick(e)},threshold:1e3,captureEvent:!0}),open=Boolean(anchorEl),id=open?"simple-popover":void 0;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{style:{display:"initial",margin:0,...wrapperStyle},children:["menuItem"===type?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_5__.A,{className,onClick:e=>{e.preventDefault(),onSingleClick&&onSingleClick(e),openPopover(e)},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_6__.A,{children:icon}),label]}):openOnLongPress?"button"===type?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.A,{"aria-describedby":id,variant,color,size,className,style,startIcon:!noIcon&&startIcon,disabled,...longPress,children:[label,!startIcon&&!noIcon&&icon]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_8__.A,{"aria-label":"clear-data",...longPress,disabled,style:{margin:"8px",...style},sx:{bgcolor:theme.palette.primary.main,"&:hover":{bgcolor:theme.palette.primary.light}},children:!startIcon&&!noIcon&&icon}):"button"===type?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.A,{"aria-describedby":id,variant,color,onClick:e=>{e.preventDefault(),openOnDoubleClick||openPopover(e),onSingleClick&&onSingleClick(e)},size,className,style,startIcon:!noIcon&&startIcon,disabled,onDoubleClick:e=>{e.preventDefault(),openOnDoubleClick&&openPopover(e),onDoubleClick&&onDoubleClick(e)},children:[label,!startIcon&&!noIcon&&icon,children]}):"iconbutton"===type?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_9__.A,{color,style,onClick:e=>openPopover(e),disabled,children:!startIcon&&!noIcon&&icon}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_8__.A,{"aria-label":"clear-data",onClick:e=>{e.preventDefault(),openOnDoubleClick||openPopover(e),onSingleClick&&onSingleClick(e)},onDoubleClick:e=>{e.preventDefault(),openOnDoubleClick&&openPopover(e),onDoubleClick&&onDoubleClick(e)},disabled,style:{margin:"8px"},sx:{bgcolor:theme.palette.primary.main,"&:hover":{bgcolor:theme.palette.primary.light},...sx},children:[!startIcon&&!noIcon&&icon,children]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_mui_material__WEBPACK_IMPORTED_MODULE_10__.Ay,{id,open,anchorEl,onClose:()=>{setAnchorEl(null)},anchorOrigin:anchorOrigin||{vertical,horizontal},transformOrigin:transformOrigin||{vertical,horizontal:"center"===horizontal?"center":"right"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{style:{display:"flex",...popoverStyle},children:[content||(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_11__.A,{sx:{padding:theme.spacing(2)},children:text}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.A,{disabled:confirmDisabled,"aria-describedby":id,variant:"contained",color:"primary",onClick:e=>{e.preventDefault(),onConfirm&&onConfirm(e),setAnchorEl(null)},children:confirmContent||(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_icons_material__WEBPACK_IMPORTED_MODULE_12__.A,{})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_material__WEBPACK_IMPORTED_MODULE_7__.A,{"aria-describedby":id,color:"primary",onClick:e=>{e.preventDefault(),onCancel&&onCancel(e),setAnchorEl(null)},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_icons_material__WEBPACK_IMPORTED_MODULE_13__.A,{})})]}),footer]})]})},__WEBPACK_DEFAULT_EXPORT__=Popover;try{Popover.displayName="Popover",Popover.__docgenInfo={description:"",displayName:"Popover",props:{type:{defaultValue:{value:"button"},description:"Render as [Button](https://mui.com/api/button/) or [MenuItem](https://mui.com/api/menu-item/) <br />\nexamples: [Button](https://mui.com/components/buttons/), [MenuItem](https://mui.com/components/menu-item/)",name:"type",required:!1,type:{name:"enum",value:[{value:'"button"'},{value:'"menuItem"'},{value:'"fab"'},{value:'"iconbutton"'}]}},variant:{defaultValue:{value:"contained"},description:"Set the [variant](https://mui.com/components/buttons/#basic-button)",name:"variant",required:!1,type:{name:"enum",value:[{value:'"outlined"'},{value:'"contained"'},{value:'"text"'}]}},color:{defaultValue:{value:"secondary"},description:"Set the [color](https://mui.com/components/buttons/#color)",name:"color",required:!1,type:{name:"enum",value:[{value:'"inherit"'},{value:'"error"'},{value:'"success"'},{value:'"warning"'},{value:'"info"'},{value:'"primary"'},{value:'"secondary"'}]}},size:{defaultValue:{value:"small"},description:"Set the [size](https://mui.com/components/buttons/#sizes)",name:"size",required:!1,type:{name:"enum",value:[{value:'"small"'},{value:'"medium"'},{value:'"large"'}]}},openOnDoubleClick:{defaultValue:{value:"false"},description:"Should the popup open on doubleclick? Ignored if openOnLongPress is `true`",name:"openOnDoubleClick",required:!1,type:{name:"boolean"}},openOnLongPress:{defaultValue:{value:"false"},description:"Should the popup open on longpress? (openOnDoubleClick gets ignored if set)",name:"openOnLongPress",required:!1,type:{name:"boolean"}},vertical:{defaultValue:{value:"center"},description:"Set Popover [position](https://mui.com/components/popover/#anchor-playground)",name:"vertical",required:!1,type:{name:'number | "center" | "bottom" | "top"'}},horizontal:{defaultValue:{value:"left"},description:"Set Popover [position](https://mui.com/components/popover/#anchor-playground)",name:"horizontal",required:!1,type:{name:'number | "center" | "left" | "right"'}},anchorOrigin:{defaultValue:null,description:"Set Popover [position](https://mui.com/components/popover/#anchor-playground)",name:"anchorOrigin",required:!1,type:{name:"PopoverOrigin"}},transformOrigin:{defaultValue:null,description:"Set Popover [position](https://mui.com/components/popover/#anchor-playground)",name:"transformOrigin",required:!1,type:{name:"PopoverOrigin"}},onConfirm:{defaultValue:null,description:"Function to call when confirm is clicked",name:"onConfirm",required:!1,type:{name:"((e: any) => any)"}},onCancel:{defaultValue:null,description:"Function to call when cancel is clicked",name:"onCancel",required:!1,type:{name:"((e: any) => any)"}},onSingleClick:{defaultValue:null,description:"Function to call when button is clicked",name:"onSingleClick",required:!1,type:{name:"((e: any) => any)"}},onDoubleClick:{defaultValue:null,description:"Function to call when button is doubleclicked",name:"onDoubleClick",required:!1,type:{name:"((e: any) => any)"}},noIcon:{defaultValue:{value:"false"},description:"Remove Icon",name:"noIcon",required:!1,type:{name:"boolean"}},disabled:{defaultValue:{value:"false"},description:"Disabled state",name:"disabled",required:!1,type:{name:"boolean"}},confirmDisabled:{defaultValue:null,description:"flag indicator",name:"confirmDisabled",required:!1,type:{name:"boolean"}},confirmContent:{defaultValue:null,description:"flag indicator",name:"confirmContent",required:!1,type:{name:"any"}},text:{defaultValue:{value:"Are you sure?"},description:"Text to show in the popup",name:"text",required:!1,type:{name:"string"}},label:{defaultValue:{value:"undefined"},description:"[Label](https://mui.com/components/buttons/#buttons-with-icons-and-label)",name:"label",required:!1,type:{name:"string"}},startIcon:{defaultValue:null,description:"[startIcon](https://mui.com/components/buttons/#buttons-with-icons-and-label)",name:"startIcon",required:!1,type:{name:"ReactNode"}},icon:{defaultValue:{value:"<Delete />"},description:"[Icon](https://mui.com/components/material-icons/)",name:"icon",required:!1,type:{name:"ReactNode"}},content:{defaultValue:null,description:"Content of the Popover",name:"content",required:!1,type:{name:"ReactNode"}},children:{defaultValue:null,description:"Content",name:"children",required:!1,type:{name:"ReactNode"}},footer:{defaultValue:null,description:"Footer",name:"footer",required:!1,type:{name:"ReactNode"}},className:{defaultValue:null,description:"JSX className",name:"className",required:!1,type:{name:"string"}},sx:{defaultValue:null,description:"JSX style",name:"sx",required:!1,type:{name:"SxProps<Theme>"}},style:{defaultValue:{value:"{}"},description:"JSX style",name:"style",required:!1,type:{name:"Record<string, unknown>"}},popoverStyle:{defaultValue:null,description:"JSX style",name:"popoverStyle",required:!1,type:{name:"Record<string, unknown>"}},wrapperStyle:{defaultValue:null,description:"JSX style",name:"wrapperStyle",required:!1,type:{name:"Record<string, unknown>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Popover/Popover.tsx#Popover"]={docgenInfo:Popover.__docgenInfo,name:"Popover",path:"src/components/Popover/Popover.tsx#Popover"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/SchemaForm/components/BladeFrame.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _mui_material_styles__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@mui/material/styles/styled.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js");const Root=(0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_1__.Ay)("div")((_ref=>{let{theme}=_ref;return{minWidth:"23.5%",padding:"16px 1.2rem 6px 1.2rem",border:"1px solid",borderColor:theme.palette.divider,borderRadius:"10px",position:"relative",display:"flex",alignItems:"center",height:"auto",margin:"0.5rem 0","@media (max-width: 580px)":{width:"100% !important",margin:"0.5rem 0"},"& > label":{top:"-0.75rem",display:"flex",alignItems:"center",left:"1rem",padding:"0 0.3rem",position:"absolute",fontVariant:"all-small-caps",fontSize:"0.9rem",letterSpacing:"0.1rem",color:theme.palette.text.secondary,backgroundColor:theme.palette.background.paper,boxSizing:"border-box"}}})),BladeFrame=_ref2=>{let{index,title,children,full=!1,style={width:"unset",order:0},required=!1,variant="outlined",className,disabled,labelStyle,onClick}=_ref2;return"outlined"===variant?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(Root,{className:className||"",style:{...style,width:full?"100%":style.width},onClick,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("label",{style:{...labelStyle},className:`MuiFormLabel-root${disabled?" Mui-disabled":""}  step-effect-${index}`,children:[title,required?"*":""]}),children]}):children},__WEBPACK_DEFAULT_EXPORT__=BladeFrame;try{BladeFrame.displayName="BladeFrame",BladeFrame.__docgenInfo={description:"",displayName:"BladeFrame",props:{title:{defaultValue:{value:"undefined"},description:"",name:"title",required:!1,type:{name:"string"}},index:{defaultValue:{value:"undefined"},description:"",name:"index",required:!1,type:{name:"number"}},full:{defaultValue:{value:"false"},description:"",name:"full",required:!1,type:{name:"boolean"}},style:{defaultValue:{value:"{\n    width: 'unset',\n    order: 0\n  }"},description:"",name:"style",required:!1,type:{name:"any"}},required:{defaultValue:{value:"false"},description:"",name:"required",required:!1,type:{name:"boolean"}},variant:{defaultValue:{value:"outlined"},description:"",name:"variant",required:!1,type:{name:"enum",value:[{value:'"inherit"'},{value:'"outlined"'},{value:'"contained"'}]}},className:{defaultValue:{value:"undefined"},description:"",name:"className",required:!1,type:{name:"string"}},disabled:{defaultValue:{value:"undefined"},description:"",name:"disabled",required:!1,type:{name:"boolean"}},labelStyle:{defaultValue:{value:"undefined"},description:"",name:"labelStyle",required:!1,type:{name:"any"}},onClick:{defaultValue:{value:"undefined"},description:"",name:"onClick",required:!1,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/SchemaForm/components/BladeFrame.tsx#BladeFrame"]={docgenInfo:BladeFrame.__docgenInfo,name:"BladeFrame",path:"src/components/SchemaForm/components/BladeFrame.tsx#BladeFrame"})}catch(__react_docgen_typescript_loader_error){}}}]);